"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[6653],{65524:function(t,e,i){i.d(e,{A:function(){return y}});var a=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{display:"flex","flex-wrap":"wrap","align-items":"center"}},[t._t("prefix"),t._l(t.tabs,(function(i,a){return e("el-popover",{key:a,attrs:{"popper-class":"filterOptionsPopover",placement:t.placement,width:"280",trigger:"click"},on:{show:function(e){return t.popovershow(a)}},scopedSlots:t._u([{key:"reference",fn:function(){return[e("span",[0===a?e("el-button",{staticClass:"buttonsearch",staticStyle:{"margin-right":"3px"},attrs:{size:"mini"}},[t._t("textSlot",(function(){return[t._v("添加条件")]}))],2):[e("span",{key:a,staticStyle:{margin:"2px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff",display:"inline-block"},on:{click:function(e){return t.editTag(e,i,a-1)}}},[t._v(" "+t._s(i.keyDesc)+" "+t._s(i.operatorDesc)+" "+t._s(i.valueDesc)+" "),i.clearable?e("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),t.delTag(i,a-1)}}}):t._e()])]],2)]},proxy:!0}],null,!0),model:{value:i.show,callback:function(e){t.$set(i,"show",e)},expression:"item.show"}},[e("el-form",{ref:"formRef",refInFor:!0,attrs:{model:t.form,"label-position":"right","label-width":"70px"}},[e("el-form-item",{attrs:{label:"关键字",prop:"key",rules:t.required}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",size:"mini"},on:{change:t.selectField},model:{value:t.form.key,callback:function(e){t.$set(t.form,"key",e)},expression:"form.key"}},t._l(t.options,(function(t,i){return e("el-option",{key:i,attrs:{value:t.key,label:t.desc}})})),1)],1),e("el-form-item",{attrs:{label:"操作符",prop:"operator",rules:t.required}},[e("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini"},model:{value:t.form.operator,callback:function(e){t.$set(t.form,"operator",e)},expression:"form.operator"}},t._l(t.selectFieldDerive.operatorArray,(function(t,i){return e("el-option",{key:i,attrs:{value:t.key,label:t.desc}})})),1)],1),e("el-form-item",{attrs:{label:"值",rules:t.required,prop:"value"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:["datetime","time"].includes(t.selectFieldDerive.valueType),expression:"['datetime', 'time'].includes(selectFieldDerive.valueType)"}],on:{click:function(t){t.stopPropagation()}}},[e("el-date-picker",{ref:"dateRef",refInFor:!0,staticStyle:{width:"100%"},attrs:{clearable:"","popper-class":"filterDate",teleported:!1,"append-to-body":!1,type:"datetime",pickerOptions:t.pickerOptions,placeholder:"选择时间",size:"mini"},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}})],1),["datetime","time"].includes(t.selectFieldDerive.valueType)?t._e():[t.selectFieldDerive.isEnum?e("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:"",multiple:"in"===t.form.operator||"notin"===t.form.operator,"collapse-tags":""},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}},t._l(t.selectFieldDerive.valueArray,(function(t,i){return e("el-option",{key:i,attrs:{value:t.key,label:t.desc}})})),1):[t.suggestOptions&&t.suggestOptions[t.form.key]?e("el-autocomplete",{staticStyle:{width:"100%"},attrs:{size:"mini","fetch-suggestions":t.querySearch,clearable:""},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}}):e("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:""},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}})]]],2),e("el-form-item",[e("el-button",{staticClass:"buttonsearch",attrs:{size:"mini"},on:{click:function(e){return t.confirm(a)}}},[t._v("确定")])],1)],1)],1)}))],2)},s=[],l=i(95093),r=i.n(l);class n{constructor(t){this.key=t?.key,this.operator=t?.operator,this.value=t?.value}}const o=r()().startOf("days"),c=r()().startOf("days").subtract(1,"days"),d=r()().startOf("days").subtract(7,"days"),u=r()().startOf("days").subtract(15,"days"),p=r()().startOf("days").subtract(30,"days"),h={[o]:"今天",[c]:"昨天",[d]:"七天前",[u]:"十五天前",[p]:"三十天前"};var f={props:{value:{type:Array,default:()=>[]},options:{default:()=>[]},placement:{default:"top"},initData:{type:Object,default:null},suggestOptions:{default:()=>({})},multiCondition:{default:!0}},created(){},mounted(){},data(){return{moment:Object.freeze(r()),form:new n,show:!1,editIdx:-1,pickerOptions:{disabledDate(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(t){t.$emit("pick",o)}},{text:"昨天",onClick(t){t.$emit("pick",c)}},{text:"七天前",onClick(t){t.$emit("pick",d)}},{text:"十五天前",onClick(t){t.$emit("pick",u)}},{text:"三十天前",onClick(t){t.$emit("pick",p)}}]},required:{required:!0,message:"请检查必填项",trigger:["blur","change"]}}},computed:{filters:{get(){return this.value?.map((t=>this.getSelectItem(t)))},set(t){this.$emit("input",t),this.$emit("change",t)}},selectFieldDerive(){var t=this.options.findIndex((t=>t.key===this.form.key));return{operatorArray:this.options?.[t]?.operators||[],isEnum:!!this.options?.[t]?.enums,valueArray:this.options?.[t]?.enums||[],valueType:this.options?.[t]?.type}},tabs(){return[{show:!1},...this.filters]}},methods:{querySearch(t,e){var i=this.suggestOptions?.[this.form.key],a=t?i.filter((e=>-1!==String(e).toLowerCase().indexOf(t.toLowerCase()))):i;e(a.map((t=>({value:t}))))},selectField(t){this.form.value=null,this.$nextTick((()=>{this.form.operator=this.selectFieldDerive.operatorArray.some((t=>"like"===t.key))?"like":this.selectFieldDerive.operatorArray?.[0]?.key}))},selectOperator(t){this.form.value=null},async confirm(t){try{if(await(this.$refs.formRef?.[t].validate().catch((()=>{throw"请检查必填项"}))),this.show=!1,this.editIdx>=0&&this.editIdx<this.filters.length){const t=this.filters||[];t[this.editIdx]=this.valueDecode(Object.assign(t[this.editIdx],this.form)),this.filters=[...t],this.editIdx=-1}else this.pushFilter(this.form)}catch(e){this.$message.warning(e)}},valueDecode(t){const e=this.options?.find((e=>e.key===t.key));return e.enum&&t.value&&("in"===t.operator||"notin"===t.operator)&&Array.isArray(t.value)?{...t,value:t.value.join(",")}:{...t}},valueEncode(t){const e=this.options?.find((e=>e.key===t.key));return e?.enum&&t.value&&("in"===t.operator||"notin"===t.operator)&&(t.value=t.value?.split(",")||t.value),t},pushFilter(t){const e=this.filters||[],i=e.findIndex((e=>e.key===t.key)),a=e[i];t=this.valueDecode(t),a?(null===t.value||void 0===t||""===t?e.splice(i,1):Object.assign(a,t),this.filters=[...e]):null!==t.value&&void 0!==t&&""!==t&&(!this.multiCondition&&e.length>0&&(e.length=0),this.filters=[...e,{...t}])},getSelectItem({key:t,operator:e,value:i,clearable:a=!0,disabled:s=!1}){const l=this.options?.find((e=>e.key===t)),n=l?.operators,o=l?.enums||[],c=()=>{const a=this.valueEncode({key:t,operator:e,value:i})?.value;if("time"===l?.type){const t=r()(i);return t in h?h[t]:t.format("YYYY-MM-DD HH:mm:ss")}return l?.enum?"in"===e||"notin"===e?a?.map((t=>o.find((e=>e.key===t))?.desc))?.join(",")||a:o.find((t=>t.key===a))?.desc:i};return{key:t,keyDesc:l?.desc,value:i,valueDesc:c(),show:!1,valueType:l?.type,operator:e,clearable:a,disabled:s,operatorDesc:n?.find((t=>t.key===e))?.desc}},delTag(t,e){const i=this.filters||[];i.splice(e,1),this.filters=i},editTag(t,e,i){e.disabled?t.stopPropagation():(this.editIdx=i,this.form=new n(this.valueEncode(e)))},popovershow(t){this.$refs.dateRef[t].placement="right"}}},v=f,m=i(81656),g=(0,m.A)(v,a,s,!1,null,"84dd770c",null),y=g.exports},23947:function(t,e,i){i.d(e,{A:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("detail",t._g(t._b({},"detail",t.$attrs,!1),t.$listeners))},s=[],l={components:{detail:()=>Promise.all([i.e(9534),i.e(5358),i.e(6131),i.e(4461),i.e(6),i.e(9141),i.e(9121),i.e(8271),i.e(2376)]).then(i.bind(i,88271))}},r=l,n=i(81656),o=(0,n.A)(r,a,s,!1,null,null,null),c=o.exports},92161:function(t,e,i){i.d(e,{A:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",{class:"事件详情"===t.nameShow?"pageClass":"",staticStyle:{height:"20px","padding-top":"10px"}},[e("span",{staticStyle:{display:"inline-block","font-size":"13px","min-width":"35.5px",height:"28px","line-height":"30px","vertical-align":"top","box-sizing":"border-box",float:"right"}},[t._v("共"+t._s(t.pageTotal)+"条")]),e("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"jumper,sizes,prev, pager, next","page-size":t.size||15,"current-page":t.pageCurrent,total:t.pageTotal,"page-sizes":t.pageSizeArray||[15,30,45]},on:{"update:currentPage":function(e){t.pageCurrent=e},"update:current-page":function(e){t.pageCurrent=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},s=[],l={name:"page",props:{pageSizeArray:Array,size:Number,pageTotal:Number,current:Number,nameShow:String},data(){return{pageCurrent:this.current}},methods:{handleSizeChange(t){this.$emit("handleSizeChange",t)},handleCurrentChange(t){this.$emit("handleCurrentChange",t)}},watch:{current:function(t){this.pageCurrent=t}}},r=l,n=i(81656),o=(0,n.A)(r,a,s,!1,null,"277403d7",null),c=o.exports},77538:function(t,e,i){i.d(e,{A:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",[4===t.cvssScore||"紧急"===t.cvssScore?e("div",{staticStyle:{height:"24px",margin:"0 auto"}},[e("div",{staticClass:"severity-critical-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(0)]):t._e(),3===t.cvssScore||"高危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-high-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(1)]):t._e(),2===t.cvssScore||"中危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-medium-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(2)]):t._e(),1===t.cvssScore||"低危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-low-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(3)]):t._e(),0===t.cvssScore||"无风险"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-no-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(4)]):t._e()])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("紧急")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("高危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("中危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("低危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("无风险")])])])}],l={name:"CvssScore",props:["cvssScore"]},r=l,n=i(81656),o=(0,n.A)(r,a,s,!1,null,"77d4d761",null),c=o.exports},66653:function(t,e,i){i.r(e),i.d(e,{default:function(){return q}});var a=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"contentCard_"},[t.chartShow?e("el-row",{attrs:{gutter:10}},[e("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:24}},[e("TaskCount",{attrs:{recentData:t.recentData},on:{selectChange:t.selectChange}})],1)],1):t._e(),t.riskShow?e("Risk",{on:{activeClick:t.activeClick,activechartShow:t.activechartShow}}):t._e(),t.attackShow?e("Attack",{on:{activeClick:t.activeClick,activechartShow:t.activechartShow}}):t._e()],1)},s=[],l=function(){var t=this,e=t._self._c;return e("span",[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard"},[t._v("配置维度统计")])])],1),e("div",{style:{float:"left",width:"100%",height:"200px"},attrs:{id:"risklvlEchart"}})],1),e("el-col",{attrs:{span:12}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard"},[t._v("风险级别统计")])])],1),e("div",{style:{float:"left",width:"100%",height:"200px"},attrs:{id:"riskstsEchart"}})],1)],1)],1)},r=[],n=i(83779),o={data(){return{countData:{},countLevel:{},riskstsData:{}}},created(){this.init()},methods:{init(){var t={group:"from_code",topn:5};this.$request.fetchGetPie(t).then((t=>{this.countData=t.data,this.initright()}));var e={group:"level",topn:5};this.$request.fetchGetPie(e).then((t=>{this.countLevel=t.data,this.initleft()}))},initright(){var t=[],e={};for(let l in this.countData.topn)e={name:this.countData.topn[l].name,value:this.countData.topn[l].count},t.push(e);this.countData.other>0&&(e={name:"other",value:this.countData.other,itemStyle:{color:"#D0C5C5FA"}},t.push(e));let i=0;t.forEach((function(t){i+=t.value}));var a={legend:{orient:"vertical",right:"15%",align:"left",top:"middle",itemWidth:10,itemHeight:13,icon:"circle",itemGap:20,data:t,formatter:function(e){let a=0;for(var s="",l=0;l<t.length;l++)t[l].name==e&&(a=(t[l].value/i*100).toFixed(2)+"%",s+="{a|"+e+"}| {b|"+a+"}{b|"+t[l].value+"}");return s},textStyle:{color:"#000",rich:{a:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20},b:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20}}}},tooltip:{trigger:"item"},series:[{type:"pie",data:t,center:["35%","50%"],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};const s=n.init(document.getElementById("risklvlEchart"));s.setOption(a),window.addEventListener("resize",(()=>{s.resize()}))},initleft(){var t=[],e={};for(let l in this.countLevel.topn)e={name:this.countLevel.topn[l].name,value:this.countLevel.topn[l].count},t.push(e);this.countLevel.other>0&&(e={name:"other",value:this.countLevel.other,itemStyle:{color:"#D0C5C5FA"}},t.push(e));let i=0;t.forEach((function(t){i+=t.value}));var a={legend:{orient:"vertical",right:"15%",align:"left",top:"middle",itemWidth:10,itemHeight:13,icon:"circle",itemGap:20,data:t,formatter:function(e){let a=0;for(var s="",l=0;l<t.length;l++)t[l].name==e&&(a=(t[l].value/i*100).toFixed(2)+"%",s+="{a|"+e+"}| {b|"+a+"}{b|"+t[l].value+"}");return s},textStyle:{color:"#000",rich:{a:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20},b:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20}}}},tooltip:{trigger:"item"},series:[{type:"pie",data:t,center:["35%","50%"],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};const s=n.init(document.getElementById("riskstsEchart"));s.setOption(a),window.addEventListener("resize",(()=>{s.resize()}))}}},c=o,d=i(81656),u=(0,d.A)(c,l,r,!1,null,null,null),p=u.exports,h=(i(12878),function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{display:"flex","align-items":"flex-end","justify-content":"space-between"}},[e("div",{staticStyle:{flex:"1","margin-right":"10px","margin-bottom":"2px"}},[e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filtersQuery,callback:function(e){t.filtersQuery=e},expression:"filtersQuery"}})],1),e("div",[e("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:t.echartShow}},[t._v(t._s(!0===t.topEchartShow?"隐藏图表":"显示图表")+" ")]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.initRisk}},[t._v("刷新")]),e("el-dropdown",{staticStyle:{"margin-left":"7px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{"el-button":"",type:"primary",plain:"",size:"mini"}},[t._v(" 批量操作"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.actionType,(function(i,a){return e("el-dropdown-item",{key:a,nativeOn:{click:function(e){return t.bulkClick(i)}}},[t._v(" "+t._s(i)+" ")])})),1)],1),e("el-button-group",{staticStyle:{"margin-left":"7px","margin-top":"-1px"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("风险事件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.attackShow}},[t._v("攻击统计")])],1)],1)]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:t.riskData,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[e("el-table-column",{attrs:{prop:"inet",label:"终端IP",width:"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(i.row)}}},[t._v(t._s(i.row.inet))])]}}])}),e("el-table-column",{attrs:{prop:"risk_type",label:"产生时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t._f("date")(e.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),e("el-table-column",{attrs:{prop:"level",label:"级别",width:"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("CvssScore",{attrs:{cvssScore:t.row.level}})]}}])}),e("el-table-column",{attrs:{prop:"local_port",label:"本地端口",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.local_port)+" ")]}}])}),e("el-table-column",{attrs:{prop:"remote_ip",label:"外部IP",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remote_ip||"未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"region",label:"归属地",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.region||"0|0|0|未知|未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"subject",label:"主题",width:"280","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"payload",label:"攻击载荷","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.vulnDetailCilck(i.row)}}},[t._v("详情")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.kaifa}},[t._v("通知")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.kaifa}},[t._v("处理")])]}}])})],1),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.pageTotal},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"inetDrawer",attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1),e("ActionForm",{ref:"actionForm",attrs:{title:t.actionTitle,pageTotal:t.pageTotal,filters:t.filters,nodeData:t.riskData},on:{initRisk:t.initRisk,cancel:t.cancel}}),e("riskDetail",{ref:"riskDetailRef"})],1)}),f=[],v=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{"el-dialog":"","close-on-click-modal":!1,"before-close":t.handleClose,visible:t.actionDialog,title:t.title,"append-to-body":"",width:"500px"},on:{"update:visible":function(e){t.actionDialog=e}}},[t.filters.length>0?e("div",[t._l(t.nodeData,(function(i){return e("el-tag",{key:i.id,staticStyle:{"margin-right":"3px","margin-bottom":"3px"},attrs:{size:"mini",type:"彻底删除"===t.title||"逻辑删除"===t.title?"danger":"success"}},[t._v(t._s(i.inet)+" ")])})),t._v(" 等，共计 "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.pageTotal))]),t._v(" 条是否操作？ ")],2):e("div",[e("span",{staticStyle:{color:"red"}},[t._v("请输入筛选条件")])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.actionDialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v("确定")])],1)])},m=[],g={name:"actionForm",props:["title","pageTotal","filters","nodeData"],data(){return{actionDialog:!1,dataAction:[]}},methods:{handleClose(){this.actionDialog=!1,this.$emit("cancel")},onSubmit(){var t=this,e={filters:this.filters};"批量删除"===this.title?this.$request.fetchDeleteRisk(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)})):"批量忽略"===this.title?this.$request.fetchRiskIgnore(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)})):"批量处理"===this.title&&this.$request.fetchRiskProcess(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)}))}},watch:{nodeData:function(t){this.nodeData=t},filters:function(t){this.filters=t}}},y=g,k=(0,d.A)(y,v,m,!1,null,"64c616c9",null),_=k.exports,b=i(77538),w=i(92161),S=i(23947),x=i(67424),D=i(65524),C={components:{Page:w.A,CvssScore:b.A,NodeDetail:S.A,ActionForm:_,riskDetail:x.A,filterOption:D.A},name:"vuln",data(){return{actionTitle:"",nameIndex:"蜜罐",actionType:["批量删除","批量忽略","批量处理"],selectArray:[{model:"",placeholder:"风险类型",name:"risk_type",dataArray:[{key:"暴力破解",desc:"暴力破解"},{key:"病毒事件",desc:"病毒事件"},{key:"弱口令",desc:"弱口令"},{key:"数据爬虫",desc:"数据爬虫"},{key:"蜜罐应用",desc:"蜜罐应用"},{key:"web攻击",desc:"web攻击"},{key:"登录事件",desc:"登录事件"},{key:"监控事件",desc:"监控事件"}]}],riskData:[],riskLoading:!1,currentPage:1,pageSize:15,pageTotal:0,inet:"",startAt:null,endAt:null,filters:[{key:"risk_type",operator:"eq",value:"蜜罐应用"}],filtersQuery:[],vulnId:"",fromArray:[{value:"",label:"全部"},{value:"文件",label:"文件"},{value:"组件",label:"组件"}],searchData:"",vulnDetailShow:!1,vulnDetailData:{},condData:{},value:"",operator:"",field:"",ipTtitel:{},drawer:!1,directions:"rtl",topEchartShow:!1}},created(){this.initRisk(),this.getCond()},methods:{echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow")},cancel(){this.actionTitle=""},bulkClick(t){const e=this.$refs.actionForm;e.actionDialog=!0,this.actionTitle=t},attackShow(){this.$emit("activeClick",!1,!0)},drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(t){this.ipTtitel=t,this.drawer=!0},sheetode(){var t={filters:this.filters};this.$request.fetchSheetode(t).then((t=>{const e=document.createElement("a");let i=new Blob([t.data],{type:"text/csv"});e.style.display="none",e.href=URL.createObjectURL(i);let a=t.headers["content-disposition"].split("''");e.setAttribute("download",decodeURI(a[1])),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},getCond(){this.$request.fetchRisksCond().then((t=>{this.condData=t.data}))},delTag(t,e){this.filters.splice(e,1)},searchBasic(){this.filters.length=1,this.filters.push(...this.filtersQuery),this.currentPage=1,this.initRisk()},initRisk(){var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchRisks(t).then((t=>{this.riskData=t.data.records,this.pageTotal=t.data.total,this.riskLoading=!1})).catch((()=>{this.riskLoading=!1}))},vulnDetailCilck(t){this.$refs.riskDetailRef.openRiskDetail(t)},kaifa(){this.$message({message:"开发中！！！",type:"warning"})},handleSizeChange(t){this.pageSize=t,this.initRisk()},handleCurrentChange(t){this.currentPage=t,this.initRisk()}}},z=C,L=(0,d.A)(z,h,f,!1,null,"b53a1e66",null),A=L.exports,$=function(){var t=this,e=t._self._c;return e("div",[e("el-row",[e("el-col",{staticStyle:{"text-align":"left"},attrs:{xs:24,sm:24,md:24,lg:15,xl:15}},[e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filtersQuery,callback:function(e){t.filtersQuery=e},expression:"filtersQuery"}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{xs:24,sm:24,md:24,lg:9,xl:9}},[e("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:t.echartShow}},[t._v(t._s(!0===t.topEchartShow?"隐藏图表":"显示图表")+" ")]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.initAttact}},[t._v("刷新")]),e("el-button-group",[e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.riskShow}},[t._v("风险事件")]),e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("攻击统计")])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:t.riskData.records,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[e("el-table-column",{attrs:{prop:"subject",label:"类型"}}),e("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remote_ip||"未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"count",label:"次数"}}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.evnetDetail(i.row)}}},[t._v("事件详情")])]}}])})],1),e("Page",{attrs:{size:t.riskData.size,current:t.riskData.current,pageTotal:t.riskData.total},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"vulnDrawer",attrs:{title:"事件详情",visible:t.detailShow,direction:"rtl",size:"70%"},on:{"update:visible":function(e){t.detailShow=e},close:t.vulnmDetailCancel}},[e("div",{staticStyle:{padding:"0 10px"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.detalLoading,expression:"detalLoading"}],attrs:{data:t.detailData.records,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[e("el-table-column",{attrs:{prop:"inet",label:"终端IP"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(i.row)}}},[t._v(t._s(i.row.inet))])]}}])}),e("el-table-column",{attrs:{prop:"risk_type",label:"类型"}}),e("el-table-column",{attrs:{prop:"level",label:"等级"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("CvssScore",{attrs:{cvssScore:t.row.level}})]}}])}),e("el-table-column",{attrs:{prop:"local_port",label:"本地端口"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.local_port)+" ")]}}])}),e("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remote_ip||"未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"region",label:"地理位置"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.region||"0|0|0|未知|未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"subject",label:"主题"}}),e("el-table-column",{attrs:{prop:"payload",label:"Payload","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"send_alert",label:"告警"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(!0===e.row.send_alert?"是":"否")+" ")]}}])}),e("el-table-column",{attrs:{prop:"occur_at",label:"产生时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("date")(e.row.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])})],1),e("Page",{attrs:{size:t.detailData.size,current:t.detailData.current,pageTotal:t.detailData.total},on:{handleSizeChange:t.detailhandleSizeChange,handleCurrentChange:t.detailhandleCurrentChange}})],1)]),e("el-drawer",{attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1)],1)},R=[],T={name:"risk",components:{Page:w.A,CvssScore:b.A,NodeDetail:S.A,filterOption:D.A},data(){return{nameIndex:"蜜罐",groupArray:[{key:"risk_type",desc:"类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"任务名称"}],condData:{},riskLoading:!1,selectArray:[{model:"",placeholder:"风险类型",name:"risk_type",dataArray:[{key:"暴力破解",desc:"暴力破解"},{key:"病毒事件",desc:"病毒事件"},{key:"弱口令",desc:"弱口令"},{key:"数据爬虫",desc:"数据爬虫"},{key:"蜜罐应用",desc:"蜜罐应用"},{key:"web攻击",desc:"web攻击"},{key:"登录事件",desc:"登录事件"},{key:"监控事件",desc:"监控事件"}]}],riskData:{},currentPage:1,pageSize:15,detailcurrentPage:1,detailpageSize:15,detailShow:!1,vulnDetailLoading:!1,vulnDetailData:{},filters:[{key:"risk_type",operator:"eq",value:"蜜罐应用"}],filtersQuery:[],detailData:{},detalLoading:!1,activeDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",topEchartShow:!1}},created(){this.searchBasic(),this.getCond()},methods:{echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow")},drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(t){this.ipTtitel=t,this.drawer=!0},evnetDetail(t){this.activeDetailData=t,this.detailShow=!0;var e={current:this.detailcurrentPage,size:this.detailpageSize,filters:[{key:"remote_ip",value:t.remote_ip,operator:"eq"},{key:"subject",value:t.subject,operator:"eq"}]};this.detalLoading=!0,this.$request.fetchRisks(e).then((t=>{this.detailData=t.data,this.detalLoading=!1}))},riskShow(){this.$emit("activeClick",!0,!1)},initAttact(){var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchAttack(t).then((t=>{this.riskData=t.data,this.riskLoading=!1}))},getCond(){this.$request.fetchRisksCond().then((t=>{this.condData=t.data}))},searchBasic(){this.filters.length=1,this.filters.push(...this.filtersQuery),this.currentPage=1,this.initAttact()},sheetode(){var t={filters:this.filters};this.$request.fetchSheetode(t).then((t=>{const e=document.createElement("a");let i=new Blob([t.data],{type:"text/csv"});e.style.display="none",e.href=URL.createObjectURL(i);let a=t.headers["content-disposition"].split("''");e.setAttribute("download",decodeURI(a[1])),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},handleSizeChange(t){this.pageSize=t,this.initAttact()},handleCurrentChange(t){this.currentPage=t,this.initAttact()},detailhandleSizeChange(t){this.detailpageSize=t,this.evnetDetail(this.activeDetailData)},detailhandleCurrentChange(t){this.detailcurrentPage=t,this.evnetDetail(this.activeDetailData)},vulnmDetailCancel(){this.detailShow=!1,this.activeDetailData={}}}},P=T,I=(0,d.A)(P,$,R,!1,null,"78db5a81",null),F=I.exports,M={components:{Risk:A,Attack:F,TaskCount:p},name:"vuln",data(){return{riskShow:!0,attackShow:!1,recentData:[],chartShow:!1}},methods:{activeClick(t,e){this.chartShow=!1,this.riskShow=t,this.attackShow=e},activechartShow(){this.chartShow=!this.chartShow},selectChange(t){this.getRecent(t)},getRecent(t){this.$request.fetchRevent(t).then((t=>{this.recentData=t.data,this.recentShow=!0}))}}},O=M,E=(0,d.A)(O,a,s,!1,null,"695e892a",null),q=E.exports},67424:function(t,e,i){i.d(e,{A:function(){return h}});var a=function(){var t=this,e=t._self._c;return e("el-drawer",{staticClass:"vulnDrawer",attrs:{visible:t.visible,direction:"rtl",size:"50%","append-to-body":""},on:{"update:visible":function(e){t.visible=e}},scopedSlots:t._u([{key:"title",fn:function(){return[e("div",[e("el-button",{staticClass:"text-blue-500",attrs:{size:"mini",round:""}},[t._v(t._s(t.riskData.inet))]),e("b",{staticClass:"text-[#000] ml-2"},[t._v(" "+t._s(t.riskData.subject||"--")+" ")])],1)]},proxy:!0}])},[e("div",{staticStyle:{padding:"10px 20px"}},[e("el-descriptions",{attrs:{column:2,labelStyle:{color:"#000","font-weight":600}}},[e("el-descriptions-item",{attrs:{label:"级别"}},["无风险"===t.riskData.level?e("el-tag",{attrs:{type:"success",size:"mini"}},[e("span",[t._v("无风险")])]):t._e(),"低危"===t.riskData.level?e("el-tag",{attrs:{type:"",size:"mini"}},[e("span",[t._v("低危")])]):t._e(),"中危"===t.riskData.level?e("el-tag",{staticStyle:{color:"#adad24","background-color":"#ffff0161","border-color":"#d9d92461"},attrs:{size:"mini"}},[e("span",[t._v("中危")])]):t._e(),"高危"===t.riskData.level?e("el-tag",{attrs:{type:"warning",size:"mini"}},[e("span",[t._v("高危")])]):t._e(),"紧急"===t.riskData.level?e("el-tag",{attrs:{type:"danger",size:"mini"}},[e("span",[t._v("紧急")])]):t._e(),e("el-tag",{staticStyle:{"margin-left":"3px"},attrs:{size:"mini",type:t.riskData.send_alert?"warning":"danger"}},[t._v(" "+t._s(t.riskData.send_alert?"已告警":"未告警")+" ")])],1),e("el-descriptions-item",{attrs:{label:"风险类型"}},[t._v(" "+t._s(t.riskData.risk_type||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"风险ID"}},[t._v(" "+t._s(t.riskData.id)+" ")]),e("el-descriptions-item",{attrs:{label:"终端ID"}},[t._v(" "+t._s(t.riskData.minion_id)+" ")]),e("el-descriptions-item",{attrs:{label:"源IP"}},[t._v(" "+t._s(t.riskData.local_ip||"")+":"+t._s(t.riskData.local_port)+" ")]),e("el-descriptions-item",{attrs:{label:"外部IP"}},[t._v(" "+t._s(t.riskData.remote_ip||"")+":"+t._s(t.riskData.remote_port)+" ")]),e("el-descriptions-item",{attrs:{label:"来源模块"}},[t._v(" "+t._s(t.riskData.from_code||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"归属地"}},[t._v(" "+t._s(t.riskData.region||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"服务端事件创建时间"}},[t._v(" "+t._s(t.riskData.created_at?t.moment(t.riskData.created_at).format("YYYY-MM-DD HH:mm:ss"):"--")+" ")]),e("el-descriptions-item",{attrs:{label:"事件产生本地时间"}},[t._v(" "+t._s(t.riskData.occur_at?t.moment(t.riskData.occur_at).format("YYYY-MM-DD HH:mm:ss"):"--")+" ")]),e("el-descriptions-item",{attrs:{label:"参考信息",span:2}},[e("jsonView",{attrs:{data:t.riskData.referenceHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"攻击载荷",span:2}},[e("jsonView",{attrs:{data:t.riskData.payloadHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"template",span:2}},[e("jsonView",{attrs:{data:t.riskData.templateHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"metadata",span:2}},[e("jsonView",{attrs:{data:t.riskData.metadata||"--",beauty:!1}})],1)],1)],1)])},s=[],l=i(67451),r=i(95093),n=i.n(r);function o(t){try{return t=decodeURIComponent(t),JSON.parse(t)}catch(e){return t}}var c={components:{jsonView:l.A},data(){return{moment:n(),riskData:{inet:null,level:null,send_alert:null,risk_type:null,subject:null,local_ip:null,local_port:null,remote_ip:null,remote_port:null,from_code:null,region:null,created_at:null,occur_at:null,reference:null,payload:null,payloadHJS:null,referenceHJS:null,metadata:null,template:null,templateHJS:null},visible:!1}},methods:{openRiskDetail(t){this.$set(this,"riskData",t),this.riskData.payloadHJS=o(this.riskData.payload),this.riskData.referenceHJS=o(this.riskData.reference),this.riskData.templateHJS=o(this.riskData.template),this.visible=!0}}},d=c,u=i(81656),p=(0,u.A)(d,a,s,!1,null,"56788c05",null),h=p.exports},12878:function(t,e,i){var a=i(85471);a["default"].filter("date",(function(t,e){var i=new Date(t),a={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var s in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp(`(${s})`).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?a[s]:("00"+a[s]).substr((""+a[s]).length)));return e}))}}]);