"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[7843],{62476:function(e,t,a){a.d(t,{Z:function(){return x}});var i=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("div",{staticClass:"tableHead"},[t("div",{staticStyle:{flex:"1","margin-right":"5px"}},[e._t("right_top_btn")],2),t("span",{staticClass:"icon"},[e.refreshAble?t("i",{staticClass:"el-icon-refresh",attrs:{title:"重加载数据"},on:{click:e.loadData}}):e._e(),e.configAble&&"inhead"!==e.configIconPos?t("i",{class:{"el-icon-setting":!0},attrs:{title:"编辑表格"},on:{click:function(t){e.dialogVisible=!0}}}):e._e()])]),t("div",{staticStyle:{position:"relative"}},[e.configAble&&"inhead"===e.configIconPos?t("i",{staticClass:"el-icon-setting iconInHead",attrs:{title:"编辑表格"},on:{click:function(t){e.dialogVisible=!0}}}):e._e()]),t("el-table",e._g(e._b({ref:"table",staticStyle:{width:"100%"},attrs:{"header-cell-style":e.$attrs["header-cell-style"]||{color:"#909399",textAlign:"center",background:"#f5f7fa"},data:e.showData,stripe:e.stripe},on:{"selection-change":e.selectionChange}},"el-table",e.$attrs,!1),e.$listeners),[e.selection?t("el-table-column",{attrs:{selectable:e.selectable,type:"selection"}}):e._e(),e.index?t("el-table-column",{attrs:{type:"index",label:"序号",align:"center",fixed:"left"}}):e._e(),e._l(e.showColumn,(function(a,i){return[t("el-table-column",{key:i,attrs:{prop:a&&a.prop,label:a&&a.label,width:a&&a.width,"min-width":a&&a["min-width"],fixed:a&&a.fixed,formatter:a&&a.formatter,"show-overflow-tooltip":a&&a["show-overflow-tooltip"]||!1,sortable:a&&a.sortable,"sort-method":a&&a["sort-method"],"sort-by":a&&a["sort-by"],align:a&&a.align||"center","sort-orders":a&&a["sort-orders"],type:a&&a.type,"class-name":a&&a["class-name"]},scopedSlots:e._u([a&&a.slotHeader?{key:"header",fn:function(t){return[e._t(a&&a.slotHeader,null,{row:t.row,col:a,$index:t.$index})]}}:null,a&&a.slot?{key:"default",fn:function(t){return[e._t(a&&a.slot,null,{row:t.row,col:a,$index:t.$index})]}}:null],null,!0)})]}))],2),e.needPagination?t("div",{style:e.paginationStyle},[t("el-pagination",{attrs:{"current-page":e.pagination.pageIndex,"page-sizes":e.pagination.pageSizes||[15,30,50],"page-size":e.pagination.pageSize,layout:e.pagination.layout||"jumper, sizes, prev, pager, next,total",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.pagination,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageIndex",t)},"update:pageSize":function(t){return e.$set(e.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.pagination,"pageSize",t)}}})],1):e._e(),t("ColumnConfig",{attrs:{columns:e.filterColumns,visible:e.dialogVisible,selectColumn:e.selectedColumn},on:{"update:visible":function(t){e.dialogVisible=t},"update:selectColumn":function(t){e.selectedColumn=t},"update:select-column":function(t){e.selectedColumn=t}}})],1)},l=[],o=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"设置需展示的列",visible:e.dialogVisible,width:"800px","append-to-body":""},on:{open:function(t){return e.opened()},"update:visible":function(t){e.dialogVisible=t}}},[t("div",[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),t("el-button",{staticStyle:{"text-decoration":"underline",color:"red"},attrs:{type:"text"},on:{click:function(t){return e.$refs.SortColumn.open()}}},[e._v("手动排序")]),t("el-button",{staticStyle:{"text-decoration":"underline",color:"red"},attrs:{type:"text"},on:{click:e.reset}},[e._v("重置配置")]),t("div",{staticStyle:{margin:"15px 0"}}),t("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.checkboxSelectBuff,callback:function(t){e.checkboxSelectBuff=t},expression:"checkboxSelectBuff"}},e._l(e.__column,(function(a){return t("el-col",{key:a.columnUUkey,staticClass:"colCheckbox",attrs:{span:8}},[t("el-checkbox",{attrs:{title:a.label,label:a.columnUUkey}},[e._v(e._s(a.label)+" ")])],1)})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)]),t("SortColumn",{ref:"SortColumn",attrs:{column:e.__column},on:{close:e.clsoeSort}})],1)},s=[],n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"拖动节点进行排序",visible:e.dialogVisible,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-tree",{attrs:{data:e.data,"node-key":"columnUUkey","default-expand-all":"",draggable:"","allow-drop":e.allowDrog}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.close}},[e._v("确 定")])],1)],1)},r=[],c={props:{column:{type:Array,require:!0}},data(){return{data:[],dialogVisible:!1}},created(){},methods:{open(){this.dialogVisible=!0,this.data=this.column.map((e=>({columnUUkey:e.columnUUkey,label:e.label})))},close(){this.dialogVisible=!1,this.$emit("close",this.data.map((e=>e.columnUUkey)))},allowDrog(e,t,a){return"inner"!==a}}},d=c,u=a(1001),p=(0,u.Z)(d,n,r,!1,null,null,null),h=p.exports,m={props:{columns:{type:Array,default:()=>[]},visible:{type:Boolean,require:!0,default:!1},selectColumn:{type:Array,default:()=>[]}},components:{SortColumn:h},computed:{dialogVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}},checkboxSelect:{get(){return this.selectColumn},set(e){this.$emit("update:selectColumn",e)}},__column(){return this.columns.map((e=>({label:e.label,columnUUkey:e.prop||e.slot}))).sort(((e,t)=>(this.__sortWeight[e.columnUUkey]||0)-(this.__sortWeight[t.columnUUkey]||0)))},__sortWeight(){const e={};for(let t=0;t<this.sortColumnList.length;t++)e[this.sortColumnList[t]]=t;return e}},data(){return{sortColumnList:[],checkAll:!1,isIndeterminate:!1,checkboxSelectBuff:[],oldColumns:[]}},methods:{handleCheckAllChange(e){this.checkboxSelectBuff=e?this.__column.map((e=>e.columnUUkey)):[],this.isIndeterminate=!1},handleCheckedCitiesChange(e){this.checkboxSelectBuff=e;let t=e.length;this.checkAll=t===this.__column.length,this.isIndeterminate=t>0&&t<this.__column.length},opened(){const e=this.__column.filter((e=>!this.oldColumns.includes(e.columnUUkey))).map((e=>e.columnUUkey));this.checkboxSelectBuff=this.checkboxSelectBuff.concat(e).sort(((e,t)=>(this.__sortWeight[e]||0)-(this.__sortWeight[t]||0))),this.oldColumns=this.__column.map((e=>e.columnUUkey)),this.checkAll=this.checkboxSelectBuff.length===this.__column.length,this.isIndeterminate=this.checkboxSelectBuff.length>0&&this.checkboxSelectBuff.length<this.__column.length},clsoeSort(e){this.sortColumnList=this.oldColumns=e||[],this.checkboxSelectBuff=this.checkboxSelectBuff.sort(((e,t)=>(this.__sortWeight[e]||0)-(this.__sortWeight[t]||0)))},reset(){this.sortColumnList=[],this.checkboxSelectBuff=this.__column.map((e=>e.columnUUkey))},confirm(){this.checkboxSelect=this.checkboxSelectBuff,this.sortColumnList=this.oldColumns,this.dialogVisible=!1}}},f=m,g=(0,u.Z)(f,o,s,!1,null,"25f6eb76",null),_=g.exports,b={name:"table_list",components:{ColumnConfig:_},props:{data:{type:Array,required:!0,default:()=>[]},pagination:{type:Object,default:()=>({pageIndex:1,pageSize:15,total:0,pageSizes:[15,30,50],layout:"jumper, sizes, prev, pager, next,total"})},localPaginate:{type:Boolean,default:!1},needPagination:{type:Boolean,default:!0},columns:{required:!0,type:Array,default:()=>[]},index:{type:Boolean,default:!1},selection:{type:Boolean,default:!1},selectable:{type:Function,default:()=>()=>{}},selectCountLimit:{type:Number,default:1e6},checkedData:{type:Array,default:()=>[]},configAble:{type:[Boolean],default:!0},configIconPos:{default:"",type:String},refreshAble:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1}},computed:{paginationStyle(){return{display:"flex","padding-top":"10px","flex-direction":"row","justify-content":"left"===this.pagination.align?"flex-start":"flex-end"}},filterColumns(){return this.columns.filter((e=>e.hidden&&"function"===typeof e.hidden?!e.hidden():!e.hidden))},showColumn(){let e=this.filterColumns;return this.selectedColumn.length&&(e=this.selectedColumn.map((e=>this.filterColumns.find((t=>t.prop===e||t.slot===e)))).filter((e=>!!e))),e.map((e=>({...e,columnUUkey:e.prop||e.slot})))},showData(){if(!this.data||!this.data.length)return[];if(!this.needPagination)return this.data;const e=Math.max(this.pagination.pageSize*(this.pagination.pageIndex-1),0),t=Math.min(this.data.length,e+this.pagination.pageSize);return this.data.length===this.pagination.total?this.data.slice(e,t):this.data},_checkedData:{get(){return this.checkedData},set(e){this.$emit("update:checkedData",e)}}},data(){return{selectedColumn:[],dialogVisible:!1}},watch:{data:{handler(e,t){this.resetSelect(),this.localPaginate&&(this.pagination.total=this.data&&this.data.length||0)},immediate:!0},filterColumns(){this.selectedColumn=[]}},mounted(){this.resetSelect()},methods:{loadData(){this.$emit("loadData")},reload(){this.pagination.pageIndex=1,this._checkedData=[],this.$emit("loadData")},selectionChange(e,t){if(e&&e.length>this.selectCountLimit){this.$refs.table.clearSelection();for(let t=0;t<this.selectCountLimit;t++)this.$refs.table.toggleRowSelection(e[e.length-t-1],!0)}else this._checkedData=e},resetSelect(){if(this.$refs.table){this.$refs.table.clearSelection();for(let e of this.data)for(let t of this._checkedData)JSON.stringify(e)===JSON.stringify(t)&&this.$refs.table.toggleRowSelection(e,!0)}},handleSizeChange(){this.localPaginate||(this.pagination.pageIndex=1,this.loadData())},handleCurrentChange(){!this.localPaginate&&this.loadData()}}},y=b,k=(0,u.Z)(y,i,l,!1,null,"6202e7cb",null),x=k.exports},47843:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var i=function(){var e=this,t=e._self._c;return t("div",[t("tableList",{ref:"tableListRef",attrs:{columns:e.columns,data:e.tableData,refreshAble:"",pagination:e.pagination},on:{loadData:e.loadData,"row-click":e.openInfo},scopedSlots:e._u([{key:"right_top_btn",fn:function(){return[e._t("prefix"),t("el-button",{staticStyle:{"margin-right":"3px"},attrs:{size:"mini",type:"primary"},on:{click:e.add}},[e._v("添加")]),t("el-input",{staticStyle:{width:"200px","margin-right":"3px"},attrs:{clearable:"",placeholder:"请输入名称",size:"mini"},on:{blur:e.reload},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.reload.apply(null,arguments)}},model:{value:e.form.keyword,callback:function(t){e.$set(e.form,"keyword",t)},expression:"form.keyword"}}),t("el-button",{staticStyle:{color:"#909399",background:"#f4f4f5","border-color":"#d3d4d6"},attrs:{icon:"el-icon-search",size:"mini"},on:{click:e.reload}})]},proxy:!0},{key:"operate",fn:function({row:a}){return[t("el-button",{staticStyle:{"margin-right":"5px"},attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.edit(a)}}},[e._v("编辑")]),t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.deleteItem(a)}}},[t("el-button",{staticStyle:{color:"red"},attrs:{slot:"reference",type:"text"},on:{click:function(e){e.stopPropagation()}},slot:"reference"},[e._v("删除")])],1)]}}],null,!0)}),t("detail",{ref:"detailRef",on:{reload:e.loadData}}),t("info",{ref:"infoRef"})],1)},l=[],o=a(62476),s=a(30381),n=a.n(s),r=a(90023),c=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.dialogVisible,title:"add"===e.form.operateType?"新增":"编辑",width:"800px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"formRef",attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"名称",prop:"name",rules:e.required}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"证书",rules:e.required,prop:"certificate"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:7}},model:{value:e.form.certificate,callback:function(t){e.$set(e.form,"certificate",t)},expression:"form.certificate"}})],1),t("el-form-item",{attrs:{label:"私钥",rules:e.required,prop:"private_key"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:7}},model:{value:e.form.private_key,callback:function(t){e.$set(e.form,"private_key",t)},expression:"form.private_key"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v(e._s("add"===e.form.operateType?"创建":"修改"))])],1)],1)},d=[],u=a(9669),p=a.n(u);class h{constructor(e){this.operateType=e?.operateType||"add",this.id=e?.id,this.name=e?.name,this.certificate=e?.certificate,this.private_key=e?.private_key}}var m={data(){return{dialogVisible:!1,form:new h,required:{required:!0,message:"请检查必填项",trigger:["blur","change"]}}},methods:{async onSubmit(){try{await this.$refs.formRef.validate().catch((()=>{throw"检查必填项"})),await p()("/cert",{method:"add"===this.form.operateType?"post":"put",data:this.form}),this.$message.success("操作成功"),this.$emit("reload"),"add"===this.form.operateType&&(this.dialogVisible=!1)}catch(e){this.$message.error(e)}},open(e,t={}){this.form=new h({operateType:e,...t}),this.dialogVisible=!0}}},f=m,g=a(1001),_=(0,g.Z)(f,c,d,!1,null,"1caba977",null),b=_.exports,y=function(){var e=this,t=e._self._c;return t("div",[t("el-drawer",{attrs:{withHeader:!1,visible:e.visible,direction:"rtl",size:"60%"},on:{"update:visible":function(t){e.visible=t}}},[t("el-descriptions",{attrs:{border:"",column:1}},[t("el-descriptions-item",{attrs:{label:"ID"}},[e._v(e._s(e.certData.id))]),t("el-descriptions-item",{attrs:{label:"名称"}},[e._v(e._s(e.certData.name))]),t("el-descriptions-item",{attrs:{label:"证书",span:2}},[t("pre",{staticStyle:{"overflow-y":"auto","max-height":"200px"},domProps:{textContent:e._s(e.certData.certificate)}})]),t("el-descriptions-item",{attrs:{label:"私钥",span:2}},[t("pre",{staticStyle:{"overflow-y":"auto","max-height":"200px"},domProps:{textContent:e._s(e.certData.private_key)}})]),t("el-descriptions-item",{attrs:{label:"证书版本"}},[e._v(e._s(e.certData.version))]),t("el-descriptions-item",{attrs:{label:"颁发者国家"}},[e._v(e._s(e.certData.iss_country))]),t("el-descriptions-item",{attrs:{label:"颁发者省份"}},[e._v(e._s(e.certData.iss_province))]),t("el-descriptions-item",{attrs:{label:"颁发者组织"}},[e._v(e._s(e.certData.iss_org))]),t("el-descriptions-item",{attrs:{label:"颁发者"}},[e._v(e._s(e.certData.iss_cn))]),t("el-descriptions-item",{attrs:{label:"颁发者组织单位"}},[e._v(e._s(e.certData.iss_org_unit))]),t("el-descriptions-item",{attrs:{label:"主题国家"}},[e._v(e._s(e.certData.sub_country))]),t("el-descriptions-item",{attrs:{label:"主题组织"}},[e._v(e._s(e.certData.sub_org))]),t("el-descriptions-item",{attrs:{label:"主题省份"}},[e._v(e._s(e.certData.sub_province))]),t("el-descriptions-item",{attrs:{label:"主题"}},[e._v(e._s(e.certData.sub_cn))]),t("el-descriptions-item",{attrs:{label:"dns_names"}},[e._v(e._s(e.certData.dns_names))]),t("el-descriptions-item",{attrs:{label:"ip_addresses"}},[e._v(e._s(e.certData.ip_addresses))]),t("el-descriptions-item",{attrs:{label:"email_addresses"}},[e._v(e._s(e.certData.email_addresses))]),t("el-descriptions-item",{attrs:{label:"URL"}},[e._v(e._s(e.certData.uris))]),t("el-descriptions-item",{attrs:{label:"证书生效时间"}},[e._v(e._s(e.certData.not_before&&e.moment(e.certData.not_before).format("YYYY-MM-DD HH:mm:ss")))]),t("el-descriptions-item",{attrs:{label:"证书过期时间"}},[e._v(e._s(e.certData.not_after&&e.moment(e.certData.not_after).format("YYYY-MM-DD HH:mm:ss")))]),t("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.certData.created_at&&e.moment(e.certData.created_at).format("YYYY-MM-DD HH:mm:ss")))]),t("el-descriptions-item",{attrs:{label:"更新时间"}},[e._v(e._s(e.certData.updated_at&&e.moment(e.certData.updated_at).format("YYYY-MM-DD HH:mm:ss")))])],1)],1)],1)},k=[],x={data(){return{moment:n(),visible:!1,certData:{id:null,name:null,certificate:null,private_key:null,version:null,iss_country:[],iss_province:[],iss_org:[],iss_cn:null,iss_org_unit:[],sub_country:[],sub_org:[],sub_province:[],sub_cn:null,dns_names:[],ip_addresses:[],email_addresses:[],uris:[],not_before:null,not_after:null,created_at:null,updated_at:null}}},methods:{open(e){this.certData=e,this.visible=!0}}},v=x,C=(0,g.Z)(v,y,k,!1,null,"7af28e22",null),D=C.exports,S={components:{tableList:o.Z,detail:b,info:D},data(){return{form:{keyword:this.$route?.query.keyword||""},tableData:[],columns:[{label:"ID",prop:"id",width:"200px"},{label:"名称",prop:"name"},{label:"版本",prop:"version",width:80},{label:"颁发者",prop:"iss_cn"},{label:"主题",prop:"sub_cn"},{label:"证书生效时间",prop:"not_before",width:"150px",formatter(e){return e.not_before&&n()(e.not_before).format("YYYY-MM-DD HH:mm:ss")}},{label:"证书过期时间",prop:"not_after",width:"150px",formatter(e){return e.not_after&&n()(e.not_after).format("YYYY-MM-DD HH:mm:ss")}},{label:"创建时间",prop:"created_at",width:"150px",formatter(e){return e.created_at&&n()(e.created_at).format("YYYY-MM-DD HH:mm:ss")}},{label:"更新时间",prop:"updated_at",width:"150px",formatter(e){return e.updated_at&&n()(e.updated_at).format("YYYY-MM-DD HH:mm:ss")}},{label:"操作",fixed:"right",width:"120px",slot:"operate"}],pagination:{pageIndex:1,pageSize:15,total:0}}},created(){this.loadData()},methods:{reload(){this.pagination.pageIndex=1,this.loadData()},async loadData(){try{this.$router.replace({path:this.$route.path,query:{keyword:this.form.keyword}}).catch((()=>{}));const{data:e}=await r.Z.get("/certs",{params:{keyword:this.form.keyword,current:this.pagination.pageIndex,size:this.pagination.pageSize}});this.tableData=e?.records,this.pagination.total=e?.total||0}catch(e){this.$message.error(e)}},add(){this.$refs.detailRef.open("add")},edit(e){this.$refs.detailRef.open("edit",e)},async deleteItem(e){try{await r.Z.delete("/cert",{data:{id:e.id}}),this.$message.success("操作成功"),this.loadData()}catch(t){this.$message.error(t)}},openInfo(e){this.$refs.infoRef.open(e)}}},w=S,$=(0,g.Z)(w,i,l,!1,null,"9bb205de",null),Y=$.exports}}]);