"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[6626],{49236:function(t,e,a){a.d(e,{Z:function(){return p}});var i=function(){var t=this,e=t._self._c;return e("detail",t._g(t._b({},"detail",t.$attrs,!1),t.$listeners))},l=[],s=a(50265),n={components:{detail:s.Z}},r=n,o=a(1001),c=(0,o.Z)(r,i,l,!1,null,null,null),p=c.exports},84241:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t._self._c;return t.condData?e("div",[t.multiCondition?e("el-row",{staticStyle:{"margin-bottom":"5px"}},[e("el-col",{attrs:{span:24}},t._l(t.filters,(function(a,i){return e("span",{key:i,staticStyle:{"margin-right":"5px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff",display:"inline-block"}},[t._v(" "+t._s(a.keyDesc)+" "+t._s(a.operatorDesc)+" "+t._s(a.value)+" "),e("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.editTag(a,i)}}}),e("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delTag(a,i)}}})])})),0)],1):t._e(),e("div",{class:"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?"dom":"doms"},[t._l(t.selectArray,(function(a,i){return e("span",{key:i},["蜜罐"!==t.nameIndex?e("el-dropdown",{staticStyle:{"margin-right":"5px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v(" "+t._s(a.placeholder)),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(a.dataArray,(function(i){return e("el-dropdown-item",{key:i.key,attrs:{value:i.key},nativeOn:{click:function(e){return t.selectActive(i,a)}}},[t._v(t._s(i.desc))])})),1)],1):t._e()],1)})),"事件展示"===t.nameIndex?e("span",[e("el-dropdown",{staticStyle:{"margin-right":"5px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v(" 时间搜索"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.eventTime,(function(a){return e("el-dropdown-item",{key:a.value,attrs:{value:a.value},nativeOn:{click:function(e){return t.eventTimeChange(a)}}},[t._v(t._s(a.label))])})),1)],1)],1):t._e(),"事件详情"===t.nameIndex?e("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.oneClear}},[t._v("一键清除")]):t._e(),"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?e("el-button",{staticStyle:{"margin-right":"7px"},attrs:{type:"success",size:"mini"},on:{click:t.refresh}},[t._v("刷新")]):t._e(),e("el-select",{staticStyle:{width:"150px","margin-right":"7px"},attrs:{size:"mini","value-key":"key"},on:{change:t.selectField},model:{value:t.key,callback:function(e){t.key=e},expression:"key"}},[t._l(t.condData.conditions,(function(a,i){return[a.key!==t.eventLogon?e("el-option",{key:i,attrs:{value:a.key,label:a.desc}}):t._e()]}))],2),e("el-select",{staticStyle:{width:"100px","margin-right":"7px"},attrs:{size:"mini","value-key":"key"},on:{change:t.selectOperator},model:{value:t.operator,callback:function(e){t.operator=e},expression:"operator"}},t._l(t.selectFieldDerive.operatorArray,(function(t,a){return e("el-option",{key:a,attrs:{value:t.key,label:t.desc}})})),1),["datetime","time"].includes(t.selectFieldDerive.typeConditions)?e("span",{staticStyle:{display:"inline-block","margin-right":"7px"}},[e("el-date-picker",{attrs:{clearable:"",type:"datetime",pickerOptions:t.pickerOptions,placeholder:"选择时间",size:"mini"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1):e("span",{staticStyle:{display:"inline-block","margin-right":"7px"}},[t.selectFieldDerive.selectType?e("el-select",{staticStyle:{width:"180px"},attrs:{size:"mini",clearable:"","value-key":"key",multiple:"in"===t.operator||"notin"===t.operator,"collapse-tags":""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.selectFieldDerive.valueArray,(function(t,a){return e("el-option",{key:a,attrs:{value:t.key,label:t.desc}})})),1):e("span",{staticStyle:{position:"relative",display:"inline-block"}},[e("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",clearable:""},on:{focus:function(e){t.suggestVisible=!0}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1),e("el-button",{class:"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?"buttons":"buttonsearch",attrs:{icon:"el-icon-search",size:"mini"},on:{click:()=>{t.suggestVisible=!1,t.searchCond()}}},[t._v(t._s(t.titleH)+" ")])],2)],1):t._e()},l=[],s={name:"index",props:{titleH:{type:String,default:function(){return""}},condData:{type:Object,default:function(){return{}}},defaultData:{type:Object,default:function(){return{}}},eventLogon:{type:String,default:function(){return""}},nameIndex:{type:String,default:function(){return""}},selectArray:{type:Array,default:function(){return[]}},multiCondition:{default:!0},inputSuggestOptions:{type:Object}},computed:{selectFieldDerive(){var t=this.condData?.conditions?.findIndex((t=>t.key===this.key));return{operatorArray:this.condData?.conditions?.[t]?.operators||[],selectType:this.condData?.conditions?.[t]?.enum,valueArray:this.condData?.conditions?.[t]?.enums||[],typeConditions:this.condData?.conditions?.[t]?.type}},suggestOption(){return this.inputSuggestOptions&&this.inputSuggestOptions[this.key]||[]}},data(){return{operator:"",value:null,key:"",filters:[],current:1,pageSize:15,suggestVisible:!1,eventTime:[{value:"900",label:"十五分钟"},{value:"3600",label:"一小时"},{value:"86400",label:"一天"},{value:"604800",label:"一周"},{value:"2592000",label:"一个月"}],pickerOptions:{disabledDate(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(t){t.$emit("pick",new Date)}},{text:"昨天",onClick(t){const e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick(t){const e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}},{text:"三十天前",onClick(t){const e=new Date;e.setTime(e.getTime()-2592e6),t.$emit("pick",e)}}]}}},created(){const t=this.filters.push.bind(this.filters);this.filters.push=(...e)=>{for(let a of e){const e=this.filters.find((t=>t.key===a.key));e?Object.assign(e,a):(!this.multiCondition&&this.filters.length>0&&(this.filters.length=0),t(a))}},"彻底删除"===this.nameIndex?(this.filters.push(this.getSelectItem("status","eq","4")),this.$emit("searchBasic",this.filters)):(this.key=this.defaultData?.key||null,this.operator=this.defaultData?.operator||null)},methods:{refresh(){this.$emit("refresh")},oneClear(){this.$emit("oneClear")},selectField(t){this.value=void 0,this.$nextTick((()=>{this.operator=this.selectFieldDerive.operatorArray.some((t=>"like"===t.key))?"like":this.selectFieldDerive.operatorArray?.[0].key}))},selectOperator(t){this.operatorValue=t.key,this.value=null},eventTimeChange(t){this.filters.length=0,this.filters.push(this.getSelectItem("created_at","lt",new Date)),this.filters.push(this.getSelectItem("created_at","gt",new Date(new Date-24e3*t.value))),this.$emit("searchBasic",this.filters)},selectActive(t,e){this.filters.push(this.getSelectItem(e.name,"eq",t.key)),this.$emit("searchBasic",this.filters)},delTag(t,e){("蜜罐"!==this.nameIndex&&"事件详情"!==this.nameIndex&&"风险详情"!==this.nameIndex||0!==e)&&(this.filters.splice(e,1),this.$emit("searchBasic",this.filters))},editTag(t,e){("蜜罐"!==this.nameIndex&&"事件详情"!==this.nameIndex&&"风险详情"!==this.nameIndex||0!==e)&&(this.key=t.key,this.value=t.value,this.operator=t.operator)},getSelectItem(t,e,a){return{key:t,keyDesc:this.condData?.conditions?.find((e=>e.key===t))?.desc,value:a,operator:e,operatorDesc:this.selectFieldDerive.operatorArray.find((t=>t.key===e))?.desc}},searchCond(){if(""!==this.key&&void 0!==this.value&&void 0!==this.operator&&null!==this.value&&""!==this.value){const t=this.getSelectItem(this.key,this.operator,this.value);this.filters.push(t)}if(!this.value&&this.key){const t=this.filters.find((t=>t.key===this.key));-1!==t&&this.filters.splice(t,1)}this.$emit("searchBasic",this.filters)},setOption(t,e,a){this.key=t,this.operator=e,this.value=a,this.searchCond()}},watch:{nameIndex:function(t,e){"彻底删除"===t&&t!==e&&(this.filters.push(this.getSelectItem("status","eq","4")),this.$emit("searchBasic",this.filters))}}},n=s,r=a(1001),o=(0,r.Z)(n,i,l,!1,null,"1e98ace1",null),c=o.exports},20039:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",[4===t.cvssScore||"紧急"===t.cvssScore?e("div",{staticStyle:{height:"24px",margin:"0 auto"}},[e("div",{staticClass:"severity-critical-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(0)]):t._e(),3===t.cvssScore||"高危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-high-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(1)]):t._e(),2===t.cvssScore||"中危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-medium-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(2)]):t._e(),1===t.cvssScore||"低危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-low-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(3)]):t._e(),0===t.cvssScore||"无风险"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-no-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(4)]):t._e()])},l=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("紧急")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("高危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("中危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("低危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("无风险")])])])}],s={name:"CvssScore",props:["cvssScore"]},n=s,r=a(1001),o=(0,r.Z)(n,i,l,!1,null,"77d4d761",null),c=o.exports},57282:function(t,e,a){a.r(e),a.d(e,{default:function(){return G}});var i=function(){var t=this,e=t._self._c;return e("div",[e("el-card",[t.componentsShow?e("ComponentVuln",{on:{activeVulnClick:t.activeVulnClick}}):t._e(),t.fileShow?e("File",{on:{activeVulnClick:t.activeVulnClick}}):t._e(),t.vulnShow?e("Vuln",{on:{activeVulnClick:t.activeVulnClick}}):t._e()],1)],1)},l=[],s=a(12037),n=function(){var t=this,e=t._self._c;return e("span",[e("el-row",[e("el-col",{attrs:{span:18}},[e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filters,callback:function(e){t.filters=e},expression:"filters"}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:t.clickScan}},[t._v("同步"),e("i",{staticClass:"el-icon-refresh-left el-icon--right"})]),e("el-button-group",[e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.componentShow}},[t._v("组件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.fileShow}},[t._v("文件")]),e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("漏洞库")])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.vulnLoading,expression:"vulnLoading"}],staticStyle:{"margin-top":"5px"},attrs:{data:t.vulnmData,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"},align:"center"}},[e("el-table-column",{attrs:{prop:"vuln_id",label:"漏洞编号",width:"180"}}),e("el-table-column",{attrs:{prop:"component",label:"组件信息",width:"180"}}),e("el-table-column",{attrs:{prop:"version",label:"版本信息",width:"150"}}),e("el-table-column",{attrs:{prop:"purl",label:"purl"}}),e("el-table-column",{attrs:{prop:"score",label:"风险值",width:"120"}}),e("el-table-column",{attrs:{width:"120",label:"风险等级",filters:[{text:"紧急",value:"紧急"},{text:"高危",value:"高危"},{text:"中危",value:"中危"},{text:"低危",value:"低危"},{text:"无风险",value:"无风险"}],"filter-method":t.filterTag},scopedSlots:t._u([{key:"default",fn:function(t){return[e("CvssScore",{attrs:{cvssScore:t.row.level}})]}}])}),e("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.vulnDetailCilck(a.row)}}},[t._v("查看")])]}}])})],1),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.pageTotal},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"vulnDrawer",attrs:{visible:t.vulnDetailShow,direction:"rtl",size:"40%"},on:{"update:visible":function(e){t.vulnDetailShow=e},close:t.vulnmDetailCancel}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.vulnDetailLoading,expression:"vulnDetailLoading"}],staticStyle:{padding:"0 20px"}},[e("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("漏洞描述")])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("编号 "),e("span",{staticClass:"subtitle"},[e("a",{attrs:{target:"_blank",href:t.activeDetail.reference}},[t._v(" "+t._s(t.activeDetail.vuln_id)+" ")])])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("评分"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.activeDetail.score))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("等级"),e("span",{staticClass:"subtitle"},[0===t.activeDetail.level?e("el-tag",{staticStyle:{background:"#777 none","border-color":"#4dbd74",color:"#fff"},attrs:{size:"mini"}},[t._v(" 无风险 ")]):t._e(),1===t.activeDetail.level?e("el-tag",{staticStyle:{background:"#4dbd74 none","border-color":"#4dbd74",color:"#fff"},attrs:{size:"mini"}},[t._v(" 低危 ")]):t._e(),2===t.activeDetail.level?e("el-tag",{staticStyle:{background:"#ffc107 none","border-color":"#ffc107",color:"#fff"},attrs:{size:"mini"}},[t._v(" 中危 ")]):t._e(),3===t.activeDetail.level?e("el-tag",{staticStyle:{background:"#fd8c00 none","border-color":"#fd8c00",color:"#fff"},attrs:{size:"mini"}},[t._v(" 高危 ")]):t._e(),4===t.activeDetail.level?e("el-tag",{staticStyle:{background:"#f86c6b none","border-color":"#f86c6b",color:"#fff"},attrs:{size:"mini"}},[t._v(" 紧急 ")]):t._e()],1)])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("purl"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.activeDetail.purl))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("描述"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.activeDetail.description))])])],1)],1),e("el-row",{staticStyle:{"margin-top":"20px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("相关文件")])])],1),e("el-table",{staticStyle:{"margin-left":"-10px"},attrs:{data:t.vulnDetailData.records,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"}}},[e("el-table-column",{attrs:{prop:"inet",label:"终端",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(a.row)}}},[t._v(t._s(a.row.inet))])]}}])}),e("el-table-column",{attrs:{prop:"filepath",label:"文件","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"vulns",label:"修改时间",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("date")(e.row.updated_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])})],1),e("Page",{attrs:{size:t.vulnDetailData.size,current:t.vulnDetailData.current,pageTotal:t.vulnDetailData.total},on:{handleSizeChange:t.handleMaterSizeChange,handleCurrentChange:t.handleMaterCurrentChange}})],1)]),e("el-drawer",{attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1)],1)},r=[],o=a(49236),c=a(20039),p=(a(28451),a(84241)),u=a(24861),d={components:{Page:s.Z,CvssScore:c.Z,NodeDetail:o.Z,selectSearch:p.Z,filterOption:u.Z},name:"vuln",data(){return{condData:{},vulnmData:[],vulnname:"",level:[],filters:[],levelArray:[{value:"0",label:"无风险"},{value:"1",label:"低危"},{value:"2",label:"中危"},{value:"3",label:"高危"},{value:"4",label:"紧急"}],vulnLoading:!1,vulnDetailLoading:!1,startTime:"",endTime:"",ipTtitel:{},drawer:!1,directions:"rtl",currentPage:1,pageSize:15,pageTotal:0,searchData:"",vulnDetailShow:!1,vulnDetailData:{},VulnMaterialPage:{currentPage:1,pageSize:15},vulnMaterialData:{},activeDetail:{}}},created(){this.initVuln(),this.getCond()},methods:{getCond(){this.$request.fetchVulnsCond().then((t=>{this.condData=t.data}))},clickScan(){var t={scan:!0,sync:!0};this.$request.fetchPatchScan(t).then((()=>{this.$message({message:"正在同步中!!!",type:"success"})}))},drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(t){this.ipTtitel=t,this.drawer=!0},searchBasic(){this.currentPage=1,this.initVuln()},initVuln(){var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.vulnLoading=!0,this.$request.fetchVulns(t).then((t=>{this.vulnmData=t.data.records.map((t=>(t.purl?(t.component=t.purl.split("/").pop().split("@").shift(),t.version=t.purl.split("/").pop().split("@").pop()):(t.component="",t.version=""),t))),this.pageTotal=t.data.total,this.vulnLoading=!1}))},fileShow(){this.$emit("activeVulnClick",!1,!0,!1)},componentShow(){this.$emit("activeVulnClick",!0,!1,!1)},filterTag(t,e){return e.cvss_score>=9&&e.cvss_score<=10&&"紧急"===t||(e.cvss_score>=7&&e.cvss_score<=8.9&&"高危"===t||(e.cvss_score>=4&&e.cvss_score<=6.9&&"中危"===t||(e.cvss_score>=.1&&e.cvss_score<=3.9&&"低危"===t||(0===e.cvss_score&&"无风险"===t||void 0))))},sheetode(){let t=document.createElement("a");t.href="/api/v1/vuln/csv?authorization="+localStorage.getItem("token"),t.target="_blank",t.click()},vulnmDetailCancel(){this.vulnDetailShow=!1,this.vulnDetailData={}},vulnDetailCilck(t){this.activeDetail=t,this.vulnDetailShow=!0,this.vulnDetailLoading=!0,this.$request.fetchVuln(this.VulnMaterialPage.currentPage,this.VulnMaterialPage.pageSize,t.purl).then((t=>{this.vulnDetailData=t.data,this.vulnDetailLoading=!1}))},handleSizeChange(t){this.pageSize=t,this.initVuln()},handleCurrentChange(t){this.currentPage=t,this.initVuln()},handleMaterSizeChange(t){this.$request.fetchVulnMaterial(this.VulnMaterialPage.currentPage,t,this.activeDetail.id).then((t=>{this.vulnMaterialData=t.data}))},handleMaterCurrentChange(t){this.$request.fetchVulnMaterial(t,this.VulnMaterialPage.pageSize,this.activeDetail.id).then((t=>{this.vulnMaterialData=t.data}))}}},h=d,v=a(1001),f=(0,v.Z)(h,n,r,!1,null,"144fc49d",null),m=f.exports,g=function(){var t=this,e=t._self._c;return e("span",[e("el-row",[e("el-col",{attrs:{span:18}},[e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filters,callback:function(e){t.filters=e},expression:"filters"}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e("el-button-group",[e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.componentShow}},[t._v("组件")]),e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("文件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.vlunShow}},[t._v("漏洞库")])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.fileLoading,expression:"fileLoading"}],staticStyle:{width:"100%","margin-top":"5px"},attrs:{data:t.fileData,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"},"cell-style":{padding:"12px 0"}}},[e("el-table-column",{attrs:{prop:"inet",label:"终端IP",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(a.row)}}},[t._v(t._s(a.row.inet))])]}}])}),e("el-table-column",{attrs:{prop:"filename",label:"文件路径"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.row.filepath,placement:"bottom"}},[e("span",{staticStyle:{display:"inline-block",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v(t._s(a.row.filepath))])])]}}])}),e("el-table-column",{attrs:{prop:"pid",label:"进程pid",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.pid?e("span",[t._v(" - ")]):e("span",[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.processDetail(a.row)}}},[t._v(t._s(a.row.pid))])],1)]}}])}),e("el-table-column",{attrs:{prop:"username",label:"用户名",width:"80"}}),e("el-table-column",{attrs:{prop:"component_num",label:"组件数",width:"80"}}),e("el-table-column",{attrs:{prop:"total_score",label:"风险值",width:"100"}}),e("el-table-column",{attrs:{prop:"modify_at",label:"上次修改时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("date")(e.row.modify_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),e("el-table-column",{attrs:{label:"操作",width:"60"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.fileDetailCilck(a.row)}}},[t._v("查看")])]}}])})],1),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.pageTotal},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"fileDrawer",attrs:{visible:t.fileDetailShow,direction:"rtl",size:"45%"},on:{"update:visible":function(e){t.fileDetailShow=e},close:t.fileDetailCancel}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.fileDetailLoading,expression:"fileDetailLoading"}],staticStyle:{padding:"0 20px"}},[e("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("组件信息")])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("名称："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.filepath))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("大小："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.size))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("组件："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.total_num))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("创建："),e("span",{staticClass:"subtitle"},[t._v(t._s(t._f("date")(t.detailData.created_at,"yyyy-MM-dd hh:mm:ss")))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("更新："),e("span",{staticClass:"subtitle"},[t._v(t._s(t._f("date")(t.detailData.updated_at,"yyyy-MM-dd hh:mm:ss")))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("哈希："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.sha1))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("节点："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.inet))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("pid："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.pid))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程名："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.exe))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("用户信息："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.username))])])],1)],1),e("el-row",{staticStyle:{"margin-top":"20px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("相关文件")])])],1),e("el-table",{staticStyle:{"margin-left":"-10px"},attrs:{data:t.filedetailData.records,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"}},on:{"expand-change":t.expand}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticStyle:{"padding-left":"38px"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.vulnLoading,expression:"vulnLoading"}],attrs:{data:t.sbomVulsData,align:"center"}},[e("el-table-column",{attrs:{prop:"vuln_id",label:"漏洞编号"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"subtitle"},[e("a",{attrs:{target:"_blank",href:a.row.reference}},[t._v(" "+t._s(a.row.vuln_id)+" ")])])]}}],null,!0)}),e("el-table-column",{attrs:{prop:" ",label:"风险等级",filters:[{text:"紧急",value:"紧急"},{text:"高危",value:"高危"},{text:"中危",value:"中危"},{text:"低危",value:"低危"},{text:"无风险",value:"无风险"}],"filter-method":t.filterTag},scopedSlots:t._u([{key:"default",fn:function(t){return[e("CvssScore",{attrs:{cvssScore:t.row.level}})]}}],null,!0)}),e("el-table-column",{attrs:{prop:"score",label:"风险值",sortable:""}})],1)],1)]}}])}),e("el-table-column",{attrs:{prop:"name",label:"组件名称"}}),e("el-table-column",{attrs:{prop:"version",label:"版本号"},scopedSlots:t._u([{key:"default",fn:function(a){return[""===a.row.version?e("span",[t._v("0.0.0")]):e("span",[t._v(t._s(a.row.version))])]}}])}),e("el-table-column",{attrs:{prop:"total_num",label:"漏洞数量"}})],1),e("Page",{attrs:{size:t.filedetailData.size,current:t.filedetailData.current,pageTotal:t.filedetailData.total},on:{handleSizeChange:t.fileDetailSizeChange,handleCurrentChange:t.fileDetailCurrentChange}})],1)]),e("el-drawer",{staticClass:"eventDrawer",attrs:{visible:t.processShow,direction:"rtl",size:"25%"},on:{"update:visible":function(e){t.processShow=e},close:t.processCancel}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.detailProcessShow,expression:"detailProcessShow"}],staticStyle:{padding:"0 20px"}},[e("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("进程详情")])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程名称 "),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.name))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("内存使用"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.mem_size||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程PID"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.pid))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程PPID"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.ppid))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("用户信息"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.username))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("处理字节"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.rss_bytes||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动时间"),t.processDetailData.created_at?e("span",{staticClass:"subtitle"},[t._v(t._s(t._f("date")(t.processDetailData.created_at,"yyyy-MM-dd hh:mm:ss")))]):t._e()])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动参数"),e("span",{staticClass:"subtitle"},[t.processDetailData.args?e("span",[t.processDetailData.args.length>0?e("span",t._l(t.processDetailData.args,(function(a,i){return e("span",{key:i},[e("el-tag",{staticStyle:{"margin-right":"10px"},attrs:{type:"info",size:"mini"}},[t._v(t._s(a))])],1)})),0):t._e()]):e("span",[t._v("-")])])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动命令"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.cmdline||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("checksum"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.checksum||"-"))])])],1)],1)])]),e("el-drawer",{attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1)],1)},_=[],y=function(){var t=this,e=t._self._c;return e("div",[t.data.length>t.num?e("span",[t._l(t.data.slice(0,t.num),(function(a,i){return e("span",{key:i},[t._v(" "+t._s(a[t.type])+" ")])})),e("el-tooltip",{attrs:{placement:"left"}},[e("div",{attrs:{slot:"content"},slot:"content"},t._l(t.data,(function(a,i){return e("span",{key:i},[t._v(" "+t._s(a[t.type])),e("br")])})),0),e("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("+"+t._s(t.data.length))])],1)],2):e("span",t._l(t.data,(function(a,i){return e("span",{key:i},[t._v(" "+t._s(a[t.type])),e("br")])})),0)])},b=[],S={name:"index",props:["data","type","num"]},D=S,w=(0,v.Z)(D,y,b,!1,null,"b27c4866",null),x=w.exports;function C(t){if(0===t)return"0 B";let e=1024,a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(t)/Math.log(e));return i>0?(t/Math.pow(e,i)).toPrecision(3)+" "+a[i]:t.toFixed(2)+" B"}var k={company:C},z={components:{Page:s.Z,TagNumber:x,CvssScore:c.Z,NodeDetail:o.Z,filterOption:u.Z},name:"vuln",data(){return{condData:{},fileData:[],selectForm:{name:"",inet:""},startTime:"",endTime:"",fileDetailShow:!1,filedetailData:{},detailData:{},fileLoading:!1,fileDetailLoading:!1,processShow:!1,currentPage:1,pageSize:15,pageTotal:0,fileDetail:{currentPage:1,pageSize:15},filevulnDetail:{currentPage:1,pageSize:15},searchData:"",vulnDetailShow:!1,vulnDetailData:{},vulnLoading:!1,sbomVulsData:[],detailProcessShow:!1,processDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",filters:[]}},created(){this.initGetFile(),this.getCond()},methods:{expand(t,e){if(-1!==e.indexOf(t)){var a={current:1,size:100,filters:[{key:"purl",operator:"eq",value:t.purl}]};this.vulnLoading=!0,this.$request.fetchsbomVuls(a).then((t=>{this.vulnLoading=!1,this.sbomVulsData=t.data.records}))}},getCond(){this.$request.fetchProjectCond().then((t=>{this.condData=t.data}))},drawerClose(){this.drawer=!1,this.ipTtitel={}},searchBasic(t){this.currentPage=1,this.initGetFile()},innetactive(t){this.ipTtitel=t,this.drawer=!0},vlunShow(){this.$emit("activeVulnClick",!1,!1,!0)},componentShow(){this.$emit("activeVulnClick",!0,!1,!1)},processDetail(t){this.detailProcessShow=!0;var e={current:1,size:10,filters:[{key:"minion_id",operator:"eq",value:t.minion_id},{key:"pid",operator:"eq",value:t.pid+""}]};this.$request.fetchGetProcess(e).then((t=>{t.data.records.length>0&&(this.processDetailData=t.data.records[0]),this.detailProcessShow=!1})),this.processShow=!0},processCancel(){this.processDetailData={},this.processShow=!1},initGetFile(){this.fileLoading=!0;var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.fileLoading=!0,this.$request.fetchMaterial(t).then((t=>{this.fileLoading=!1,this.pageTotal=t.data.total,this.fileData=t.data.records.map((t=>(t.size=k.company(t.size),t)))}))},fileDetailCancel(){this.fileDetailShow=!1,this.detailData={}},fileDetailCilck(t){this.detailData=t,this.fileDetailShow=!0,this.fileDetailLoading=!0;var e={current:this.fileDetail.currentPage,size:this.fileDetail.pageSize,filters:[{key:"minion_id",value:t.minion_id,operator:"eq"},{key:"project_id",value:t.id,operator:"eq"}]};this.$request.fetchFileDetail(e).then((t=>{this.filedetailData=t.data,this.fileDetailLoading=!1}))},filterTag(t,e){return e.cvss_score>=9&&e.cvss_score<=10&&"紧急"===t||(e.cvss_score>=7&&e.cvss_score<=8.9&&"高危"===t||(e.cvss_score>=4&&e.cvss_score<=6.9&&"中危"===t||(e.cvss_score>=.1&&e.cvss_score<=3.9&&"低危"===t||(0===e.cvss_score&&"无风险"===t||void 0))))},handleSizeChange(t){this.pageSize=t,this.initGetFile()},handleCurrentChange(t){this.currentPage=t,this.initGetFile()},fileDetailSizeChange(t){this.fileDetail.pageSize=t,this.fileDetailCilck(this.detailData)},fileDetailCurrentChange(t){this.fileDetail.currentPage=t,this.fileDetailCilck(this.detailData)}}},L=z,P=(0,v.Z)(L,g,_,!1,null,"37e81274",null),T=P.exports,M=function(){var t=this,e=t._self._c;return e("span",[e("el-row",[e("el-col",{attrs:{span:18}},[e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filters,callback:function(e){t.filters=e},expression:"filters"}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e("el-button-group",[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("组件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.fileShow}},[t._v("文件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.vulnShow}},[t._v("漏洞库")])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.fileLoading,expression:"fileLoading"}],staticStyle:{width:"100%","margin-top":"5px"},attrs:{data:t.fileData,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"},"cell-style":{padding:"12px 0"}}},[e("el-table-column",{attrs:{prop:"inet",label:"终端IP"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(a.row)}}},[t._v(t._s(a.row.inet))])]}}])}),e("el-table-column",{attrs:{prop:"name",label:"组件名称"}}),e("el-table-column",{attrs:{prop:"version",label:"版本信息"}}),e("el-table-column",{attrs:{prop:"",label:"漏洞"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"circle_content"},[e("span",{staticClass:"critical"}),t._v(t._s(a.row.critical_num))]),e("span",{staticClass:"circle_content"},[e("span",{staticClass:"high"}),t._v(t._s(a.row.high_num))]),e("span",{staticClass:"circle_content"},[e("span",{staticClass:"medium"}),t._v(t._s(a.row.medium_num))]),e("span",{staticClass:"circle_content"},[e("span",{staticClass:"low"}),t._v(t._s(a.row.low_num))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"60"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.fileDetailCilck(a.row)}}},[t._v("详情")])]}}])})],1),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.pageTotal},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"vulnDrawer",attrs:{visible:t.fileDetailShow,direction:"rtl",size:"40%","z-index":"999"},on:{"update:visible":function(e){t.fileDetailShow=e},close:t.fileDetailCancel}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.fileDetailLoading,expression:"fileDetailLoading"}],staticStyle:{padding:"0 20px"}},[e("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[e("el-row",{staticStyle:{"margin-bottom":"10px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("基础信息")])])],1),e("el-row",{staticStyle:{"margin-bottom":"10px"}},[e("el-col",{attrs:{span:8}},[t._v("组件名称"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.name))])]),e("el-col",{attrs:{span:8}},[t._v("组件版本"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.detailData.version))])]),e("el-col",{attrs:{span:8}},[t._v("漏洞个数"),t.vulnDetailData.records?e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.records.length))]):t._e()])],1)],1),e("el-row",{staticStyle:{"margin-top":"20px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("相关文件")])])],1),e("el-table",{staticStyle:{"margin-left":"-10px"},attrs:{data:t.filedetailData.records,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"}}},[e("el-table-column",{attrs:{prop:"inet",label:"终端IP"}}),e("el-table-column",{attrs:{prop:"filepath",label:"文件名称"}}),e("el-table-column",{attrs:{prop:"updated_at",label:"修改时间",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("date")(e.row.updated_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])})],1),e("el-row",{staticStyle:{"margin-top":"20px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("相关漏洞")])])],1),e("el-table",{staticStyle:{"margin-left":"-10px"},attrs:{data:t.vulnDetailData.records,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"}}},[e("el-table-column",{attrs:{prop:"vuln_id",label:"漏洞编号"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{attrs:{target:"_blank",href:a.row.reference}},[t._v(" "+t._s(a.row.vuln_id)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"filename",label:"严重程度"},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.level?e("el-tag",{staticStyle:{background:"#777 none","border-color":"#4dbd74",color:"#fff"},attrs:{size:"mini"}},[e("span",[t._v("无风险")])]):t._e(),1===a.row.level?e("el-tag",{staticStyle:{background:"#4dbd74 none","border-color":"#4dbd74",color:"#fff"},attrs:{size:"mini"}},[e("span",[t._v("低危")])]):t._e(),2===a.row.level?e("el-tag",{staticStyle:{background:"#ffc107 none","border-color":"#ffc107",color:"#fff"},attrs:{size:"mini"}},[e("span",[t._v("中危")])]):t._e(),3===a.row.level?e("el-tag",{staticStyle:{background:"#fd8c00 none","border-color":"#fd8c00",color:"#fff"},attrs:{size:"mini"}},[e("span",[t._v("高危")])]):t._e(),a.row.level>=4?e("el-tag",{staticStyle:{background:"#f86c6b none","border-color":"#f86c6b",color:"#fff"},attrs:{size:"mini"}},[e("span",[t._v("紧急")])]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"description",label:"描述"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"提示",placement:"left"}},[e("p",{staticStyle:{"max-width":"500px"},attrs:{slot:"content"},slot:"content"},[t._v(" "+t._s(a.row.description)+" ")]),e("span",{staticStyle:{width:"100%",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","-o-text-overflow":"ellipsis"}},[t._v(t._s(a.row.description))])])]}}])})],1)],1)]),e("el-drawer",{staticClass:"eventDrawer",attrs:{visible:t.processShow,direction:"rtl",size:"25%"},on:{"update:visible":function(e){t.processShow=e},close:t.processCancel}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.detailProcessShow,expression:"detailProcessShow"}],staticStyle:{padding:"0 20px"}},[e("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("进程详情")])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程名称 "),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.name))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("内存使用"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.mem_size||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程PID"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.pid))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程PPID"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.ppid))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("用户信息"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.username))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("处理字节"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.rss_bytes||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动时间"),t.processDetailData.created_at?e("span",{staticClass:"subtitle"},[t._v(t._s(t._f("date")(t.processDetailData.created_at,"yyyy-MM-dd hh:mm:ss")))]):t._e()])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动参数"),e("span",{staticClass:"subtitle"},[t.processDetailData.args?e("span",[t.processDetailData.args.length>0?e("span",t._l(t.processDetailData.args,(function(a,i){return e("span",{key:i},[e("el-tag",{staticStyle:{"margin-right":"10px"},attrs:{type:"info",size:"mini"}},[t._v(t._s(a))])],1)})),0):t._e()]):e("span",[t._v("-")])])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动命令"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.cmdline||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("checksum"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.checksum||"-"))])])],1)],1)])]),e("el-drawer",{staticClass:"inetDrawer",attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1)],1)},V=[],I=a(9669),$=a.n(I),q={components:{Page:s.Z,TagNumber:x,CvssScore:c.Z,NodeDetail:o.Z,filterOption:u.Z},name:"vuln",data(){return{condData:{},fileData:[],selectForm:{name:"",inet:""},startTime:"",endTime:"",fileDetailShow:!1,filedetailData:{},detailData:{},fileLoading:!1,fileDetailLoading:!1,processShow:!1,currentPage:1,pageSize:15,pageTotal:0,fileDetail:{currentPage:1,pageSize:15},filevulnDetail:{currentPage:1,pageSize:15},searchData:"",vulnDetailShow:!1,vulnDetailData:{},vulnLoading:!1,sbomVulsData:[],detailProcessShow:!1,processDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",filters:[]}},created(){this.initGetFile(),this.getCond()},methods:{expand(t,e){if(-1!==e.indexOf(t)){var a={current:1,size:100,filters:[{key:"purl",operator:"eq",value:t.purl}]};this.vulnLoading=!0,this.$request.fetchsbomVuls(a).then((t=>{this.vulnLoading=!1,this.sbomVulsData=t.data.records}))}},getCond(){$().get("/sbom/component/cond").then((t=>{this.condData=t.data}))},drawerClose(){this.drawer=!1,this.ipTtitel={}},searchBasic(){this.currentPage=1,this.initGetFile()},innetactive(t){this.ipTtitel=t,this.drawer=!0},fileShow(){this.$emit("activeVulnClick",!1,!0,!1)},vulnShow(){this.$emit("activeVulnClick",!1,!1,!0)},processDetail(t){this.detailProcessShow=!0;var e={current:1,size:10,filters:[{key:"minion_id",operator:"eq",value:t.minion_id},{key:"pid",operator:"eq",value:t.pid+""}]};this.$request.fetchGetProcess(e).then((t=>{t.data.records.length>0&&(this.processDetailData=t.data.records[0]),this.detailProcessShow=!1})),this.processShow=!0},processCancel(){this.processDetailData={},this.processShow=!1},initGetFile(){var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.$request.fetchVulnm(t).then((t=>{this.fileData=t.data.records,this.pageTotal=t.data.total,this.fileLoading=!1})).catch((t=>{this.$message.error(t)}))},fileDetailCancel(){this.fileDetailShow=!1,this.detailData={}},fileDetailCilck(t){this.detailData=t,this.fileDetailShow=!0,this.fileDetailLoading=!0;var e={current:1,size:100,filters:[{key:"purl",value:t.purl,operator:"eq"}]};this.$request.fetchSbomVuln(e).then((t=>{this.vulnDetailData=t.data}));var a={current:this.fileDetail.currentPage,size:this.fileDetail.pageSize,filters:[{key:"minion_id",value:t.minion_id,operator:"eq"},{key:"purl",value:t.purl,operator:"eq"}]};this.$request.fetchFilesDetail(a).then((t=>{this.filedetailData=t.data,this.fileDetailLoading=!1}))},filterTag(t,e){return e.cvss_score>=9&&e.cvss_score<=10&&"紧急"===t||(e.cvss_score>=7&&e.cvss_score<=8.9&&"高危"===t||(e.cvss_score>=4&&e.cvss_score<=6.9&&"中危"===t||(e.cvss_score>=.1&&e.cvss_score<=3.9&&"低危"===t||(0===e.cvss_score&&"无风险"===t||void 0))))},handleSizeChange(t){this.pageSize=t,this.initGetFile()},handleCurrentChange(t){this.currentPage=t,this.initGetFile()},fileDetailSizeChange(t){this.fileDetail.pageSize=t,this.fileDetailCilck(this.detailData)},fileDetailCurrentChange(t){this.fileDetail.currentPage=t,this.fileDetailCilck(this.detailData)}}},B=q,F=(0,v.Z)(B,M,V,!1,null,"2fac4a3d",null),Z=F.exports,O={components:{Page:s.Z,Vuln:m,File:T,ComponentVuln:Z},name:"index",data(){return{vulnShow:!1,fileShow:!1,componentsShow:!0}},methods:{activeVulnClick(t,e,a){this.componentsShow=t,this.fileShow=e,this.vulnShow=a}}},A=O,N=(0,v.Z)(A,i,l,!1,null,"1cee0b4a",null),G=N.exports}}]);