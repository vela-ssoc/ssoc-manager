(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[4202],{8598:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var s=function(){var e=this,t=e._self._c;return t("el-drawer",{attrs:{visible:e.dialogShow,size:"1000px","close-on-press-escape":!1,"destroy-on-close":"","show-close":!1,wrapperClosable:!1,withHeader:!1},on:{"update:visible":function(t){e.dialogShow=t},close:e.closeDialog}},[t("div",{staticClass:"p-1 bg-[#f5f5f5] text-[14px] flex justify-between"},[t("span",[e._v(" "+e._s("a"===e.form.optType?"新增任务":"v"===e.form.optType?"查看任务":"编辑任务")+" > "+e._s(1===e.form.mode?"简易模式":"高级模式")+" > "+e._s(1===e.form.step?"基础信息":"发布策略")+" ")]),t("span",{staticClass:"mr-4 cursor-pointer",on:{click:function(t){e.dialogShow=!1}}},[e._v("X")])]),t("el-card",{attrs:{shadow:"never",size:"mini"}},[t("div",{staticClass:"flex justify-between"},[t("FRadio",{staticClass:"w-[300px]",attrs:{align:"center",disabled:e.disabledMod,size:"mini",options:[{value:1,label:"基础信息"},{value:2,label:"发布策略"}]},model:{value:e.form.step,callback:function(t){e.$set(e.form,"step",t)},expression:"form.step"}}),t("div",[1===e.form.step&&"v"!==e.form.optType?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"配置发布策略",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1):e._e(),2===e.form.step&&"v"!==e.form.optType?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"返回基础信息",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.form.step=1}}},[e._v("上一步")])],1):e._e(),1!==e.form.step||e.form.step_done||"v"===e.form.optType?e._e():t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"保存为草稿，保存后任务并未开始执行",placement:"bottom"}},[t("el-popconfirm",{staticClass:"mx-2",attrs:{title:"确认将任务保存为草稿吗?"},on:{confirm:e.step1Save}},[t("el-button",{attrs:{slot:"reference",size:"mini",type:"primary"},slot:"reference"},[e._v("保存")])],1)],1),2!==e.form.step&&!e.form.step_done||"v"===e.form.optType?e._e():t("el-popconfirm",{staticClass:"mx-2",attrs:{title:1===e.form.exec_type?"确认将任务保存后立即执行?":"确认将任务保存后发布?"},on:{confirm:e.step2Save}},[t("el-tooltip",{staticClass:"item",attrs:{slot:"reference",effect:"dark",content:"发布后如果任务状态为启用，则任务会在合适时间开始执行",placement:"bottom"},slot:"reference"},[t("el-button",{attrs:{size:"mini",type:"success"}},[e._v("保存并"+e._s(1===e.form.exec_type?"执行":"发布"))])],1)],1),"m"===e.form.optType?t("el-popconfirm",{staticClass:"mr-2",attrs:{title:"确定删除当前任务吗？"},on:{confirm:e.deleteTask}},[t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("删除")])],1):e._e()],1)],1)]),1===e.form.step?t("div",{staticClass:"p-[20px]"},[t("div",{staticClass:"mb-2",attrs:{shadow:"never"}},[t("div",{attrs:{shadow:"never"}},[t("el-form",{ref:"formRef",attrs:{model:e.form,size:"small",disabled:"v"===e.form.optType}},[t("el-form-item",{attrs:{label:"任务名称",prop:"name",rules:e.required}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"任务简介",prop:"intro"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1),t("div",{staticClass:"mb-1 flex justify-between"},[1===e.form.mode?[t("div",[t("span",{staticClass:"text-red-500 mr-1"},[e._v("*")]),e._v("任务模板 "),t("el-tag",{attrs:{size:"mini",type:"warning"}},[e._v(" "+e._s(e.form.extension_id?"在下面填写模板所需参数":"点击选择一个模版")+" ")])],1),t("div",["v"!==e.form.optType?t("el-button",{staticClass:"text-red-500",attrs:{type:"text"},on:{click:e.reSelectTemplate}},[e._v("重选模板")]):e._e(),t("el-button",{attrs:{type:"text"},on:{click:e.openPrew}},[e._v(" "+e._s(e.form._previewResult?"关闭预览":"点击预览")+" ")]),e.form._previewResult?t("el-button",{attrs:{type:"text"},on:{click:e.getResultCodeNoSave}},[e._v("刷新预览 ")]):e._e()],1)]:[t("div",[t("span",{staticClass:"text-red-500 mr-1"},[e._v("*")]),e._v("任务脚本")])]],2),t("div",{staticClass:"min-h-[calc(100vh-120px)] h-0"},[1===e.form.mode?[e.form.extension_id?t("div",{staticClass:"bg-[#f1f2f3] rounded p-2"},[t("div",{staticClass:"flex items-center mb-1 justify-between"},[t("div",{staticClass:"flex items-center"},[t("img",{attrs:{src:e.parseImgByIntro(e.form.intro||""),width:"30",height:"30",alt:""}}),t("span",{staticClass:"font-bold text-[16px] text-gray-900 ml-[10px]"},[e._v("模板名称")]),t("span",{staticClass:"ml-[10px] text-[#595757]"},[e._v("(模板是用来xxxxx)")])]),t("div",{staticClass:"mr-[4px] text-[#595757]"},[e._v("更新于2020-23-23")])]),t("el-card",{staticClass:"min-h-full",attrs:{shadow:"never"}},[t("div",{staticClass:"grid grid-cols-1 gap-2 min-h-[440px]",class:{"grid-cols-2":e.form._previewResult}},[t("div",{staticClass:"min-h-full",attrs:{shadow:"never"}},[e.form._formError?t("div",{staticClass:"text-red-600 mt-[100px] text-center"},[e._v(" 发生错误 ："+e._s(e.form._formError)+" ")]):t("FormDesign",{ref:"formDesignRef",attrs:{options:e.form._options,disabled:"v"===e.form.optType},model:{value:e.form.dataCache,callback:function(t){e.$set(e.form,"dataCache",t)},expression:"form.dataCache"}})],1),e.form._previewResult?t("div",{staticClass:"h-full relative"},[t("AceCoderEdit",{attrs:{"read-only":"","show-header":!1,mode:"text",theme:"light"},model:{value:e.form._resultCode,callback:function(t){e.$set(e.form,"_resultCode",t)},expression:"form._resultCode"}})],1):e._e()])])],1):t("el-card",{attrs:{shadow:"never"}},[t("TemplateList",{attrs:{category:"task"},on:{select:e.handleSelect}})],1)]:[t("AceCoderEdit",{attrs:{theme:"light"},scopedSlots:e._u([{key:"icon",fn:function(){return[t("span",{staticClass:"ml-2"},[t("svg",{staticClass:"icon",attrs:{t:"1702014010796",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"12337",width:"200",height:"200"}},[t("path",{attrs:{d:"M917.333333 874.666667h-810.666666a42.666667 42.666667 0 0 0 0 85.333333h810.666666a42.666667 42.666667 0 0 0 0-85.333333zM279.466667 810.666667h465.066666a213.333333 213.333333 0 0 0 213.333334-213.333334V277.333333a213.333333 213.333333 0 0 0-213.333334-213.333333H279.466667a213.333333 213.333333 0 0 0-213.333334 213.333333V597.333333a213.333333 213.333333 0 0 0 213.333334 213.333334z m-128-533.333334a128 128 0 0 1 128-128h465.066666a128 128 0 0 1 128 128V597.333333a128 128 0 0 1-128 128H279.466667a128 128 0 0 1-128-128z","p-id":"12338",fill:"#5e93fd"}}),t("path",{attrs:{d:"M308.906667 562.346667a42.666667 42.666667 0 0 0 60.16 0 42.666667 42.666667 0 0 0 0-60.16l-52.906667-52.906667 55.466667-55.466667a42.666667 42.666667 0 0 0 0-60.16 42.666667 42.666667 0 0 0-60.586667 0L228.266667 416.853333a42.666667 42.666667 0 0 0 0 60.16zM652.373333 562.346667a42.666667 42.666667 0 0 0 60.586667 0l82.773333-83.2a42.666667 42.666667 0 0 0 0-60.16l-80.64-85.333334a42.666667 42.666667 0 1 0-60.16 60.16l52.906667 52.906667-55.466667 55.466667a42.666667 42.666667 0 0 0 0 60.16zM437.333333 577.28a42.666667 42.666667 0 0 0 58.453334-15.36l106.666666-185.173333a42.666667 42.666667 0 0 0-74.24-42.666667l-106.666666 185.173333a42.666667 42.666667 0 0 0 15.786666 58.026667z","p-id":"12339",fill:"#ff7f00"}})])])]},proxy:!0}],null,!1,703634530),model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})]],2)],1)],1)])]):t("div",{staticClass:"p-[20px]"},[t("el-form",{ref:"formRef",attrs:{model:e.form,size:"small","label-width":"100px",disabled:"v"===e.form.optType}},[t("el-form-item",{attrs:{label:"执行方式",required:""}},[t("FRadio",{attrs:{disabled:"v"===e.form.optType,align:"center",options:[{value:1,label:"立即执行"},{value:3,label:"特定时间执行"},{value:4,label:"每天执行"},{value:5,label:"每周执行"},{value:6,label:"每月执行"},{value:2,label:"自定义"}]},model:{value:e.form.exec_type,callback:function(t){e.$set(e.form,"exec_type",t)},expression:"form.exec_type"}})],1),1!==e.form.exec_type?t("el-form-item",{attrs:{label:"任务状态",required:""}},[t("el-radio-group",{model:{value:e.form.enabled,callback:function(t){e.$set(e.form,"enabled",t)},expression:"form.enabled"}},[t("el-radio",{attrs:{label:!0}},[e._v("启用")]),t("el-radio",{attrs:{label:!1}},[e._v("禁用")])],1)],1):e._e(),3===e.form.exec_type?t("el-form-item",{attrs:{label:"执行时间",required:""}},e._l(e.form.specific_times,(function(r,s){return t("div",{key:s,staticClass:"flex justify-between mb-1"},[t("el-date-picker",{staticClass:"flex-1",attrs:{type:"datetime",clearable:!1,"picker-options":{disabledDate:e.disabledDate},placeholder:"选择日期时间"},model:{value:e.form.specific_times[s],callback:function(t){e.$set(e.form.specific_times,s,t)},expression:"form.specific_times[index]"}}),t("span",{staticClass:"ml-2 space-x-1 cursor-pointer"},[t("i",{staticClass:"el-icon-circle-plus-outline",on:{click:e.addSpecificTime}}),t("i",{staticClass:"el-icon-remove-outline",on:{click:function(t){return e.removeSpecificTime(s)}}})])],1)})),0):e._e(),4===e.form.exec_type?t("el-form-item",{attrs:{label:"每天执行",required:""}},[t("FLabelWrapper",{attrs:{label:"几点执行"}},[t("el-time-select",{staticStyle:{width:"100%"},attrs:{"picker-options":{start:"00:00",step:"00:15",end:"23:59"},placeholder:"选择日期时间"},model:{value:e.form._cronObj.d,callback:function(t){e.$set(e.form._cronObj,"d",t)},expression:"form._cronObj.d"}})],1)],1):e._e(),5===e.form.exec_type?t("el-form-item",{attrs:{label:"每周执行",required:""}},[t("div",{staticClass:"grid grid-cols-[144px,1fr] gap-2 w-full"},[t("FLabelWrapper",{attrs:{label:"星期"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form._cronObj.w,callback:function(t){e.$set(e.form._cronObj,"w",t)},expression:"form._cronObj.w"}},[t("el-option",{attrs:{label:"星期一",value:"1"}}),t("el-option",{attrs:{label:"星期二",value:"2"}}),t("el-option",{attrs:{label:"星期三",value:"3"}}),t("el-option",{attrs:{label:"星期四",value:"4"}}),t("el-option",{attrs:{label:"星期五",value:"5"}}),t("el-option",{attrs:{label:"星期六",value:"6"}}),t("el-option",{attrs:{label:"星期日",value:"0"}})],1)],1),t("FLabelWrapper",{attrs:{label:"几点执行"}},[t("el-time-select",{staticStyle:{width:"100%"},attrs:{"picker-options":{start:"00:00",step:"00:15",end:"23:59"},placeholder:"选择日期时间"},model:{value:e.form._cronObj.d,callback:function(t){e.$set(e.form._cronObj,"d",t)},expression:"form._cronObj.d"}})],1)],1)]):e._e(),6===e.form.exec_type?t("el-form-item",{attrs:{label:"每月执行",required:""}},[t("div",{staticClass:"grid grid-cols-[144px,1fr] gap-2 w-full"},[t("FLabelWrapper",{attrs:{label:"几号执行"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form._cronObj.M,callback:function(t){e.$set(e.form._cronObj,"M",t)},expression:"form._cronObj.M"}},e._l(31,(function(e,r){return t("el-option",{key:r,attrs:{label:r+1+"号",value:r+1}})})),1)],1),t("FLabelWrapper",{attrs:{label:"几点执行"}},[t("el-time-select",{staticStyle:{width:"100%"},attrs:{"picker-options":{start:"00:00",step:"00:15",end:"23:59"},placeholder:"选择日期时间"},model:{value:e.form._cronObj.d,callback:function(t){e.$set(e.form._cronObj,"d",t)},expression:"form._cronObj.d"}})],1)],1)]):e._e(),2===e.form.exec_type?t("el-form-item",{attrs:{label:"执行周期",required:""}},[t("FLabelWrapper",{attrs:{label:"cron表达式(分钟级)："+e.cronFormat(e.form.cron)}},[t("el-input",{model:{value:e.form.cron,callback:function(t){e.$set(e.form,"cron",t)},expression:"form.cron"}})],1)],1):e._e(),t("el-form-item",{attrs:{label:"超时时间",required:""}},[t("div",[t("FLabelWrapper",{attrs:{label:`单位：秒 ( ${e.timeoutFormat(e.form.timeout.seconds)} ) `}},[t("el-input",{model:{value:e.form.timeout.seconds,callback:function(t){e.$set(e.form.timeout,"seconds",e._n(t))},expression:"form.timeout.seconds"}})],1)],1)]),t("el-form-item",{attrs:{label:"并发数目",required:""}},[t("el-input",{model:{value:e.form.push_size,callback:function(t){e.$set(e.form,"push_size",e._n(t))},expression:"form.push_size"}})],1),t("el-form-item",{attrs:{label:"生效主机"}},[t("SelectAgentTag",{attrs:{"max-show":26,title:"发布策略 - 生效主机选择"},scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[e._v(" 点击查看明细 ")])]},proxy:!0},{key:"empty",fn:function(){return[t("el-tag",{staticClass:"mr-2",attrs:{size:"mini"}},[e._v("全部机器")])]},proxy:!0}]),model:{value:e.form.filters,callback:function(t){e.$set(e.form,"filters",t)},expression:"form.filters"}})],1),t("el-form-item",{attrs:{label:"排除主机"}},[t("div",[t("SelectAgentTag",{attrs:{"max-show":17,label:"该选项比生效主机优先级更高",mode:"ips"},model:{value:e.form._excludesParse,callback:function(t){e.$set(e.form,"_excludesParse",t)},expression:"form._excludesParse"}})],1)])],1)],1)],1)},o=[],i=r(99726),a=r(88999),n=r(84020),l=r(13919),c=r(95814),p=r(95093),u=r.n(p),f=r(1116),m=r.n(f),d=function(){var e=this,t=e._self._c;return t("FLabelWrapper",{scopedSlots:e._u([{key:"label",fn:function(){return[e._t("label",(function(){return[e._v(e._s(e.label))]}),{total:e.totalCount})]},proxy:!0}],null,!0)},[t("div",{staticClass:"p-[10px] border border-gray-300 rounded-md border-solid cursor-pointer"},[t("div",{on:{click:function(t){return e.openDialog()}}},[e.isEmpty(e.value)?t("div",{staticClass:"text-blue-400 py-[0px] px-[5px]"},[e._t("empty",(function(){return[e._v("点击选择机器")]}))],2):[e.value?.inet_mode?[t("div",{staticClass:"flex flex-wrap"},[e._l(e.value?.inets?.slice(0,e.maxShow)||[],(function(r,s){return t("div",{key:s,staticClass:"w-[87px] truncate",staticStyle:{margin:"2px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff","line-height":"1em"}},[e._v(" "+e._s(r)+" ")])})),e.value?.inets?.length>e.maxShow?t("div",{staticStyle:{margin:"2px","font-size":"12px",color:"#3b82f6",padding:"3px","line-height":"1em"}},[e._v(" +"+e._s(e.value?.inets?.length-e.maxShow)+" ")]):e._e()],2)]:[e.value?.keyword?t("span",{staticStyle:{margin:"2px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff","line-height":"1em",display:"inline-block"}},[e._v(" 关键字: "+e._s(e.value?.keyword)+" ")]):e._e(),e.value?.keyword&&e.value?.filters?.length?t("span",[e._v(" & ")]):e._e(),e._l(e.value?.filters||[],(function(r,s){return[t("span",{key:s},[t("span",{staticStyle:{margin:"2px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff",display:"inline-block","line-height":"1em"}},[e._v(" "+e._s(e.formatCond(r))+" ")]),s!==e.value?.filters?.length-1?t("span",[e._v(" & ")]):e._e()])]}))]]],2),t("agentSelect",{ref:"agentSelectRef",attrs:{title:e.title}})],1)])},h=[],v=r(85471),g=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{visible:e.dialogVisible,width:"1000px","append-to-body":"","destroy-on-close":"","custom-class":"agent-select-dialog","show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"flex items-center justify-between"},[t("span",{staticClass:"text-[16px] font-[600] text-[#515151]"},[e._v(" "+e._s(e.title||"主机选择")+" ")]),e.disabled?e._e():t("span",[t("span",{staticClass:"text-[12px] text-gray-600 mr-1"},[e._v(" ["+e._s("cond"===e.mod?"条件匹配模式":"手动勾选模式")+"] 已匹配："),t("span",{staticClass:"text-blue-500 mr-1"},[e._v(e._s("cond"===e.mod?e.pagination.total:e.checkedData.length))]),e._v("台机器 ")]),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.confirm()}}},[e._v("完成选择")])],1)])]},proxy:!0}])},[t("div",{},[t("div",{},[t("div",[t("div",{staticClass:"mb-2 pb-2 border-0 border-b border-solid border-gray-200"},[t("el-radio-group",{attrs:{disabled:e.disabled},model:{value:e.mod,callback:function(t){e.mod=t},expression:"mod"}},[["ips","all"].includes(e.singleMod)?t("el-radio",{attrs:{label:"ips"}},[t("el-tooltip",{attrs:{content:"通过手动勾选或导入，选择被勾选的机器"}},[t("span",[e._v(" 手动勾选模式 "),t("i",{staticClass:"el-icon-question"})])])],1):e._e(),["cond","all"].includes(e.singleMod)?t("el-radio",{attrs:{label:"cond"}},[t("el-tooltip",{attrs:{content:"选择符合查询条件的所有机器"}},[t("span",[e._v(" 条件匹配模式 "),t("i",{staticClass:"el-icon-question"})])])],1):e._e()],1)],1),t("div",{staticClass:"mb-1"},[t("filterOption",{ref:"selectSearchRef",attrs:{options:e.condData||[],suggestOptions:e.suggestOptions},on:{change:e.reload},scopedSlots:e._u([{key:"prefix",fn:function(){return[t("el-input",{staticStyle:{width:"240px"},attrs:{size:"mini",placeholder:"输入关键字过滤",clearable:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("el-button",{staticClass:"buttonsearch ml-1",attrs:{size:"mini"},on:{click:e.reload}},[t("div",{staticStyle:{margin:"0 5px"}},[t("i",{staticClass:"el-icon-search"})])])]},proxy:!0}]),model:{value:e.filters,callback:function(t){e.filters=t},expression:"filters"}})],1),t("div",{staticClass:"grid",class:{"grid-cols-[1fr,200px] gap-2":"ips"===e.mod,"grid-cols-1":"cond"===e.mod}},[t("div",{staticClass:"min-w-0"},[t("el-table",{ref:"tableRef",staticClass:"mt-1",staticStyle:{width:"100%"},attrs:{"header-cell-style":e.$attrs["header-cell-style"]||{color:"#909399",textAlign:"center",background:"#f5f7fa"},data:e.tableData,"row-key":"inet"},on:{select:e.selectRow,"select-all":e.selectAll}},[t("el-table-column",{attrs:{type:"selection",selectable:e.selectable}}),t("el-table-column",{attrs:{label:"终端IP",prop:"inet",width:"150px"}}),t("el-table-column",{attrs:{label:"标签"},scopedSlots:e._u([{key:"default",fn:function({row:r}){return[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("svg-icon",{staticClass:"iconfont",staticStyle:{height:"36px",width:"22px",float:"left"},attrs:{"icon-class":"linux"===r.goos?"linux":"windows"===r.goos?"Windows":"apple"}}),t("span",{},[t("el-tag",{attrs:{size:"mini",type:3===r.status?"success":1===r.status?"warning":2===r.status?"info":"danger"}},[e._v(" "+e._s(3===r.status?"在线":1===r.status?"未激活":2===r.status?"离线":"已删除")+" ")]),r.deleted?t("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v("已删除")]):e._e(),!r.deleted&&r.unload?t("el-tag",{attrs:{size:"mini"}},[e._v("静默中")]):e._e(),null!==r.tags?t("span",{staticStyle:{"margin-left":"5px"}},[t("span",[e._l(e.ipRe(r.tags,r.goos).slice(0,3),(function(r,s){return t("el-tag",{key:s,attrs:{size:"mini"}},[e._v(" "+e._s(r))])})),e.ipRe(r.tags,r.goos).length>3?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[t("el-tag",{attrs:{size:"mini",type:"info"}},[e._v(" + "+e._s(e.ipRe(r.tags).length))]),t("div",{attrs:{slot:"content"},slot:"content"},e._l(e.ipRe(r.tags),(function(r,s){return t("span",{key:s,staticStyle:{"padding-right":"15px"}},[e._v(e._s(r)),t("br")])})),0)],1):e._e()],2)]):e._e()],1)],1)]}}])}),t("el-table-column",{attrs:{label:"agent版本",width:"160px"},scopedSlots:e._u([{key:"default",fn:function({row:r}){return[t("div",[r.customized?t("el-tag",{attrs:{size:"mini",type:"info"}},[e._v(" "+e._s(r.customized)+" ")]):e._e(),e._v(" "+e._s(r.edition)+" ")],1)]}}])})],1),t("div",{staticClass:"mt-2 flex justify-end"},[t("el-pagination",{attrs:{"current-page":e.pagination.pageIndex,"page-sizes":e.pagination.pageSizes||[15,30,50],"page-size":e.pagination.pageSize,size:"mini",layout:e.pagination.layout||"jumper, sizes, prev, pager, next,total",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.pagination,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageIndex",t)},"update:pageSize":function(t){return e.$set(e.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.pagination,"pageSize",t)}}})],1)],1),"ips"===e.mod?t("el-card",{staticClass:"min-h-[500px]",attrs:{shadow:"never",size:"mini","body-style":"padding: 10px"}},[t("div",{staticClass:"pl-[5px] mb-2 flex justify-between"},[t("span",{staticClass:"text-gray-600"},[e._v("已勾选"+e._s(e.checkedData.length)+"台机器")]),e.disabled?e._e():t("div",[t("span",{staticClass:"cursor-pointer text-blue-400 mr-1 text-[12px]",on:{click:function(t){e.addInputShow=!0}}},[e._v("导入")]),t("span",{staticClass:"cursor-pointer text-[#ff7126] text-[12px]",on:{click:e.clear}},[e._v("清空")])])]),e.addInputShow?t("div",[t("div",[t("el-input",{attrs:{type:"textarea",placeholder:"换行输入多个机器IP",rows:"3"},model:{value:e.addInput,callback:function(t){e.addInput=t},expression:"addInput"}})],1),t("div",{staticClass:"mt-1 flex justify-end"},[t("span",{staticClass:"cursor-pointer text-blue-400 text-[12px]",on:{click:e.add}},[e._v("确认")])])]):e._e(),t("div",e._l(e.checkedData,(function(r,s){return t("div",{key:s,staticClass:"p-[5px] hover:bg-[#eaedf0] flex justify-between items-center"},[t("span",[e._v(" 🖥️ "+e._s(r)+" ")]),e.disabled?e._e():t("span",{staticClass:"cursor-pointer text-[#ff7126]",on:{click:function(t){return e.remove(r)}}},[e._v("x")])])})),0)]):e._e()],1)])])])])],1)},E=[],_=r(98362),y=r(31052),b=r(25194),x=r(65524),w={components:{filterOption:x.A},props:{title:{type:String,default:""}},setup(e,{expose:t}){const r=(0,v.ref)([]),s=(0,v.ref)(!1),o=(0,v.ref)(""),i=(0,v.ref)([]),a=(0,v.ref)(),n=(0,v.ref)([]),l=(0,v.ref)([]),c=(0,v.ref)("ips"),p=(0,v.ref)(!1),u=(0,v.ref)(!1),f=(0,v.ref)({tag:[]}),m=(0,v.ref)(""),d=(0,v.ref)({pageIndex:1,pageSize:20,total:0,pageSizes:[20,30,50],layout:"total, sizes, prev, pager, next"});let h;async function g(){try{const e=new URLSearchParams;e.append("size",d.value.pageSize),e.append("current",d.value.pageIndex),e.append("keyword",o.value);for(let r of l.value){const t={...r};e.append("filters",JSON.stringify(t))}const{data:t}=await _.A.get("/minions",{params:e});r.value=t?.records||[],d.value.total=t?.total||0,setTimeout((()=>{for(let e of r.value)i.value.includes(e.inet)&&a.value.toggleRowSelection(e,!0)}),1)}catch(e){console.log(e),y.Message.error("加载失败")}}function E(){d.value.pageIndex=1,g()}async function x(){const{data:e}=await _.A.get("/tag/sidebar");f.value["tag"]=e?.map((e=>e.name))||[]}function w(e,t){if(null!==e){var r=e.filter((e=>{var r=/(\d+)\.(\d+)\.(\d+)\.(\d+)/g;return(!t||e!==t)&&(r.test(e)?void 0:e)}));return r}}function $(){let e=null;"cond"===c.value?(o.value||l.value.length)&&(e={keyword:o.value,filters:l.value,inets:[],inet_mode:!1}):i.value.length&&(e={keyword:o.value,filters:l.value,inets:i.value,inet_mode:!0}),h?.(e),s.value=!1}function R(e,t){const r=e.find((e=>e.inet===t.inet));r?i.value.push(t.inet):i.value=i.value.filter((e=>e!==t.inet))}function I(e){for(let t of r.value)e.length?i.value.includes(t.inet)||i.value.push(t.inet):i.value=i.value.filter((e=>e!==t.inet))}function C(e){for(let t of e||[])i.value.includes(t.inet)||i.value.push(t.inet)}function S(){i.value=[],a.value.clearSelection()}function A(e){i.value=i.value.filter((t=>t!==e));const t=r.value.find((t=>t.inet===e));t&&a.value.toggleRowSelection(t,!1)}function O(){d.value.pageIndex=1,g()}function k(){g()}async function T(){try{const{data:e}=await _.A.get("/minion/cond");n.value=e?.conditions?.map((e=>("代理节点"===e.desc?e.desc="broker节点":"状态"===e.desc?e.desc="在线状态":"版本"===e.desc?e.desc="agent版本":"定制版本"===e.desc?e.desc="agent分支版本":"创建时间"===e.desc?e.desc="首次安装时间":"上线时间"===e.desc&&(e.desc="最近上线时间"),e)))}catch(e){}}function L(){if(m.value=m.value.trim(),m.value){const e=m.value.split("\n").map((e=>e.trim())).filter(Boolean);for(let t of e){const e=r.value.find((e=>e.inet===t));i.value.includes(t)||(i.value.push(t),e&&a.value.toggleRowSelection(e,!0))}}u.value=!1,m.value=""}function N(e){return"ips"===c.value}x(),T();const D=(0,v.ref)("");return t({openDialog(e,t){r.value=[],d.value.total=0,o.value=e?.keyword||"",l.value=e?.filters||[],i.value=e?.inets||[],c.value=!e||e?.inet_mode?"ips":"cond",D.value="all",t?.mode&&(c.value=t?.mode,D.value=t?.mode),p.value=t?.disabled||!1,g(),s.value=!0;const{resolve:a,promise:n}=(0,b.Y)();return h=a,n}}),{tableData:r,pagination:d,loadData:g,ipRe:w,dialogVisible:s,confirm:$,keyword:o,checkedData:i,updateCheckedData:C,handleSizeChange:O,handleCurrentChange:k,tableRef:a,reload:E,condData:n,filters:l,suggestOptions:f,remove:A,clear:S,selectRow:R,selectAll:I,mod:c,addInputShow:u,addInput:m,add:L,disabled:p,selectable:N,singleMod:D}}},$=w,R=r(81656),I=(0,R.A)($,g,E,!1,null,null,null),C=I.exports,S={components:{FLabelWrapper:i.A,agentSelect:C},props:{value:{type:Object,default:()=>({})},label:{type:String,default:""},maxShow:{type:Number,default:10},mode:{type:String,default:""},disabled:{type:Boolean,default:!1},title:{type:String,default:""}},setup(e,{emit:t}){const r=(0,v.ref)(0),s=(0,v.ref)();function o(){s.value.openDialog(e.value,{mode:e.mode,disabled:e.disabled}).then((e=>{t("input",(e?.inet_mode||e?.keyword||e?.filters?.length)&&(!e?.inet_mode||e?.inets?.length)?e:null)}))}const i=(0,v.ref)([]);async function a(){try{const{data:e}=await _.A.get("/minion/cond");i.value=e?.conditions?.map((e=>("代理节点"===e.desc?e.desc="broker节点":"状态"===e.desc?e.desc="在线状态":"版本"===e.desc?e.desc="agent版本":"定制版本"===e.desc?e.desc="agent分支版本":"创建时间"===e.desc?e.desc="首次安装时间":"上线时间"===e.desc&&(e.desc="最近上线时间"),e)))}catch(e){}}function n(e){return!!e&&(!e.keyword&&(1===e.filters.length&&"minion.inet"===e.filters[0].key&&"in"===e.filters[0].operator))}function l(e){const t=i.value.find((t=>e.key===t.key));if(!t)return"";const r=t?.operators?.find((t=>t.key===e.operator));return r?`${t?.desc} ${r?.desc} ${Array.isArray(e.value)?e.value.join(","):e.value}`:""}function c(e){return!e||(e.inet_mode?!e.inets?.length:!e.keyword&&!e.filters?.length)}return a(),{totalCount:r,agentSelectRef:s,openDialog:o,condData:i,formatCond:l,onlyCheckIps:n,isEmpty:c}}},A=S,O=(0,R.A)(A,d,h,!1,null,"c24ce974",null),k=O.exports,T=r(39338);function L(e){const t=e.trim().split(" ");if(5!==t.length)return null;const[r,s,o,i,a]=t;if("*"!==i)return null;if("*"===r||"*"===s)return null;if(!/^\d+$/.test(s)||!/^\d+$/.test(r)||parseInt(s)<0||parseInt(s)>23||parseInt(r)<0||parseInt(r)>59)return null;const n=(e,t)=>`${e.padStart(2,"0")}:${t.padStart(2,"0")}`;return"*"!==o&&"*"===a?/^\d+$/.test(o)&&parseInt(o)>=1&&parseInt(o)<=31?{d:n(s,r),w:null,M:o}:null:"*"===o&&"*"!==a?/^\d+$/.test(a)&&parseInt(a)>=0&&parseInt(a)<=6?{d:n(s,r),w:a,M:null}:null:"*"===o&&"*"===a?{d:n(s,r),w:null,M:null}:null}class N{constructor(e){if(this.optType=e?.optType||"a",this.step=e?.step||1,this.mode=e?.mode||1,this.id=e?.id||"",this.exec_id=e?.exec_id||"",this.name=e?.name||"",this.templateName=e?.templateName||"",this.intro=e?.intro||"",this.content=e?.content||"",this.extension_id=e?.extension_id||"",this._templateContent=e?._templateContent||"",this._resultCode=e?._resultCode||"",this.data=e?.data||{},this.dataCache=this.data,this._options=e?._options||[],this._formError=e?._formError||"",this._previewResult=e?._previewResult||!1,this.step_done=e?.step_done||!1,this.filters=e?.filters||null,this.excludes=e?.excludes||null,this._excludesParse={inet_mode:!0,inets:this.excludes||[]},this.push_size=e?.push_size||10,this.cron=e?.cron,this._cronObj={d:null,w:null,M:null},this.specific_times=e?.specific_times||[u()().startOf("d")],this.exec_type=e?.exec_type||1,this.timeout=e?.timeout||{days:0,hours:0,minutes:0,seconds:300},this.enabled=e?.enabled??!0,1!==this.exec_type||this.step_done||"m"!==this.optType||(this.enabled=!0,this.timeout.seconds=300),"a"===this.optType)this.cron="0 0 * * *";else if(this.cron){const e=L(this.cron);e?(this._cronObj.d=e.d,this._cronObj.w=e.w,this._cronObj.M=e.M,this._cronObj.M?this.exec_type=6:this._cronObj.w?this.exec_type=5:this._cronObj.d&&(this.exec_type=4)):this.exec_type=2}}}var D={components:{FLabelWrapper:i.A,FRadio:a.A,TemplateList:n.A,FormDesign:l.A,AceCoderEdit:c.A,SelectAgentTag:k},props:{},data(){return{parseImgByIntro:T.ae,form:new N,optType:"add",dialogShow:!1,res:null,rej:null,required:{required:!0,message:"请选择类别",trigger:"change"}}},methods:{openDialog(e){return this.dialogShow=!0,this.form=new N(e),1===this.form.mode&&this.form.extension_id&&this.form._templateContent&&this.getFormOptions(),new Promise(((e,t)=>{this.res=e,this.rej=t}))},async getFormOptions(){try{const{data:e}=await _.A.post("/lua-template/preparse",{content:this.form._templateContent});this.form._options=e||[],this.form._formError=""}catch(e){this.form._formError=e+""}},async getResultCodeNoSave(){try{if(this.form._formError)throw this.form._formError;const{data:e}=await _.A.post("/lua-template/prerender",{content:this.form._templateContent,data:this.$refs.formDesignRef?.getValue()});this.form._resultCode=e?.data||""}catch(e){this.form._resultCode="发生错误:"+e}},openPrew(){this.form._previewResult=!this.form._previewResult,this.form._previewResult&&this.getResultCodeNoSave()},handleSelect(e){this.form.templateName=e.name,this.form.extension_id=e.id,this.form.name||(this.form.name="使用模板:"+e.name),this.form.intro||(this.form.intro=e.intro||"新增一条任务"),this.form._templateContent=e.content,this.getFormOptions()},reSelectTemplate(){this.form.extension_id="",this.form.templateName="",this.form._templateContent="",this.form._options=[],this.form._formError="",this.form.data={}},timeoutFormat(e){if(e<60)return e+"秒";const t=Math.floor(e/60),r=e%60;return r>0?`${t}分钟${r}秒`:`${t}分钟`},cronFormat(e){try{return m().toString(e,{locale:"zh_CN"})}catch(t){return"cron表达式不正确"}},addSpecificTime(){this.form.specific_times.push(u()().startOf("d"))},removeSpecificTime(e){1!==this.form.specific_times.length&&this.form.specific_times.splice(e,1)},disabledDate(e){return e.getTime()<Date.now()-864e5},async deleteTask(){try{await _.A.delete("/task-extension",{params:{id:this.form.id}}),this.$message.success("删除成功"),this.closeDialog()}catch(e){this.$message.error(e)}},async disabledMod(e){if(2===e){const{success:e,msg:t}=await this.validateForm();return e?(1===this.form.mode&&(this.form.data=this.$refs.formDesignRef?.getValue()),!1):(this.$message.error(t),!0)}return!1},async validateForm(){try{if(await this.$refs.formRef.validate().catch((()=>{throw"请检查必填项"})),1===this.form.mode){if(!this.form.extension_id)throw"请在下方选择模版并填写所需参数"}else if(2===this.form.mode&&!this.form.content)throw"请填写任务脚本";return{success:!0,msg:""}}catch(e){return{success:!1,msg:e+""}}},async nextStep(){try{const{success:e,msg:t}=await this.validateForm();if(!e)throw t;1===this.form.mode&&(this.form.data=this.$refs.formDesignRef?.getValue()),this.form.step=2}catch(e){this.$message.error(e)}},closeDialog(){this.dialogShow=!1,this.res?.()},async step1Save(){try{const{success:e,msg:t}=await this.validateForm();if(!e)throw t;const r={id:this.form.id,name:this.form.name,intro:this.form.intro};if(1===this.form.mode?(r.extension_id=this.form.extension_id,r.data=this.$refs.formDesignRef?.getValue()):2===this.form.mode&&(r.code=this.form.content),"a"===this.form.optType){const{data:e}=await _.A.post("/task-extension/code",r);this.form.id=e.id,this.form.optType="m"}else"m"===this.form.optType&&await _.A.patch("/task-extension/code",r);this.$message.success("保存成功")}catch(e){this.$message.error(e)}},async step2Save(){try{const{success:e,msg:t}=await this.validateForm();if(!e)throw t;const r={id:this.form.id,name:this.form.name,intro:this.form.intro,enabled:this.form.enabled,timeout:this.form.timeout,push_size:this.form.push_size,filters:this.form.filters,excludes:this.form._excludesParse?.inets||null};1===this.form.mode?(r.extension_id=this.form.extension_id,r.data=this.form.data):2===this.form.mode&&(r.code=this.form.content),2===this.form.exec_type?r.cron=this.form.cron:3===this.form.exec_type?r.specific_times=this.form.specific_times?.map((e=>u()(e).toISOString())):4===this.form.exec_type?r.cron=this.generateCron({d:this.form._cronObj.d}):5===this.form.exec_type?r.cron=this.generateCron({d:this.form._cronObj.d,w:this.form._cronObj.w}):6===this.form.exec_type&&(r.cron=this.generateCron({d:this.form._cronObj.d,M:this.form._cronObj.M})),"a"===this.form.optType?await _.A.post("/task-extension/publish",r):"m"===this.form.optType&&await _.A.patch("/task-extension/publish",r),this.$message.success("发布成功"),this.closeDialog()}catch(e){this.$message.error(e)}},generateCron(e){const{d:t,w:r,M:s}=e;let o="0",i="0";if(t){const e=t.split(":");o=e[0],i=e[1]}return s?`${i} ${o} ${s} * *`:r?`${i} ${o} * * ${r}`:t?`${i} ${o} * * *`:"* * * * *"}}},P=D,j=(0,R.A)(P,s,o,!1,null,"2af27d05",null),F=j.exports},99880:function(e,t,r){"use strict";r.d(t,{A:function(){return C}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-drawer",{attrs:{visible:e.dialogVisible,direction:"rtl","destroy-on-close":"",size:"100%","append-to-body":"","show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"flex justify-between items-center text-[14px] text-gray-600"},[t("span",[e._v(" "+e._s("a"===e.form.optType?"发布模板":"编辑模板")+" "),t("i",{staticClass:"el-icon-arrow-right"}),e._v(" "+e._s("service"===e.form.category?"服务模板":"任务模板")+" "),t("i",{staticClass:"el-icon-arrow-right"}),e._v(" "+e._s(e.form.name)+" ")]),t("div",[t("el-button",{staticClass:"mr-1",attrs:{size:"small"},on:{click:e.helpDoc}},[e._v("参考手册")]),t("el-button",{staticClass:"mr-1",attrs:{size:"small"},on:{click:e.closeDialog}},[e._v("关闭")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirm}},[e._v("保存")])],1)])]},proxy:!0}])},[t("div",{staticClass:"grid grid-cols-2 gap-2",class:{"grid-cols-[1fr,2fr]":e.previewResult,"grid-cols-1":!e.showPreview}},[t("div",{staticClass:"relative w-full"},[t("div",{staticClass:"h-[calc(100vh-44px)] fixed left-0 top-[44px] w-1/2",class:{"w-1/3":e.previewResult,"w-full":!e.showPreview}},[t("AceCoderEdit",{attrs:{theme:"light"},scopedSlots:e._u([{key:"extra",fn:function(){return[t("span",{staticClass:"ml-[10px] cursor-pointer",on:{click:function(t){e.showPreview=!0}}},[t("span",[e._v(" 预览 ")])])]},proxy:!0},{key:"start",fn:function(){return[t("span",{staticClass:"ml-2"},[e._v(" 模板名称： "+e._s(e.form.name)+" ")])]},proxy:!0}]),model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)]),e.showPreview?t("div",{staticClass:"relative min-h-[calc(100vh-44px)] p-2 bg-[#fbfbfb] cardbox",class:{grid:e.previewResult,"grid-cols-2":e.previewResult,"gap-2":e.previewResult}},[t("el-card",{staticClass:"formCard min-h-full",attrs:{shadow:"never"},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",[t("div",{staticClass:"flex justify-between"},[t("div",{staticClass:"flex items-center"},[t("FRadio",{staticClass:"w-[220px]",attrs:{align:"center",options:[{value:"表单预览",label:"表单预览"},{value:"模板描述",label:"模板描述"}]},on:{change:e.viewChange},model:{value:e.previewType,callback:function(t){e.previewType=t},expression:"previewType"}})],1),t("div",[t("el-button",{attrs:{type:"text"},on:{click:e.hidePreview}},[e._v("隐藏 ")]),t("el-button",{attrs:{type:"text",disabled:"模板描述"===e.previewType},on:{click:function(t){return e.getFormOptions()}}},[e._v("刷新 ")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.openPrew}},[e._v("结果预览 "),e.previewResult?t("i",{staticClass:"el-icon-arrow-right"}):t("i",{staticClass:"el-icon-arrow-left"})])],1)]),e.formError?t("div",{staticClass:"text-red-600 mt-1"},[e._v(" 发生错误 ："+e._s(e.formError)+" ")]):e._e()])]},proxy:!0}],null,!1,2485807340)},["表单预览"===e.previewType?t("div",[t("FormDesign",{ref:"formDesignRef",attrs:{options:e.formOptions},model:{value:e.formParams,callback:function(t){e.formParams=t},expression:"formParams"}})],1):t("div",[t("el-form",{attrs:{model:e.form,size:"small","label-width":"100px"}},[t("el-form-item",{attrs:{label:"模板名称",required:""}},[t("el-input",{attrs:{disabled:"a"!==e.form.optType},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"模板分类",required:""}},[t("el-select",{staticClass:"w-full",attrs:{size:"medium",disabled:"a"!==e.form.optType||!!e.category,placeholder:"请选择"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},[t("el-option",{attrs:{label:"服务",value:"service"}}),t("el-option",{attrs:{label:"任务",value:"task"}})],1)],1),t("el-form-item",{staticClass:"-mb-[10px]",attrs:{label:"模板图标"}},[e.form.icon?t("img",{attrs:{src:e.parseIntroByImg(e.form.icon),alt:"",width:"60",height:"60"},on:{click:e.openImgSelect}}):t("el-button",{attrs:{type:"text"},on:{click:e.openImgSelect}},[e._v("选择图标")])],1),t("el-form-item",{attrs:{label:"模板描述"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1),t("el-form-item",{attrs:{label:"更新日志"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:e.form.changelog,callback:function(t){e.$set(e.form,"changelog",t)},expression:"form.changelog"}})],1)],1)],1)]),e.previewResult?t("el-card",{staticClass:"min-h-full",attrs:{title:"结果预览",shadow:"never"},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"flex justify-end py-[2px]"},[t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.getResultCodeNoSave}},[e._v("刷新 ")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.previewResult=!1}}},[e._v("收起预览 ")])],1)]},proxy:!0}],null,!1,3535021956)},[t("div",{staticClass:"h-[calc(100vh-172px)]"},[t("AceCoderEdit",{attrs:{"read-only":"",theme:"light","show-header":!1,mode:"text"},model:{value:e.resultCode,callback:function(t){e.resultCode=t},expression:"resultCode"}})],1)]):e._e()],1):e._e()])]),t("ImgSelect",{ref:"imgSelectRef"})],1)},o=[],i=r(98362),a=r(95814),n=r(88999),l=r(25194),c=r(31052),p=r(99589),u=r.n(p),f=r(85471),m=r(13919),d=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"选择图标","close-on-click-modal":!1,visible:e.dialogShow,width:"600px","close-on-press-escape":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.dialogShow=t},closed:function(t){e.rej?.()}}},[t("div",{staticClass:"grid grid-cols-5 gap-4 justify-items-center"},e._l(e.getAllImgs(),(function(r,s){return t("div",{key:s,staticClass:"p-2 pb-1 rounded hover:bg-slate-200"},[t("img",{staticClass:"cursor-pointer",attrs:{src:r,alt:"",width:"60",height:"60"},on:{click:function(t){return e.onSubmit(s)}}})])})),0)])},h=[],v=r(39338);class g{}var E={components:{},props:{},data(){return{getAllImgs:v.OZ,form:new g,optType:"add",dialogShow:!1,res:null,rej:null,required:{required:!0,message:"请选择类别",trigger:"change"}}},methods:{openDialog(e,t="add"){return this.optType=t,this.dialogShow=!0,this.form={...new g,...e||{}},new Promise(((e,t)=>{this.res=e,this.rej=t}))},async onSubmit(e){this.dialogShow=!1,this.res?.(e)}}},_=E,y=r(81656),b=(0,y.A)(_,d,h,!1,null,"235875d5",null),x=b.exports;class w{constructor(e){this.optType=e?.optType||"a",this.id=e?.id,this.name=e?.name,this.category=e?.category||"service",this.content=e?.content||"",this.extension_id=e?.extension_id||"",this.changelog=e?.changelog||"新发布了一个版本",this.intro=e?.intro||"通过模板进行lua代码的简化和复用",this.icon=e?.icon||"cloud13";const t=this.intro.split(":"),r=t?.[0];/cloud/.test(r)&&(this.icon=r,this.intro=t.slice(1).join(":"))}format(){return{...this,intro:`${this.icon}:${this.intro}`}}}var $={components:{AceCoderEdit:a.A,FRadio:n.A,FormDesign:m.A,ImgSelect:x},props:{category:{type:String,default:""}},setup(e,{expose:t}){const r=(0,f.ref)(new w),s=(0,f.ref)([]),o=(0,f.ref)(null),a=(0,f.ref)(),n=(0,f.ref)(""),p=(0,f.ref)(!1),m=(0,f.ref)(""),d=(0,f.ref)("表单预览"),h=(0,f.ref)(!0),g=(0,f.ref)(!1),E=(0,f.ref)(!1);let _,y;async function b(){try{const{data:e}=await i.A.post("/lua-template/preparse",{content:r.value.content});s.value=e||[],n.value=""}catch(e){n.value=e+""}}function x(){h.value=!1,p.value=!1}function $(){p.value=!0,R()}async function R(){try{const{data:e}=await i.A.post("/lua-template/prerender",{content:r.value.content,data:a.value.getValue()});m.value=e?.data||""}catch(e){m.value="发生错误:"+e}}function I(){const e=r.value.semver.split("-"),t=e[0],s=e.slice(1).join("-");r.value.newSemver=u().inc(t,"patch"),s&&(r.value.newSemver=r.value.newSemver+"-"+s),E.value=!0}async function C(){try{if(!r.value.name)throw"模板名称不能为空";if(!r.value.category)throw"请选择模板分类";if("a"===r.value.optType){const{data:e}=await i.A.post("/extension-market",{...r.value.format()});r.value.id=e.id,r.value.optType="m"}else await i.A.put("/extension-market",{...r.value.format()});c.Message.success("保存成功")}catch(e){c.Message.error("保存失败:"+e)}}const S=(0,f.getCurrentInstance)();async function A(){S.proxy.$jumpTo({name:"templateDoc"},"插件手册")}function O(e){"表单预览"===e&&b()}function k(){g.value=!1,_()}const T=(0,f.ref)();function L(){T.value.openDialog().then((e=>{r.value.icon=e}))}return t({openDialog(t){const{promise:i,resolve:a,reject:c}=(0,l.Y)();return p.value=!1,s.value=[],o.value=null,g.value=!0,n.value="",_=a,y=c,r.value=new w(t),e.category&&(r.value.category=e.category),"a"===r.value.optType?d.value="模板描述":(d.value="表单预览",b()),i}}),{form:r,formOptions:s,formParams:o,formError:n,previewResult:p,resultCode:m,previewType:d,showPreview:h,getFormOptions:b,dialogVisible:g,hidePreview:x,openPrew:$,getResultCodeNoSave:R,confirm:C,helpDoc:A,viewChange:O,formDesignRef:a,openConfirmDialog:I,confirmDialogVisible:E,closeDialog:k,openImgSelect:L,imgSelectRef:T,parseIntroByImg:v.uD}}},R=$,I=(0,y.A)(R,s,o,!1,null,"b4f66132",null),C=I.exports},84020:function(e,t,r){"use strict";r.d(t,{A:function(){return g}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"w-full"},[t("div",[t("table-list",{ref:"templateListRef",attrs:{selection:"",selectCountLimit:1,data:e.tableDataFilter,"row-key":"id",columns:e.columns,configAble:!1,checkedData:e.checkedData,localPaginate:"",align:"center"},on:{"update:checkedData":function(t){e.checkedData=t},"update:checked-data":function(t){e.checkedData=t},"row-click":e.rowClick},scopedSlots:e._u([{key:"right_top_btn",fn:function(){return[t("div",{staticClass:"flex justify-between"},[t("div",[t("FLabelWrapper",{staticClass:"w-[100px] mr-2",attrs:{label:""}},[t("el-select",{attrs:{size:"mini",placeholder:"模板类型"},on:{change:function(t){return e.loadData()}},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[t("el-option",{attrs:{label:"任务模板",value:"task"}}),t("el-option",{attrs:{label:"服务模板",value:"service"}})],1)],1),t("el-input",{staticClass:"w-[200px] mr-2",attrs:{size:"mini",placeholder:"名称,描述,创建人过滤"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("el-button",{attrs:{size:"mini"}},[e._v("搜索")]),t("el-button",{attrs:{size:"mini",type:e.checkedData.length?"primary":""},on:{click:e.handleSelect}},[e._v("确认选择")])],1),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.addTemplateFolder}},[e._v("新增模板")])],1)]},proxy:!0},{key:"name",fn:function({row:r}){return[t("div",{staticClass:"flex items-center"},[t("img",{staticClass:"w-[20px] h-[20px]",attrs:{src:e.parseImgByIntro(r.intro)}}),t("span",{staticClass:"ml-2"},[e._v(e._s(r.name))])])]}},{key:"opt",fn:function({row:r}){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.toDetail(r)}}},[e._v("详情")])]}}])})],1),t("contentCode",{ref:"contentRef",attrs:{category:e.category}})],1)},o=[],i=r.p+"img/img2.0c4f6ad7.png",a=r(35467),n=r(98362),l=r(99726),c=r(95093),p=r.n(c),u=r(99880),f=r(39338),m={components:{FLabelWrapper:l.A,contentCode:u.A,tableList:a.A},props:{category:{type:String,default:""}},data(){return{selectedTemplate:null,img:i,moment:p(),keyword:"",parseImgByIntro:f.ae,type:"",pagination:{pageIndex:1,pageSize:12,total:0,pageSizes:[12,24,36],layout:"total, sizes, prev, pager, next"},tableData:[],checkedData:[],columns:[{label:"模板名称",slot:"name"},{label:"模板类型",prop:"type",formatter:e=>"task"===e.type?"任务模板":"服务模板",width:120},{label:"模板描述",prop:"intro","show-overflow-tooltip":!0,formatter:e=>this.parseIntro(e.intro)},{label:"创建人",prop:"created_by",width:100,formatter:e=>e.created_by?.nickname||e.created_by?.username},{label:"更新时间",prop:"updated_at",formatter:e=>p()(e.updated_at).format("YYYY-MM-DD"),width:100},{label:"操作",slot:"opt",width:80}]}},computed:{tableDataFilter(){return this.tableData.filter((e=>!this.keyword||(!!e.name.includes(this.keyword)||(!!e.intro.includes(this.keyword)||(!!e.created_by?.nickname?.includes(this.keyword)||!!e.created_by?.username?.includes(this.keyword))))))}},created(){this.type=this.category,this.loadData()},methods:{async loadData(){try{const e=await n.A.get("/extension-markets",{params:{category:this.type}});this.tableData=e.data||[]}catch(e){this.$message.error(e)}},addTemplateFolder(){this.$refs.contentRef.openDialog().then((()=>{this.loadData()}))},toDetail(e){this.$refs.contentRef.openDialog({...e,optType:"m"}).then((()=>{this.loadData()}))},handleSelect(){this.$emit("select",this.checkedData?.[0]||void 0)},parseIntro(e){const t=e.split(":");return/cloud/.test(t[0])?t.slice(1).join(":"):e},rowClick(e){const t=this.checkedData.includes(e);this.$refs.templateListRef?.$refs?.table?.toggleRowSelection(e,!t)}}},d=m,h=r(81656),v=(0,h.A)(d,s,o,!1,null,"b852c7a2",null),g=v.exports},25194:function(e,t,r){"use strict";function s(){let e,t;const r=new Promise(((r,s)=>{e=r,t=s}));return{promise:r,resolve:e,reject:t}}r.d(t,{Y:function(){return s}})},93904:function(e,t,r){const s=Symbol("SemVer ANY");class o{static get ANY(){return s}constructor(e,t){if(t=i(t),e instanceof o){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===s?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?a[n.COMPARATORLOOSE]:a[n.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new p(r[2],this.options.loose):this.semver=s}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===s||e===s)return!0;if("string"===typeof e)try{e=new p(e,this.options)}catch(t){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof o))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new u(e.value,t).test(this.value):""===e.operator?""===e.value||new u(this.value,t).test(e.semver):(t=i(t),(!t.includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">"))))))))}}e.exports=o;const i=r(98587),{safeRe:a,t:n}=r(99718),l=r(72111),c=r(57272),p=r(53908),u=r(78311)},78311:function(e,t,r){const s=/\s+/g;class o{constructor(e,t){if(t=n(t),e instanceof o)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new o(e.raw,t);if(e instanceof l)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(s," "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!E(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const t of this.set)if(1===t.length&&_(t[0])){this.set=[t];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=(this.options.includePrerelease&&v)|(this.options.loose&&g),r=t+":"+e,s=a.get(r);if(s)return s;const o=this.options.loose,i=o?u[f.HYPHENRANGELOOSE]:u[f.HYPHENRANGE];e=e.replace(i,k(this.options.includePrerelease)),c("hyphen replace",e),e=e.replace(u[f.COMPARATORTRIM],m),c("comparator trim",e),e=e.replace(u[f.TILDETRIM],d),c("tilde trim",e),e=e.replace(u[f.CARETTRIM],h),c("caret trim",e);let n=e.split(" ").map((e=>b(e,this.options))).join(" ").split(/\s+/).map((e=>O(e,this.options)));o&&(n=n.filter((e=>(c("loose invalid filter",e,this.options),!!e.match(u[f.COMPARATORLOOSE]))))),c("range list",n);const p=new Map,_=n.map((e=>new l(e,this.options)));for(const a of _){if(E(a))return[a];p.set(a.value,a)}p.size>1&&p.has("")&&p.delete("");const y=[...p.values()];return a.set(r,y),y}intersects(e,t){if(!(e instanceof o))throw new TypeError("a Range is required");return this.set.some((r=>y(r,t)&&e.set.some((e=>y(e,t)&&r.every((r=>e.every((e=>r.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"===typeof e)try{e=new p(e,this.options)}catch(t){return!1}for(let r=0;r<this.set.length;r++)if(T(this.set[r],e,this.options))return!0;return!1}}e.exports=o;const i=r(68794),a=new i,n=r(98587),l=r(93904),c=r(57272),p=r(53908),{safeRe:u,t:f,comparatorTrimReplace:m,tildeTrimReplace:d,caretTrimReplace:h}=r(99718),{FLAG_INCLUDE_PRERELEASE:v,FLAG_LOOSE:g}=r(16874),E=e=>"<0.0.0-0"===e.value,_=e=>""===e.value,y=(e,t)=>{let r=!0;const s=e.slice();let o=s.pop();while(r&&s.length)r=s.every((e=>o.intersects(e,t))),o=s.pop();return r},b=(e,t)=>(c("comp",e,t),e=R(e,t),c("caret",e),e=w(e,t),c("tildes",e),e=C(e,t),c("xrange",e),e=A(e,t),c("stars",e),e),x=e=>!e||"x"===e.toLowerCase()||"*"===e,w=(e,t)=>e.trim().split(/\s+/).map((e=>$(e,t))).join(" "),$=(e,t)=>{const r=t.loose?u[f.TILDELOOSE]:u[f.TILDE];return e.replace(r,((t,r,s,o,i)=>{let a;return c("tilde",e,t,r,s,o,i),x(r)?a="":x(s)?a=`>=${r}.0.0 <${+r+1}.0.0-0`:x(o)?a=`>=${r}.${s}.0 <${r}.${+s+1}.0-0`:i?(c("replaceTilde pr",i),a=`>=${r}.${s}.${o}-${i} <${r}.${+s+1}.0-0`):a=`>=${r}.${s}.${o} <${r}.${+s+1}.0-0`,c("tilde return",a),a}))},R=(e,t)=>e.trim().split(/\s+/).map((e=>I(e,t))).join(" "),I=(e,t)=>{c("caret",e,t);const r=t.loose?u[f.CARETLOOSE]:u[f.CARET],s=t.includePrerelease?"-0":"";return e.replace(r,((t,r,o,i,a)=>{let n;return c("caret",e,t,r,o,i,a),x(r)?n="":x(o)?n=`>=${r}.0.0${s} <${+r+1}.0.0-0`:x(i)?n="0"===r?`>=${r}.${o}.0${s} <${r}.${+o+1}.0-0`:`>=${r}.${o}.0${s} <${+r+1}.0.0-0`:a?(c("replaceCaret pr",a),n="0"===r?"0"===o?`>=${r}.${o}.${i}-${a} <${r}.${o}.${+i+1}-0`:`>=${r}.${o}.${i}-${a} <${r}.${+o+1}.0-0`:`>=${r}.${o}.${i}-${a} <${+r+1}.0.0-0`):(c("no pr"),n="0"===r?"0"===o?`>=${r}.${o}.${i}${s} <${r}.${o}.${+i+1}-0`:`>=${r}.${o}.${i}${s} <${r}.${+o+1}.0-0`:`>=${r}.${o}.${i} <${+r+1}.0.0-0`),c("caret return",n),n}))},C=(e,t)=>(c("replaceXRanges",e,t),e.split(/\s+/).map((e=>S(e,t))).join(" ")),S=(e,t)=>{e=e.trim();const r=t.loose?u[f.XRANGELOOSE]:u[f.XRANGE];return e.replace(r,((r,s,o,i,a,n)=>{c("xRange",e,r,s,o,i,a,n);const l=x(o),p=l||x(i),u=p||x(a),f=u;return"="===s&&f&&(s=""),n=t.includePrerelease?"-0":"",l?r=">"===s||"<"===s?"<0.0.0-0":"*":s&&f?(p&&(i=0),a=0,">"===s?(s=">=",p?(o=+o+1,i=0,a=0):(i=+i+1,a=0)):"<="===s&&(s="<",p?o=+o+1:i=+i+1),"<"===s&&(n="-0"),r=`${s+o}.${i}.${a}${n}`):p?r=`>=${o}.0.0${n} <${+o+1}.0.0-0`:u&&(r=`>=${o}.${i}.0${n} <${o}.${+i+1}.0-0`),c("xRange return",r),r}))},A=(e,t)=>(c("replaceStars",e,t),e.trim().replace(u[f.STAR],"")),O=(e,t)=>(c("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?f.GTE0PRE:f.GTE0],"")),k=e=>(t,r,s,o,i,a,n,l,c,p,u,f)=>(r=x(s)?"":x(o)?`>=${s}.0.0${e?"-0":""}`:x(i)?`>=${s}.${o}.0${e?"-0":""}`:a?`>=${r}`:`>=${r}${e?"-0":""}`,l=x(c)?"":x(p)?`<${+c+1}.0.0-0`:x(u)?`<${c}.${+p+1}.0-0`:f?`<=${c}.${p}.${u}-${f}`:e?`<${c}.${p}.${+u+1}-0`:`<=${l}`,`${r} ${l}`.trim()),T=(e,t,r)=>{for(let s=0;s<e.length;s++)if(!e[s].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(c(e[r].semver),e[r].semver!==l.ANY&&e[r].semver.prerelease.length>0){const s=e[r].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}},53908:function(e,t,r){const s=r(57272),{MAX_LENGTH:o,MAX_SAFE_INTEGER:i}=r(16874),{safeRe:a,t:n}=r(99718),l=r(98587),{compareIdentifiers:c}=r(61123);class p{constructor(e,t){if(t=l(t),e instanceof p){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!==typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>o)throw new TypeError(`version is longer than ${o} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?a[n.LOOSE]:a[n.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof p)){if("string"===typeof e&&e===this.version)return 0;e=new p(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof p||(e=new p(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof p||(e=new p(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],o=e.prerelease[t];if(s("prerelease compare",t,r,o),void 0===r&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===r)return-1;if(r!==o)return c(r,o)}while(++t)}compareBuild(e){e instanceof p||(e=new p(e,this.options));let t=0;do{const r=this.build[t],o=e.build[t];if(s("build compare",t,r,o),void 0===r&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===r)return-1;if(r!==o)return c(r,o)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let s=this.prerelease.length;while(--s>=0)"number"===typeof this.prerelease[s]&&(this.prerelease[s]++,s=-2);if(-1===s){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let s=[t,e];!1===r&&(s=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=p},57414:function(e,t,r){const s=r(30144),o=(e,t)=>{const r=s(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};e.exports=o},72111:function(e,t,r){const s=r(94641),o=r(13999),i=r(35580),a=r(54089),n=r(7059),l=r(25200),c=(e,t,r,c)=>{switch(t){case"===":return"object"===typeof e&&(e=e.version),"object"===typeof r&&(r=r.version),e===r;case"!==":return"object"===typeof e&&(e=e.version),"object"===typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return s(e,r,c);case"!=":return o(e,r,c);case">":return i(e,r,c);case">=":return a(e,r,c);case"<":return n(e,r,c);case"<=":return l(e,r,c);default:throw new TypeError(`Invalid operator: ${t}`)}};e.exports=c},46170:function(e,t,r){const s=r(53908),o=r(30144),{safeRe:i,t:a}=r(99718),n=(e,t)=>{if(e instanceof s)return e;if("number"===typeof e&&(e=String(e)),"string"!==typeof e)return null;t=t||{};let r=null;if(t.rtl){const s=t.includePrerelease?i[a.COERCERTLFULL]:i[a.COERCERTL];let o;while((o=s.exec(e))&&(!r||r.index+r[0].length!==e.length))r&&o.index+o[0].length===r.index+r[0].length||(r=o),s.lastIndex=o.index+o[1].length+o[2].length;s.lastIndex=-1}else r=e.match(t.includePrerelease?i[a.COERCEFULL]:i[a.COERCE]);if(null===r)return null;const n=r[2],l=r[3]||"0",c=r[4]||"0",p=t.includePrerelease&&r[5]?`-${r[5]}`:"",u=t.includePrerelease&&r[6]?`+${r[6]}`:"";return o(`${n}.${l}.${c}${p}${u}`,t)};e.exports=n},40909:function(e,t,r){const s=r(53908),o=(e,t,r)=>{const o=new s(e,r),i=new s(t,r);return o.compare(i)||o.compareBuild(i)};e.exports=o},11763:function(e,t,r){const s=r(50560),o=(e,t)=>s(e,t,!0);e.exports=o},50560:function(e,t,r){const s=r(53908),o=(e,t,r)=>new s(e,r).compare(new s(t,r));e.exports=o},51832:function(e,t,r){const s=r(30144),o=(e,t)=>{const r=s(e,null,!0),o=s(t,null,!0),i=r.compare(o);if(0===i)return null;const a=i>0,n=a?r:o,l=a?o:r,c=!!n.prerelease.length,p=!!l.prerelease.length;if(p&&!c)return l.patch||l.minor?n.patch?"patch":n.minor?"minor":"major":"major";const u=c?"pre":"";return r.major!==o.major?u+"major":r.minor!==o.minor?u+"minor":r.patch!==o.patch?u+"patch":"prerelease"};e.exports=o},94641:function(e,t,r){const s=r(50560),o=(e,t,r)=>0===s(e,t,r);e.exports=o},35580:function(e,t,r){const s=r(50560),o=(e,t,r)=>s(e,t,r)>0;e.exports=o},54089:function(e,t,r){const s=r(50560),o=(e,t,r)=>s(e,t,r)>=0;e.exports=o},93007:function(e,t,r){const s=r(53908),o=(e,t,r,o,i)=>{"string"===typeof r&&(i=o,o=r,r=void 0);try{return new s(e instanceof s?e.version:e,r).inc(t,o,i).version}catch(a){return null}};e.exports=o},7059:function(e,t,r){const s=r(50560),o=(e,t,r)=>s(e,t,r)<0;e.exports=o},25200:function(e,t,r){const s=r(50560),o=(e,t,r)=>s(e,t,r)<=0;e.exports=o},32938:function(e,t,r){const s=r(53908),o=(e,t)=>new s(e,t).major;e.exports=o},46254:function(e,t,r){const s=r(53908),o=(e,t)=>new s(e,t).minor;e.exports=o},13999:function(e,t,r){const s=r(50560),o=(e,t,r)=>0!==s(e,t,r);e.exports=o},30144:function(e,t,r){const s=r(53908),o=(e,t,r=!1)=>{if(e instanceof s)return e;try{return new s(e,t)}catch(o){if(!r)return null;throw o}};e.exports=o},24493:function(e,t,r){const s=r(53908),o=(e,t)=>new s(e,t).patch;e.exports=o},31729:function(e,t,r){const s=r(30144),o=(e,t)=>{const r=s(e,t);return r&&r.prerelease.length?r.prerelease:null};e.exports=o},9970:function(e,t,r){const s=r(50560),o=(e,t,r)=>s(t,e,r);e.exports=o},74277:function(e,t,r){const s=r(40909),o=(e,t)=>e.sort(((e,r)=>s(r,e,t)));e.exports=o},97638:function(e,t,r){const s=r(78311),o=(e,t,r)=>{try{t=new s(t,r)}catch(o){return!1}return t.test(e)};e.exports=o},43927:function(e,t,r){const s=r(40909),o=(e,t)=>e.sort(((e,r)=>s(e,r,t)));e.exports=o},56953:function(e,t,r){const s=r(30144),o=(e,t)=>{const r=s(e,t);return r?r.version:null};e.exports=o},99589:function(e,t,r){const s=r(99718),o=r(16874),i=r(53908),a=r(61123),n=r(30144),l=r(56953),c=r(57414),p=r(93007),u=r(51832),f=r(32938),m=r(46254),d=r(24493),h=r(31729),v=r(50560),g=r(9970),E=r(11763),_=r(40909),y=r(43927),b=r(74277),x=r(35580),w=r(7059),$=r(94641),R=r(13999),I=r(54089),C=r(25200),S=r(72111),A=r(46170),O=r(93904),k=r(78311),T=r(97638),L=r(77631),N=r(19628),D=r(270),P=r(41261),j=r(13874),F=r(97075),z=r(75571),M=r(5342),G=r(76780),U=r(72525),V=r(75032);e.exports={parse:n,valid:l,clean:c,inc:p,diff:u,major:f,minor:m,patch:d,prerelease:h,compare:v,rcompare:g,compareLoose:E,compareBuild:_,sort:y,rsort:b,gt:x,lt:w,eq:$,neq:R,gte:I,lte:C,cmp:S,coerce:A,Comparator:O,Range:k,satisfies:T,toComparators:L,maxSatisfying:N,minSatisfying:D,minVersion:P,validRange:j,outside:F,gtr:z,ltr:M,intersects:G,simplifyRange:U,subset:V,SemVer:i,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:o.SEMVER_SPEC_VERSION,RELEASE_TYPES:o.RELEASE_TYPES,compareIdentifiers:a.compareIdentifiers,rcompareIdentifiers:a.rcompareIdentifiers}},16874:function(e){const t="2.0.0",r=256,s=Number.MAX_SAFE_INTEGER||9007199254740991,o=16,i=r-6,a=["major","premajor","minor","preminor","patch","prepatch","prerelease"];e.exports={MAX_LENGTH:r,MAX_SAFE_COMPONENT_LENGTH:o,MAX_SAFE_BUILD_LENGTH:i,MAX_SAFE_INTEGER:s,RELEASE_TYPES:a,SEMVER_SPEC_VERSION:t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},57272:function(e){const t="object"===typeof process&&{NODE_ENV:"production",VUE_APP_API_HOST:"/api/v1",VUE_APP_SSO:"https://dongdong-auth.eastmoney.com/dongdong-auth/login/?client_id=vela-ssoc&redirect_uri=https://vela-ssoc.eastmoney.com",VUE_APP_VERSION:"3.0.9",BASE_URL:"/"}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",VUE_APP_API_HOST:"/api/v1",VUE_APP_SSO:"https://dongdong-auth.eastmoney.com/dongdong-auth/login/?client_id=vela-ssoc&redirect_uri=https://vela-ssoc.eastmoney.com",VUE_APP_VERSION:"3.0.9",BASE_URL:"/"}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},61123:function(e){const t=/^[0-9]+$/,r=(e,r)=>{const s=t.test(e),o=t.test(r);return s&&o&&(e=+e,r=+r),e===r?0:s&&!o?-1:o&&!s?1:e<r?-1:1},s=(e,t)=>r(t,e);e.exports={compareIdentifiers:r,rcompareIdentifiers:s}},68794:function(e){class t{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){const r=this.delete(e);if(!r&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}e.exports=t},98587:function(e){const t=Object.freeze({loose:!0}),r=Object.freeze({}),s=e=>e?"object"!==typeof e?t:e:r;e.exports=s},99718:function(e,t,r){const{MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:o,MAX_LENGTH:i}=r(16874),a=r(57272);t=e.exports={};const n=t.re=[],l=t.safeRe=[],c=t.src=[],p=t.t={};let u=0;const f="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",i],[f,o]],d=e=>{for(const[t,r]of m)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e},h=(e,t,r)=>{const s=d(t),o=u++;a(e,o,t),p[e]=o,c[o]=t,n[o]=new RegExp(t,r?"g":void 0),l[o]=new RegExp(s,r?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","\\d+"),h("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),h("MAINVERSION",`(${c[p.NUMERICIDENTIFIER]})\\.(${c[p.NUMERICIDENTIFIER]})\\.(${c[p.NUMERICIDENTIFIER]})`),h("MAINVERSIONLOOSE",`(${c[p.NUMERICIDENTIFIERLOOSE]})\\.(${c[p.NUMERICIDENTIFIERLOOSE]})\\.(${c[p.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASEIDENTIFIER",`(?:${c[p.NUMERICIDENTIFIER]}|${c[p.NONNUMERICIDENTIFIER]})`),h("PRERELEASEIDENTIFIERLOOSE",`(?:${c[p.NUMERICIDENTIFIERLOOSE]}|${c[p.NONNUMERICIDENTIFIER]})`),h("PRERELEASE",`(?:-(${c[p.PRERELEASEIDENTIFIER]}(?:\\.${c[p.PRERELEASEIDENTIFIER]})*))`),h("PRERELEASELOOSE",`(?:-?(${c[p.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[p.PRERELEASEIDENTIFIERLOOSE]})*))`),h("BUILDIDENTIFIER",`${f}+`),h("BUILD",`(?:\\+(${c[p.BUILDIDENTIFIER]}(?:\\.${c[p.BUILDIDENTIFIER]})*))`),h("FULLPLAIN",`v?${c[p.MAINVERSION]}${c[p.PRERELEASE]}?${c[p.BUILD]}?`),h("FULL",`^${c[p.FULLPLAIN]}$`),h("LOOSEPLAIN",`[v=\\s]*${c[p.MAINVERSIONLOOSE]}${c[p.PRERELEASELOOSE]}?${c[p.BUILD]}?`),h("LOOSE",`^${c[p.LOOSEPLAIN]}$`),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE",`${c[p.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),h("XRANGEIDENTIFIER",`${c[p.NUMERICIDENTIFIER]}|x|X|\\*`),h("XRANGEPLAIN",`[v=\\s]*(${c[p.XRANGEIDENTIFIER]})(?:\\.(${c[p.XRANGEIDENTIFIER]})(?:\\.(${c[p.XRANGEIDENTIFIER]})(?:${c[p.PRERELEASE]})?${c[p.BUILD]}?)?)?`),h("XRANGEPLAINLOOSE",`[v=\\s]*(${c[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[p.XRANGEIDENTIFIERLOOSE]})(?:${c[p.PRERELEASELOOSE]})?${c[p.BUILD]}?)?)?`),h("XRANGE",`^${c[p.GTLT]}\\s*${c[p.XRANGEPLAIN]}$`),h("XRANGELOOSE",`^${c[p.GTLT]}\\s*${c[p.XRANGEPLAINLOOSE]}$`),h("COERCEPLAIN",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?`),h("COERCE",`${c[p.COERCEPLAIN]}(?:$|[^\\d])`),h("COERCEFULL",c[p.COERCEPLAIN]+`(?:${c[p.PRERELEASE]})?`+`(?:${c[p.BUILD]})?(?:$|[^\\d])`),h("COERCERTL",c[p.COERCE],!0),h("COERCERTLFULL",c[p.COERCEFULL],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM",`(\\s*)${c[p.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",h("TILDE",`^${c[p.LONETILDE]}${c[p.XRANGEPLAIN]}$`),h("TILDELOOSE",`^${c[p.LONETILDE]}${c[p.XRANGEPLAINLOOSE]}$`),h("LONECARET","(?:\\^)"),h("CARETTRIM",`(\\s*)${c[p.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",h("CARET",`^${c[p.LONECARET]}${c[p.XRANGEPLAIN]}$`),h("CARETLOOSE",`^${c[p.LONECARET]}${c[p.XRANGEPLAINLOOSE]}$`),h("COMPARATORLOOSE",`^${c[p.GTLT]}\\s*(${c[p.LOOSEPLAIN]})$|^$`),h("COMPARATOR",`^${c[p.GTLT]}\\s*(${c[p.FULLPLAIN]})$|^$`),h("COMPARATORTRIM",`(\\s*)${c[p.GTLT]}\\s*(${c[p.LOOSEPLAIN]}|${c[p.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE",`^\\s*(${c[p.XRANGEPLAIN]})\\s+-\\s+(${c[p.XRANGEPLAIN]})\\s*$`),h("HYPHENRANGELOOSE",`^\\s*(${c[p.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[p.XRANGEPLAINLOOSE]})\\s*$`),h("STAR","(<|>)?=?\\s*\\*"),h("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),h("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},75571:function(e,t,r){const s=r(97075),o=(e,t,r)=>s(e,t,">",r);e.exports=o},76780:function(e,t,r){const s=r(78311),o=(e,t,r)=>(e=new s(e,r),t=new s(t,r),e.intersects(t,r));e.exports=o},5342:function(e,t,r){const s=r(97075),o=(e,t,r)=>s(e,t,"<",r);e.exports=o},19628:function(e,t,r){const s=r(53908),o=r(78311),i=(e,t,r)=>{let i=null,a=null,n=null;try{n=new o(t,r)}catch(l){return null}return e.forEach((e=>{n.test(e)&&(i&&-1!==a.compare(e)||(i=e,a=new s(i,r)))})),i};e.exports=i},270:function(e,t,r){const s=r(53908),o=r(78311),i=(e,t,r)=>{let i=null,a=null,n=null;try{n=new o(t,r)}catch(l){return null}return e.forEach((e=>{n.test(e)&&(i&&1!==a.compare(e)||(i=e,a=new s(i,r)))})),i};e.exports=i},41261:function(e,t,r){const s=r(53908),o=r(78311),i=r(35580),a=(e,t)=>{e=new o(e,t);let r=new s("0.0.0");if(e.test(r))return r;if(r=new s("0.0.0-0"),e.test(r))return r;r=null;for(let o=0;o<e.set.length;++o){const t=e.set[o];let a=null;t.forEach((e=>{const t=new s(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!i(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!a||r&&!i(r,a)||(r=a)}return r&&e.test(r)?r:null};e.exports=a},97075:function(e,t,r){const s=r(53908),o=r(93904),{ANY:i}=o,a=r(78311),n=r(97638),l=r(35580),c=r(7059),p=r(25200),u=r(54089),f=(e,t,r,f)=>{let m,d,h,v,g;switch(e=new s(e,f),t=new a(t,f),r){case">":m=l,d=p,h=c,v=">",g=">=";break;case"<":m=c,d=u,h=l,v="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(n(e,t,f))return!1;for(let s=0;s<t.set.length;++s){const r=t.set[s];let a=null,n=null;if(r.forEach((e=>{e.semver===i&&(e=new o(">=0.0.0")),a=a||e,n=n||e,m(e.semver,a.semver,f)?a=e:h(e.semver,n.semver,f)&&(n=e)})),a.operator===v||a.operator===g)return!1;if((!n.operator||n.operator===v)&&d(e,n.semver))return!1;if(n.operator===g&&h(e,n.semver))return!1}return!0};e.exports=f},72525:function(e,t,r){const s=r(97638),o=r(50560);e.exports=(e,t,r)=>{const i=[];let a=null,n=null;const l=e.sort(((e,t)=>o(e,t,r)));for(const o of l){const e=s(o,t,r);e?(n=o,a||(a=o)):(n&&i.push([a,n]),n=null,a=null)}a&&i.push([a,null]);const c=[];for(const[s,o]of i)s===o?c.push(s):o||s!==l[0]?o?s===l[0]?c.push(`<=${o}`):c.push(`${s} - ${o}`):c.push(`>=${s}`):c.push("*");const p=c.join(" || "),u="string"===typeof t.raw?t.raw:String(t);return p.length<u.length?p:t}},75032:function(e,t,r){const s=r(78311),o=r(93904),{ANY:i}=o,a=r(97638),n=r(50560),l=(e,t,r={})=>{if(e===t)return!0;e=new s(e,r),t=new s(t,r);let o=!1;e:for(const s of e.set){for(const e of t.set){const t=u(s,e,r);if(o=o||null!==t,t)continue e}if(o)return!1}return!0},c=[new o(">=0.0.0-0")],p=[new o(">=0.0.0")],u=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=r.includePrerelease?c:p}if(1===t.length&&t[0].semver===i){if(r.includePrerelease)return!0;t=p}const s=new Set;let o,l,u,d,h,v,g;for(const i of e)">"===i.operator||">="===i.operator?o=f(o,i,r):"<"===i.operator||"<="===i.operator?l=m(l,i,r):s.add(i.semver);if(s.size>1)return null;if(o&&l){if(u=n(o.semver,l.semver,r),u>0)return null;if(0===u&&(">="!==o.operator||"<="!==l.operator))return null}for(const i of s){if(o&&!a(i,String(o),r))return null;if(l&&!a(i,String(l),r))return null;for(const e of t)if(!a(i,String(e),r))return!1;return!0}let E=!(!l||r.includePrerelease||!l.semver.prerelease.length)&&l.semver,_=!(!o||r.includePrerelease||!o.semver.prerelease.length)&&o.semver;E&&1===E.prerelease.length&&"<"===l.operator&&0===E.prerelease[0]&&(E=!1);for(const i of t){if(g=g||">"===i.operator||">="===i.operator,v=v||"<"===i.operator||"<="===i.operator,o)if(_&&i.semver.prerelease&&i.semver.prerelease.length&&i.semver.major===_.major&&i.semver.minor===_.minor&&i.semver.patch===_.patch&&(_=!1),">"===i.operator||">="===i.operator){if(d=f(o,i,r),d===i&&d!==o)return!1}else if(">="===o.operator&&!a(o.semver,String(i),r))return!1;if(l)if(E&&i.semver.prerelease&&i.semver.prerelease.length&&i.semver.major===E.major&&i.semver.minor===E.minor&&i.semver.patch===E.patch&&(E=!1),"<"===i.operator||"<="===i.operator){if(h=m(l,i,r),h===i&&h!==l)return!1}else if("<="===l.operator&&!a(l.semver,String(i),r))return!1;if(!i.operator&&(l||o)&&0!==u)return!1}return!(o&&v&&!l&&0!==u)&&(!(l&&g&&!o&&0!==u)&&(!_&&!E))},f=(e,t,r)=>{if(!e)return t;const s=n(e.semver,t.semver,r);return s>0?e:s<0||">"===t.operator&&">="===e.operator?t:e},m=(e,t,r)=>{if(!e)return t;const s=n(e.semver,t.semver,r);return s<0?e:s>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=l},77631:function(e,t,r){const s=r(78311),o=(e,t)=>new s(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")));e.exports=o},13874:function(e,t,r){const s=r(78311),o=(e,t)=>{try{return new s(e,t).range||"*"}catch(r){return null}};e.exports=o}}]);