"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[8286],{65524:function(e,t,i){i.d(t,{A:function(){return v}});var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{display:"flex","flex-wrap":"wrap","align-items":"center"}},[e._t("prefix"),e._l(e.tabs,(function(i,a){return t("el-popover",{key:a,attrs:{"popper-class":"filterOptionsPopover",placement:e.placement,width:"280",trigger:"click"},on:{show:function(t){return e.popovershow(a)}},scopedSlots:e._u([{key:"reference",fn:function(){return[t("span",[0===a?t("el-button",{staticClass:"buttonsearch",staticStyle:{"margin-right":"3px"},attrs:{size:"mini"}},[e._t("textSlot",(function(){return[e._v("添加条件")]}))],2):[t("span",{key:a,staticStyle:{margin:"2px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff",display:"inline-block"},on:{click:function(t){return e.editTag(t,i,a-1)}}},[e._v(" "+e._s(i.keyDesc)+" "+e._s(i.operatorDesc)+" "+e._s(i.valueDesc)+" "),i.clearable?t("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.delTag(i,a-1)}}}):e._e()])]],2)]},proxy:!0}],null,!0),model:{value:i.show,callback:function(t){e.$set(i,"show",t)},expression:"item.show"}},[t("el-form",{ref:"formRef",refInFor:!0,attrs:{model:e.form,"label-position":"right","label-width":"70px"}},[t("el-form-item",{attrs:{label:"关键字",prop:"key",rules:e.required}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",size:"mini"},on:{change:e.selectField},model:{value:e.form.key,callback:function(t){e.$set(e.form,"key",t)},expression:"form.key"}},e._l(e.options,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1)],1),t("el-form-item",{attrs:{label:"操作符",prop:"operator",rules:e.required}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini"},model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}},e._l(e.selectFieldDerive.operatorArray,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1)],1),t("el-form-item",{attrs:{label:"值",rules:e.required,prop:"value"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:["datetime","time"].includes(e.selectFieldDerive.valueType),expression:"['datetime', 'time'].includes(selectFieldDerive.valueType)"}],on:{click:function(e){e.stopPropagation()}}},[t("el-date-picker",{ref:"dateRef",refInFor:!0,staticStyle:{width:"100%"},attrs:{clearable:"","popper-class":"filterDate",teleported:!1,"append-to-body":!1,type:"datetime",pickerOptions:e.pickerOptions,placeholder:"选择时间",size:"mini"},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1),["datetime","time"].includes(e.selectFieldDerive.valueType)?e._e():[e.selectFieldDerive.isEnum?t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:"",multiple:"in"===e.form.operator||"notin"===e.form.operator,"collapse-tags":""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}},e._l(e.selectFieldDerive.valueArray,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1):[e.suggestOptions&&e.suggestOptions[e.form.key]?t("el-autocomplete",{staticStyle:{width:"100%"},attrs:{size:"mini","fetch-suggestions":e.querySearch,clearable:""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}}):t("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})]]],2),t("el-form-item",[t("el-button",{staticClass:"buttonsearch",attrs:{size:"mini"},on:{click:function(t){return e.confirm(a)}}},[e._v("确定")])],1)],1)],1)}))],2)},l=[],s=i(95093),n=i.n(s);class r{constructor(e){this.key=e?.key,this.operator=e?.operator,this.value=e?.value}}const o=n()().startOf("days"),c=n()().startOf("days").subtract(1,"days"),p=n()().startOf("days").subtract(7,"days"),u=n()().startOf("days").subtract(15,"days"),d=n()().startOf("days").subtract(30,"days"),h={[o]:"今天",[c]:"昨天",[p]:"七天前",[u]:"十五天前",[d]:"三十天前"};var m={props:{value:{type:Array,default:()=>[]},options:{default:()=>[]},placement:{default:"top"},initData:{type:Object,default:null},suggestOptions:{default:()=>({})},multiCondition:{default:!0}},created(){},mounted(){},data(){return{moment:Object.freeze(n()),form:new r,show:!1,editIdx:-1,pickerOptions:{disabledDate(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(e){e.$emit("pick",o)}},{text:"昨天",onClick(e){e.$emit("pick",c)}},{text:"七天前",onClick(e){e.$emit("pick",p)}},{text:"十五天前",onClick(e){e.$emit("pick",u)}},{text:"三十天前",onClick(e){e.$emit("pick",d)}}]},required:{required:!0,message:"请检查必填项",trigger:["blur","change"]}}},computed:{filters:{get(){return this.value?.map((e=>this.getSelectItem(e)))},set(e){this.$emit("input",e),this.$emit("change",e)}},selectFieldDerive(){var e=this.options.findIndex((e=>e.key===this.form.key));return{operatorArray:this.options?.[e]?.operators||[],isEnum:!!this.options?.[e]?.enums,valueArray:this.options?.[e]?.enums||[],valueType:this.options?.[e]?.type}},tabs(){return[{show:!1},...this.filters]}},methods:{querySearch(e,t){var i=this.suggestOptions?.[this.form.key],a=e?i.filter((t=>-1!==String(t).toLowerCase().indexOf(e.toLowerCase()))):i;t(a.map((e=>({value:e}))))},selectField(e){this.form.value=null,this.$nextTick((()=>{this.form.operator=this.selectFieldDerive.operatorArray.some((e=>"like"===e.key))?"like":this.selectFieldDerive.operatorArray?.[0]?.key}))},selectOperator(e){this.form.value=null},async confirm(e){try{if(await(this.$refs.formRef?.[e].validate().catch((()=>{throw"请检查必填项"}))),this.show=!1,this.editIdx>=0&&this.editIdx<this.filters.length){const e=this.filters||[];e[this.editIdx]=this.valueDecode(Object.assign(e[this.editIdx],this.form)),this.filters=[...e],this.editIdx=-1}else this.pushFilter(this.form)}catch(t){this.$message.warning(t)}},valueDecode(e){const t=this.options?.find((t=>t.key===e.key));return t.enum&&e.value&&("in"===e.operator||"notin"===e.operator)&&Array.isArray(e.value)?{...e,value:e.value.join(",")}:{...e}},valueEncode(e){const t=this.options?.find((t=>t.key===e.key));return t?.enum&&e.value&&("in"===e.operator||"notin"===e.operator)&&(e.value=e.value?.split(",")||e.value),e},pushFilter(e){const t=this.filters||[],i=t.findIndex((t=>t.key===e.key)),a=t[i];e=this.valueDecode(e),a?(null===e.value||void 0===e||""===e?t.splice(i,1):Object.assign(a,e),this.filters=[...t]):null!==e.value&&void 0!==e&&""!==e&&(!this.multiCondition&&t.length>0&&(t.length=0),this.filters=[...t,{...e}])},getSelectItem({key:e,operator:t,value:i,clearable:a=!0,disabled:l=!1}){const s=this.options?.find((t=>t.key===e)),r=s?.operators,o=s?.enums||[],c=()=>{const a=this.valueEncode({key:e,operator:t,value:i})?.value;if("time"===s?.type){const e=n()(i);return e in h?h[e]:e.format("YYYY-MM-DD HH:mm:ss")}return s?.enum?"in"===t||"notin"===t?a?.map((e=>o.find((t=>t.key===e))?.desc))?.join(",")||a:o.find((e=>e.key===a))?.desc:i};return{key:e,keyDesc:s?.desc,value:i,valueDesc:c(),show:!1,valueType:s?.type,operator:t,clearable:a,disabled:l,operatorDesc:r?.find((e=>e.key===t))?.desc}},delTag(e,t){const i=this.filters||[];i.splice(t,1),this.filters=i},editTag(e,t,i){t.disabled?e.stopPropagation():(this.editIdx=i,this.form=new r(this.valueEncode(t)))},popovershow(e){this.$refs.dateRef[e].placement="right"}}},f=m,g=i(81656),y=(0,g.A)(f,a,l,!1,null,"84dd770c",null),v=y.exports},23947:function(e,t,i){i.d(t,{A:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("detail",e._g(e._b({},"detail",e.$attrs,!1),e.$listeners))},l=[],s={components:{detail:()=>Promise.all([i.e(9534),i.e(5358),i.e(6131),i.e(4461),i.e(6),i.e(9141),i.e(9121),i.e(8271),i.e(2376)]).then(i.bind(i,88271))}},n=s,r=i(81656),o=(0,r.A)(n,a,l,!1,null,null,null),c=o.exports},92161:function(e,t,i){i.d(t,{A:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",{class:"事件详情"===e.nameShow?"pageClass":"",staticStyle:{height:"20px","padding-top":"10px"}},[t("span",{staticStyle:{display:"inline-block","font-size":"13px","min-width":"35.5px",height:"28px","line-height":"30px","vertical-align":"top","box-sizing":"border-box",float:"right"}},[e._v("共"+e._s(e.pageTotal)+"条")]),t("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"jumper,sizes,prev, pager, next","page-size":e.size||15,"current-page":e.pageCurrent,total:e.pageTotal,"page-sizes":e.pageSizeArray||[15,30,45]},on:{"update:currentPage":function(t){e.pageCurrent=t},"update:current-page":function(t){e.pageCurrent=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},l=[],s={name:"page",props:{pageSizeArray:Array,size:Number,pageTotal:Number,current:Number,nameShow:String},data(){return{pageCurrent:this.current}},methods:{handleSizeChange(e){this.$emit("handleSizeChange",e)},handleCurrentChange(e){this.$emit("handleCurrentChange",e)}},watch:{current:function(e){this.pageCurrent=e}}},n=s,r=i(81656),o=(0,r.A)(n,a,l,!1,null,"277403d7",null),c=o.exports},90177:function(e,t,i){i.d(t,{A:function(){return L}});var a=function(){var e=this,t=e._self._c;return t("el-drawer",{attrs:{visible:e.processShow,direction:"rtl",size:"70%",title:"进程详情","destroy-on-close":"","append-to-body":""},on:{"update:visible":function(t){e.processShow=t},close:function(t){e.activeTab="-1"}}},[t("div",{staticStyle:{padding:"10px"}},[t("processDetail",{attrs:{minionId:e.minionId,pid:e.pid}}),"-1"!==e.activeTab?t(e.activeTab,{ref:"tabRef",tag:"component",staticStyle:{"margin-top":"5px"},attrs:{minionId:e.minionId,pid:e.pid},scopedSlots:e._u([{key:"prefix",fn:function(){return[t("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"-5px","margin-right":"5px"}},[t("el-radio-group",{staticStyle:{"margin-bottom":"5px"},attrs:{size:"mini"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-radio-button",{attrs:{label:"processHandle"}},[e._v("进程句柄")]),t("el-radio-button",{attrs:{label:"progressNet"}},[e._v("进程网络")])],1)],1)]},proxy:!0}],null,!1,3711422603)}):e._e()],1)])},l=[],s=function(){var e=this,t=e._self._c;return t("div",[t("el-descriptions",{attrs:{size:"mini",column:2,border:""}},[t("el-descriptions-item",{attrs:{label:"启动命令",span:2}},[e._v(" "+e._s(e.processDetailData.cmdline||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"进程名称"}},[e._v(" "+e._s(e.processDetailData.name||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"PID"}},[e._v(" "+e._s(e.processDetailData.pid||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"状态"}},[t("el-tag",{attrs:{size:"mini",type:"running"===e.processDetailData.state?"success":"warning"}},[e._v(" "+e._s(e.processDetailData.state||"-")+" ")])],1),t("el-descriptions-item",{attrs:{label:"内存使用"}},[e._v(" "+e._s(e.processDetailData.mem_size||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"用户名"}},[e._v(" "+e._s(e.processDetailData.username||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"启动时间"}},[e._v(" "+e._s(e.processDetailData.uptime&&e.moment(1e3*e.processDetailData.uptime).format("YYYY-MM-DD HH:mm:ss"))+" ")]),t("el-descriptions-item",{attrs:{label:"更新时间"}},[e._v(" "+e._s(e.processDetailData.modify_time&&e.moment(e.processDetailData.modify_time).format("YYYY-MM-DD HH:mm:ss"))+" ")]),t("el-descriptions-item",{attrs:{label:"创建时间"}},[e._v(" "+e._s(e.processDetailData.create_time&&e.moment(e.processDetailData.create_time).format("YYYY-MM-DD HH:mm:ss"))+" ")]),t("el-descriptions-item",{attrs:{label:"checksum"}},[e._v(" "+e._s(e.processDetailData.checksum||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"cpu占用"}},[e._v(" "+e._s(e.toFixed4(e.processDetailData.cpu_pct)||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"内存占用"}},[e._v(" "+e._s(e.toFixed4(e.processDetailData.mem_pct)||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"执行路径"}},[e._v(" "+e._s(e.processDetailData.executable||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"ppid"}},[e._v(" "+e._s(e.processDetailData.ppid||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"parent_executable"}},[e._v(" "+e._s(e.processDetailData.parent_executable||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"parent_name"}},[e._v(" "+e._s(e.processDetailData.parent_name||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"parent_username"}},[e._v(" "+e._s(e.processDetailData.parent_username||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"parent_cmdline",span:2}},[e._v(" "+e._s(e.processDetailData.parent_cmdline||"-")+" ")])],1)],1)},n=[],r=i(98362),o=i(95093),c=i.n(o),p={props:["minionId","pid"],data(){return{moment:c(),processDetailData:{name:null,state:null,pid:null,mem_size:null,executable:null,username:null,uptime:null,cmdline:null,checksum:null,cpu_pct:null,mem_pct:null,parent_cmdline:null,parent_executable:null,parent_username:null}}},created(){this.loadData()},methods:{toFixed4(e){return Number(e).toFixed(1)+"%"},async loadData(){try{const{data:e}=await r.A.get("/arr/agent/process/pid",{params:{pid:this.pid},headers:{"X-Node-Identify":this.minionId}});this.processDetailData=e||{}}catch(e){this.$message.error(e)}}}},u=p,d=i(81656),h=(0,d.A)(u,s,n,!1,null,null,null),m=h.exports,f=function(){var e=this,t=e._self._c;return t("div",[t("tableList",{ref:"table",attrs:{refreshAble:"",data:e.tableDataShow,localPaginate:"",configAble:!1,columns:e.columns},on:{loadData:e.loadData},scopedSlots:e._u([{key:"right_top_btn",fn:function(){return[t("div",{staticStyle:{display:"flex"}},[e._t("prefix"),t("el-input",{staticStyle:{width:"300px","margin-right":"4px"},attrs:{placeholder:"模糊查询",clearable:"",size:"mini","suffix-icon":"el-icon-search"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("filterOption",{attrs:{options:e.options},model:{value:e.filters,callback:function(t){e.filters=t},expression:"filters"}})],2)]},proxy:!0}],null,!0)})],1)},g=[],y=i(35467),v=i(72661),b=i(72505),_=i.n(b),k=i(65524),x={components:{tableList:y.A,filterOption:k.A},props:["minionId","pid"],data(){return{tableData:[],filters:[],keyword:"",columns:[{label:"fd",prop:"fd",width:"100px"},{label:"创建时间",sortable:!0,prop:"ctimeFormat",width:"150px"},{label:"访问时间",sortable:!0,width:"150px",prop:"atimeFormat"},{label:"更新时间",sortable:!0,prop:"MtimeFormat",width:"150px"},{label:"路径",prop:"path"},{label:"大小",width:"80px",sortable:!0,prop:"sizeFormat"}],options:[["fd","fd"],["ctime","创建时间","time"],["atime","访问时间","time"],["Mtime","更新时间","time"],["size","大小"],["path","路径"]].map((([e,t,i="string"])=>({desc:t,enum:!1,key:e,type:i,operators:[{desc:"LIKE",key:"like"},{desc:"大于",key:"gt"},{desc:"小于",key:"lt"}]})))}},computed:{tableDataShow(){return this.tableData.filter((e=>this.filters.every((t=>{const i=this.options.find((e=>e.key===t.key));let a=t.value;return"time"===i.type&&(a=+c()(a)),"eq"===t.operator?String(a)===String(e[t.key]):"gt"===t.operator?String(a)<String(e[t.key]):"lt"===t.operator?String(a)>String(e[t.key]):String(e[t.key]).includes(String(a))}))))?.filter((e=>{let t=this.columns.some((t=>{const i=t.prop||t.slot;return String(e[i]).includes(this.keyword)}));return t}))||[]}},methods:{async loadData(){try{const{data:e}=await _().get("/arr/agent/process/handle",{params:{pid:this.pid},headers:{"X-Node-Identify":this.minionId}});if(!Array.isArray(e))throw e.detail||"查询出错";this.tableData=e?.map((e=>(e.ctimeFormat=e.ctime&&c()(e.ctime).format("YYYY-MM-DD HH:mm:ss"),e.atimeFormat=e.atime&&c()(e.atime).format("YYYY-MM-DD HH:mm:ss"),e.MtimeFormat=e.Mtime&&c()(e.Mtime).format("YYYY-MM-DD HH:mm:ss"),e.sizeFormat=(0,v.Gz)(e.size),e)))||[]}catch(e){this.$message.error(e)}}},created(){this.loadData()}},S=x,w=(0,d.A)(S,f,g,!1,null,"34f49437",null),D=w.exports,C=function(){var e=this,t=e._self._c;return t("div",[t("tableList",{attrs:{refreshAble:"",data:e.tableData,columns:e.columns,localPaginate:""},on:{loadData:e.loadData},scopedSlots:e._u([{key:"right_top_btn",fn:function(){return[t("div",{staticStyle:{display:"flex"}},[e._t("prefix"),t("div",{staticStyle:{flex:"1",display:"flex","justify-content":"space-between","align-items":"center"}},[t("div",{staticStyle:{display:"flex"}},[t("filterOption",{attrs:{options:e.conditions},scopedSlots:e._u([{key:"prefix",fn:function(){return[t("el-input",{staticStyle:{width:"200px","margin-right":"4px"},attrs:{placeholder:"模糊查询",clearable:"",size:"mini","suffix-icon":"el-icon-search"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})]},proxy:!0}]),model:{value:e.filters,callback:function(t){e.filters=t},expression:"filters"}})],1),t("span",[t("el-tag",{class:{tagActive:"CLOSED"===e.filterStatu},attrs:{size:"mini"},on:{click:function(t){return e.filterStatuChange("CLOSED")}}},[e._v(" closed: "+e._s(e.netInfo.closed)+" ")]),t("el-tag",{class:{tagActive:"CLOSING"===e.filterStatu},attrs:{size:"mini",type:"success"},on:{click:function(t){return e.filterStatuChange("CLOSING")}}},[e._v(" closing: "+e._s(e.netInfo.closing)+" ")]),t("el-tag",{class:{tagActive:"LISTEN"===e.filterStatu},attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.filterStatuChange("LISTEN")}}},[e._v(" listen: "+e._s(e.netInfo.listen)+" ")]),t("el-tag",{class:{tagActive:"ESTAB"===e.filterStatu},attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.filterStatuChange("ESTAB")}}},[e._v(" established: "+e._s(e.netInfo.established)+" ")]),t("el-tag",{attrs:{size:"mini",type:"info"}},[e._v(" total: "+e._s(e.netInfo.total)+" ")])],1)])],2)]},proxy:!0},{key:"local_ip_header",fn:function({col:i}){return[e._v(" "+e._s(i.label)+" "),t("filterCol",{attrs:{option:e.filterOption},on:{change:({value:t})=>{e.netType=t||0}}})]}},{key:"remote_ip_header",fn:function({col:i}){return[e._v(" "+e._s(i.label)+" "),t("filterCol",{attrs:{option:e.filterOption},on:{change:({value:t})=>{e.netType={1:3,2:4}[t]||0}}})]}}],null,!0)})],1)},z=[],A=i(94194),I={props:["minionId","pid"],components:{tableList:y.A,filterOption:k.A,filterCol:A.A},data(){return{netType:0,netTypeInfo:"对内",filterStatu:"",filterOption:{enum:!0,enums:[{key:1,desc:"对内"},{key:2,desc:"对外"}],operators:[{key:"eq",desc:"等于"}],type:"string"},netInfo:{closed:null,listen:null,syn_sent:null,syn_rcvd:null,established:null,fin_wait1:null,fin_wait2:null,close_wait:null,closing:null,last_ack:null,time_wait:null,delete_tcb:null,sockets:[]},keyword:"",conditions:["state","family","protocol","local_ip","local_port","remote_ip","remote_port","pid","inode","process","username"].map((e=>({key:e,desc:e,type:"string",operators:[{desc:"LIKE",key:"like"},{desc:"大于",key:"gt"},{desc:"小于",key:"lt"}],enum:!1,enums:[]}))),columns:[{label:"state",prop:"state",width:"100px"},{label:"family",prop:"family",width:"100px",formatter(e){return{2:"IPV4",23:"IPV6"}[e.family]}},{label:"protocol",prop:"protocol",width:"100px",formatter(e){return{1:"TCP",2:"UDP"}[e.protocol]}},{label:"local_ip",prop:"local_ip",width:"120px",slotHeader:"local_ip_header"},{label:"local_port",prop:"local_port",width:"100px"},{label:"remote_ip",prop:"remote_ip",width:"120px",slotHeader:"remote_ip_header"},{label:"remote_port",prop:"remote_port",width:"100px"},{label:"inode",prop:"inode",width:"100px"},{label:"process",prop:"process","show-overflow-tooltip":!0},{label:"username",prop:"username","show-overflow-tooltip":!0}],filters:[]}},computed:{tableData(){return this.netInfo?.sockets?.filter((e=>this.filters.every((t=>{let i=t.value;return"eq"===t.operator?String(i)===String(e[t.key]):"gt"===t.operator?String(i)<String(e[t.key]):"lt"===t.operator?String(i)>String(e[t.key]):String(e[t.key]).includes(String(i))}))))?.filter((e=>{let t=this.columns.some((t=>{const i=t.prop||t.slot;return String(e[i]).includes(this.keyword)}));return t})).filter((e=>0===this.netType||(1===this.netType?e.local_private:2===this.netType?!e.local_private:3===this.netType?e.remote_private:!e.remote_private))).filter((e=>!this.filterStatu||e.state===this.filterStatu))||[]}},created(){this.loadData()},methods:{async loadData(){try{const{data:e}=await _().get("/arr/agent/ss/pid",{params:{pid:this.pid},headers:{"X-Node-Identify":this.minionId}})||{};this.netInfo=e||{}}catch(e){this.$message.error(e?.data||e||"查询出错")}},filterStatuChange(e){e===this.filterStatu?this.filterStatu="":this.filterStatu=e},netTypeChange(e){this.netType=e}}},T=I,$=(0,d.A)(T,C,z,!1,null,"fc89c990",null),O=$.exports,E={components:{processDetail:m,processHandle:D,progressNet:O},data(){return{activeTab:"-1",processShow:!1,minionId:null,pid:null}},methods:{openProcessDetial(e,t){this.minionId=e,this.pid=t,this.processShow=!0,this.activeTab="processHandle"}}},P=E,F=(0,d.A)(P,a,l,!1,null,"226e108c",null),L=F.exports},1477:function(e,t,i){i.d(t,{A:function(){return c}});var a=function(){var e=this,t=e._self._c;return e.condData?t("div",[e.multiCondition?t("el-row",{staticStyle:{"margin-bottom":"5px"}},[t("el-col",{attrs:{span:24}},e._l(e.filters,(function(i,a){return t("span",{key:a,staticStyle:{"margin-right":"5px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff",display:"inline-block"}},[e._v(" "+e._s(i.keyDesc)+" "+e._s(i.operatorDesc)+" "+e._s(i.value)+" "),t("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.editTag(i,a)}}}),t("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.delTag(i,a)}}})])})),0)],1):e._e(),t("div",{class:"事件详情"===e.nameIndex||"任务详情"===e.nameIndex||"风险详情"===e.nameIndex?"dom":"doms"},[e._l(e.selectArray,(function(i,a){return t("span",{key:a},["蜜罐"!==e.nameIndex?t("el-dropdown",{staticStyle:{"margin-right":"5px"},attrs:{trigger:"click"}},[t("el-button",{attrs:{type:"primary",size:"mini"}},[e._v(" "+e._s(i.placeholder)),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(i.dataArray,(function(a){return t("el-dropdown-item",{key:a.key,attrs:{value:a.key},nativeOn:{click:function(t){return e.selectActive(a,i)}}},[e._v(e._s(a.desc))])})),1)],1):e._e()],1)})),"事件展示"===e.nameIndex?t("span",[t("el-dropdown",{staticStyle:{"margin-right":"5px"},attrs:{trigger:"click"}},[t("el-button",{attrs:{type:"primary",size:"mini"}},[e._v(" 时间搜索"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.eventTime,(function(i){return t("el-dropdown-item",{key:i.value,attrs:{value:i.value},nativeOn:{click:function(t){return e.eventTimeChange(i)}}},[e._v(e._s(i.label))])})),1)],1)],1):e._e(),"事件详情"===e.nameIndex?t("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.oneClear}},[e._v("一键清除")]):e._e(),"事件详情"===e.nameIndex||"任务详情"===e.nameIndex||"风险详情"===e.nameIndex?t("el-button",{staticStyle:{"margin-right":"7px"},attrs:{type:"success",size:"mini"},on:{click:e.refresh}},[e._v("刷新")]):e._e(),t("el-select",{staticStyle:{width:"150px","margin-right":"7px"},attrs:{size:"mini","value-key":"key"},on:{change:e.selectField},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}},[e._l(e.condData.conditions,(function(i,a){return[i.key!==e.eventLogon?t("el-option",{key:a,attrs:{value:i.key,label:i.desc}}):e._e()]}))],2),t("el-select",{staticStyle:{width:"100px","margin-right":"7px"},attrs:{size:"mini","value-key":"key"},on:{change:e.selectOperator},model:{value:e.operator,callback:function(t){e.operator=t},expression:"operator"}},e._l(e.selectFieldDerive.operatorArray,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1),["datetime","time"].includes(e.selectFieldDerive.typeConditions)?t("span",{staticStyle:{display:"inline-block","margin-right":"7px"}},[t("el-date-picker",{attrs:{clearable:"",type:"datetime",pickerOptions:e.pickerOptions,placeholder:"选择时间",size:"mini"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1):t("span",{staticStyle:{display:"inline-block","margin-right":"7px"}},[e.selectFieldDerive.selectType?t("el-select",{staticStyle:{width:"180px"},attrs:{size:"mini",clearable:"","value-key":"key",multiple:"in"===e.operator||"notin"===e.operator,"collapse-tags":""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.selectFieldDerive.valueArray,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1):t("span",{staticStyle:{position:"relative",display:"inline-block"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",clearable:""},on:{focus:function(t){e.suggestVisible=!0}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1),t("el-button",{class:"事件详情"===e.nameIndex||"任务详情"===e.nameIndex||"风险详情"===e.nameIndex?"buttons":"buttonsearch",attrs:{icon:"el-icon-search",size:"mini"},on:{click:()=>{e.suggestVisible=!1,e.searchCond()}}},[e._v(e._s(e.titleH)+" ")])],2)],1):e._e()},l=[],s={name:"index",props:{titleH:{type:String,default:function(){return""}},condData:{type:Object,default:function(){return{}}},defaultData:{type:Object,default:function(){return{}}},eventLogon:{type:String,default:function(){return""}},nameIndex:{type:String,default:function(){return""}},selectArray:{type:Array,default:function(){return[]}},multiCondition:{default:!0},inputSuggestOptions:{type:Object}},computed:{selectFieldDerive(){var e=this.condData?.conditions?.findIndex((e=>e.key===this.key));return{operatorArray:this.condData?.conditions?.[e]?.operators||[],selectType:this.condData?.conditions?.[e]?.enum,valueArray:this.condData?.conditions?.[e]?.enums||[],typeConditions:this.condData?.conditions?.[e]?.type}},suggestOption(){return this.inputSuggestOptions&&this.inputSuggestOptions[this.key]||[]}},data(){return{operator:"",value:null,key:"",filters:[],current:1,pageSize:15,suggestVisible:!1,eventTime:[{value:"900",label:"十五分钟"},{value:"3600",label:"一小时"},{value:"86400",label:"一天"},{value:"604800",label:"一周"},{value:"2592000",label:"一个月"}],pickerOptions:{disabledDate(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(e){e.$emit("pick",new Date)}},{text:"昨天",onClick(e){const t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick(e){const t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}},{text:"三十天前",onClick(e){const t=new Date;t.setTime(t.getTime()-2592e6),e.$emit("pick",t)}}]}}},created(){const e=this.filters.push.bind(this.filters);this.filters.push=(...t)=>{for(let i of t){const t=this.filters.find((e=>e.key===i.key));t?Object.assign(t,i):(!this.multiCondition&&this.filters.length>0&&(this.filters.length=0),e(i))}},"彻底删除"===this.nameIndex?(this.filters.push(this.getSelectItem("status","eq","4")),this.$emit("searchBasic",this.filters)):(this.key=this.defaultData?.key||null,this.operator=this.defaultData?.operator||null)},methods:{refresh(){this.$emit("refresh")},oneClear(){this.$emit("oneClear")},selectField(e){this.value=void 0,this.$nextTick((()=>{this.operator=this.selectFieldDerive.operatorArray.some((e=>"like"===e.key))?"like":this.selectFieldDerive.operatorArray?.[0].key}))},selectOperator(e){this.operatorValue=e.key,this.value=null},eventTimeChange(e){this.filters.length=0,this.filters.push(this.getSelectItem("created_at","lt",new Date)),this.filters.push(this.getSelectItem("created_at","gt",new Date(new Date-24e3*e.value))),this.$emit("searchBasic",this.filters)},selectActive(e,t){this.filters.push(this.getSelectItem(t.name,"eq",e.key)),this.$emit("searchBasic",this.filters)},delTag(e,t){("蜜罐"!==this.nameIndex&&"事件详情"!==this.nameIndex&&"风险详情"!==this.nameIndex||0!==t)&&(this.filters.splice(t,1),this.$emit("searchBasic",this.filters))},editTag(e,t){("蜜罐"!==this.nameIndex&&"事件详情"!==this.nameIndex&&"风险详情"!==this.nameIndex||0!==t)&&(this.key=e.key,this.value=e.value,this.operator=e.operator)},getSelectItem(e,t,i){return{key:e,keyDesc:this.condData?.conditions?.find((t=>t.key===e))?.desc,value:i,operator:t,operatorDesc:this.selectFieldDerive.operatorArray.find((e=>e.key===t))?.desc}},searchCond(){if(""!==this.key&&void 0!==this.value&&void 0!==this.operator&&null!==this.value&&""!==this.value){const e=this.getSelectItem(this.key,this.operator,this.value);this.filters.push(e)}if(!this.value&&this.key){const e=this.filters.find((e=>e.key===this.key));-1!==e&&this.filters.splice(e,1)}this.$emit("searchBasic",this.filters)},setOption(e,t,i){this.key=e,this.operator=t,this.value=i,this.searchCond()}},watch:{nameIndex:function(e,t){"彻底删除"===e&&e!==t&&(this.filters.push(this.getSelectItem("status","eq","4")),this.$emit("searchBasic",this.filters))}}},n=s,r=i(81656),o=(0,r.A)(n,a,l,!1,null,"1e98ace1",null),c=o.exports},94194:function(e,t,i){i.d(t,{A:function(){return y}});var a=function(){var e=this,t=e._self._c;return t("span",[t("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t("el-form",{ref:"formRef",attrs:{model:e.form,"label-position":"right","label-width":"70px"}},[t("el-form-item",{attrs:{label:"操作符",prop:"operator",rules:e.required}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini"},model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}},e._l(e.operatorArray,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1)],1),t("el-form-item",{attrs:{label:"值",rules:e.required,prop:"value"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:["datetime","time"].includes(e.valueType),expression:"['datetime', 'time'].includes(valueType)"}],on:{click:function(e){e.stopPropagation()}}},[t("el-date-picker",{ref:"dateRef",staticStyle:{width:"100%"},attrs:{clearable:"","popper-class":"filterDate",teleported:!1,"append-to-body":!1,type:"datetime",pickerOptions:e.pickerOptions,placeholder:"选择时间",size:"mini"},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1),["datetime","time"].includes(e.valueType)?e._e():[e.isEnum?t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:"",multiple:"in"===e.form.operator||"notin"===e.form.operator,"collapse-tags":""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}},e._l(e.valueArray,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1):[e.suggestOptions?t("el-autocomplete",{staticStyle:{width:"100%"},attrs:{size:"mini","fetch-suggestions":e.querySearch,clearable:""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}}):t("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})]]],2),t("div",{staticStyle:{"margin-top":"5px",display:"flex","justify-content":"center"}},[t("el-button",{staticClass:"buttonsearch",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.confirm()}}},[e._v("确定")]),t("el-button",{staticClass:"buttonsearch",attrs:{size:"mini"},on:{click:function(t){return e.clear()}}},[e._v("清空")])],1)],1),t("i",{staticClass:"el-icon-caret-bottom",attrs:{slot:"reference"},slot:"reference"})],1)],1)},l=[],s=i(95093),n=i.n(s);class r{constructor(e){this.operator=e?.operator,this.value=e?.value||""}}const o=n()().startOf("days"),c=n()().startOf("days").subtract(1,"days"),p=n()().startOf("days").subtract(7,"days"),u=n()().startOf("days").subtract(15,"days"),d=n()().startOf("days").subtract(30,"days");var h={props:{value:{type:Array},suggestOptions:{default:()=>({})},option:{type:Object,required:!0}},computed:{operatorArray(){return this.option.operators},valueType(){return this.option.type},isEnum(){return this.option.enum},valueArray(){return this.option.enums}},watch:{operatorArray:{handler(e){this.form.operator=e?.[0].key},immediate:!0}},data(){return{form:new r,required:{required:!0,message:"请检查必填项",trigger:["blur"]},pickerOptions:{disabledDate(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(e){e.$emit("pick",o)}},{text:"昨天",onClick(e){e.$emit("pick",c)}},{text:"七天前",onClick(e){e.$emit("pick",p)}},{text:"十五天前",onClick(e){e.$emit("pick",u)}},{text:"三十天前",onClick(e){e.$emit("pick",d)}}]},show:!1}},methods:{querySearch(e,t){var i=this.suggestOptions,a=e?i.filter((t=>-1!==String(t).toLowerCase().indexOf(e.toLowerCase()))):i;t(a.map((e=>({value:e}))))},async confirm(){try{await this.$refs.formRef.validate().catch((()=>{throw"检查必填项"})),this.emitForm()}catch(e){}},emitForm(){this.$emit("input",this.form),this.$emit("change",this.form)},clear(){this.show=!1,this.form.value=null,this.emitForm()}}},m=h,f=i(81656),g=(0,f.A)(m,a,l,!1,null,"05bdb869",null),y=g.exports},35467:function(e,t,i){i.d(t,{A:function(){return k}});var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("div",{staticClass:"tableHead"},[t("div",{staticStyle:{flex:"1","margin-right":"5px"}},[e._t("right_top_btn")],2),t("span",{staticClass:"icon"},[e.refreshAble?t("i",{staticClass:"el-icon-refresh",attrs:{title:"重加载数据"},on:{click:e.loadData}}):e._e(),e.configAble&&"inhead"!==e.configIconPos?t("i",{class:{"el-icon-setting":!0},attrs:{title:"编辑表格"},on:{click:function(t){e.dialogVisible=!0}}}):e._e()])]),t("div",{staticStyle:{position:"relative"}},[e.configAble&&"inhead"===e.configIconPos?t("i",{staticClass:"el-icon-setting iconInHead",attrs:{title:"编辑表格"},on:{click:function(t){e.dialogVisible=!0}}}):e._e()]),t("el-table",e._g(e._b({ref:"table",staticStyle:{width:"100%"},attrs:{"header-cell-style":e.$attrs["header-cell-style"]||{color:"#909399",textAlign:"center",background:"#f5f7fa"},data:e.showData,stripe:e.stripe},on:{"selection-change":e.selectionChange}},"el-table",e.$attrs,!1),e.$listeners),[e.selection?t("el-table-column",{attrs:{selectable:e.selectable,type:"selection","reserve-selection":""}}):e._e(),e.index?t("el-table-column",{attrs:{type:"index",label:"序号",align:"center",fixed:"left"}}):e._e(),e._l(e.showColumn,(function(i,a){return[t("el-table-column",{key:a,attrs:{prop:i&&i.prop,label:i&&i.label,width:i&&i.width,"min-width":i&&i["min-width"],fixed:i&&i.fixed,formatter:i&&i.formatter,"show-overflow-tooltip":i&&i["show-overflow-tooltip"]||!1,sortable:i&&i.sortable,"sort-method":i&&i["sort-method"],"sort-by":i&&i["sort-by"],align:i&&i.align||"center","header-align":"center","sort-orders":i&&i["sort-orders"],type:i&&i.type,"class-name":i&&i["class-name"]},scopedSlots:e._u([i&&i.slotHeader?{key:"header",fn:function(t){return[e._t(i&&i.slotHeader,null,{row:t.row,col:i,$index:t.$index})]}}:null,i&&i.slot?{key:"default",fn:function(t){return[e._t(i&&i.slot,null,{row:t.row,col:i,$index:t.$index})]}}:null],null,!0)})]}))],2),e.needPagination?t("div",{style:e.paginationStyle},[t("el-pagination",{attrs:{"current-page":e.pagination.pageIndex,"page-sizes":e.pagination.pageSizes||[15,30,50],"page-size":e.pagination.pageSize,layout:e.pagination.layout||"jumper, sizes, prev, pager, next,total",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.pagination,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageIndex",t)},"update:pageSize":function(t){return e.$set(e.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.pagination,"pageSize",t)}}})],1):e._e(),t("ColumnConfig",{attrs:{columns:e.filterColumns,visible:e.dialogVisible,selectColumn:e.selectedColumn},on:{"update:visible":function(t){e.dialogVisible=t},"update:selectColumn":function(t){e.selectedColumn=t},"update:select-column":function(t){e.selectedColumn=t}}})],1)},l=[],s=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"设置需展示的列",visible:e.dialogVisible,width:"800px","append-to-body":""},on:{open:function(t){return e.opened()},"update:visible":function(t){e.dialogVisible=t}}},[t("div",[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),t("el-button",{staticStyle:{"text-decoration":"underline",color:"red"},attrs:{type:"text"},on:{click:function(t){return e.$refs.SortColumn.open()}}},[e._v("手动排序")]),t("el-button",{staticStyle:{"text-decoration":"underline",color:"red"},attrs:{type:"text"},on:{click:e.reset}},[e._v("重置配置")]),t("div",{staticStyle:{margin:"15px 0"}}),t("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.checkboxSelectBuff,callback:function(t){e.checkboxSelectBuff=t},expression:"checkboxSelectBuff"}},e._l(e.__column,(function(i){return t("el-col",{key:i.columnUUkey,staticClass:"colCheckbox",attrs:{span:8}},[t("el-checkbox",{attrs:{title:i.label,label:i.columnUUkey}},[e._v(e._s(i.label)+" ")])],1)})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)]),t("SortColumn",{ref:"SortColumn",attrs:{column:e.__column},on:{close:e.clsoeSort}})],1)},n=[],r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"拖动节点进行排序",visible:e.dialogVisible,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-tree",{attrs:{data:e.data,"node-key":"columnUUkey","default-expand-all":"",draggable:"","allow-drop":e.allowDrog}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.close}},[e._v("确 定")])],1)],1)},o=[],c={props:{column:{type:Array,require:!0}},data(){return{data:[],dialogVisible:!1}},created(){},methods:{open(){this.dialogVisible=!0,this.data=this.column.map((e=>({columnUUkey:e.columnUUkey,label:e.label})))},close(){this.dialogVisible=!1,this.$emit("close",this.data.map((e=>e.columnUUkey)))},allowDrog(e,t,i){return"inner"!==i}}},p=c,u=i(81656),d=(0,u.A)(p,r,o,!1,null,null,null),h=d.exports,m={props:{columns:{type:Array,default:()=>[]},visible:{type:Boolean,require:!0,default:!1},selectColumn:{type:Array,default:()=>[]}},components:{SortColumn:h},computed:{dialogVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}},checkboxSelect:{get(){return this.selectColumn},set(e){this.$emit("update:selectColumn",e)}},__column(){return this.columns.map((e=>({label:e.label,columnUUkey:e.prop||e.slot}))).sort(((e,t)=>(this.__sortWeight[e.columnUUkey]||0)-(this.__sortWeight[t.columnUUkey]||0)))},__sortWeight(){const e={};for(let t=0;t<this.sortColumnList.length;t++)e[this.sortColumnList[t]]=t;return e}},data(){return{sortColumnList:[],checkAll:!1,isIndeterminate:!1,checkboxSelectBuff:[],oldColumns:[]}},methods:{handleCheckAllChange(e){this.checkboxSelectBuff=e?this.__column.map((e=>e.columnUUkey)):[],this.isIndeterminate=!1},handleCheckedCitiesChange(e){this.checkboxSelectBuff=e;let t=e.length;this.checkAll=t===this.__column.length,this.isIndeterminate=t>0&&t<this.__column.length},opened(){const e=this.__column.filter((e=>!this.oldColumns.includes(e.columnUUkey))).map((e=>e.columnUUkey));this.checkboxSelectBuff=this.checkboxSelectBuff.concat(e).sort(((e,t)=>(this.__sortWeight[e]||0)-(this.__sortWeight[t]||0))),this.oldColumns=this.__column.map((e=>e.columnUUkey)),this.checkAll=this.checkboxSelectBuff.length===this.__column.length,this.isIndeterminate=this.checkboxSelectBuff.length>0&&this.checkboxSelectBuff.length<this.__column.length},clsoeSort(e){this.sortColumnList=this.oldColumns=e||[],this.checkboxSelectBuff=this.checkboxSelectBuff.sort(((e,t)=>(this.__sortWeight[e]||0)-(this.__sortWeight[t]||0)))},reset(){this.sortColumnList=[],this.checkboxSelectBuff=this.__column.map((e=>e.columnUUkey))},confirm(){this.checkboxSelect=this.checkboxSelectBuff,this.sortColumnList=this.oldColumns,this.dialogVisible=!1}}},f=m,g=(0,u.A)(f,s,n,!1,null,"25f6eb76",null),y=g.exports,v={name:"table_list",components:{ColumnConfig:y},props:{data:{type:Array,required:!0,default:()=>[]},pagination:{type:Object,default:()=>({pageIndex:1,pageSize:15,total:0,pageSizes:[15,30,50],layout:"jumper, sizes, prev, pager, next,total"})},localPaginate:{type:Boolean,default:!1},needPagination:{type:Boolean,default:!0},columns:{required:!0,type:Array,default:()=>[]},index:{type:Boolean,default:!1},selection:{type:Boolean,default:!1},selectable:{type:Function,default:()=>()=>{}},selectCountLimit:{type:Number,default:1e6},checkedData:{type:Array,default:()=>[]},configAble:{type:[Boolean],default:!0},configIconPos:{default:"",type:String},refreshAble:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1}},computed:{paginationStyle(){return{display:"flex","padding-top":"10px","flex-direction":"row","justify-content":"left"===this.pagination.align?"flex-start":"flex-end"}},filterColumns(){return this.columns.filter((e=>e.hidden&&"function"===typeof e.hidden?!e.hidden():!e.hidden))},showColumn(){let e=this.filterColumns;return this.selectedColumn.length&&(e=this.selectedColumn.map((e=>this.filterColumns.find((t=>t.prop===e||t.slot===e)))).filter((e=>!!e))),e.map((e=>({...e,columnUUkey:e.prop||e.slot})))},showData(){if(!this.data||!this.data.length)return[];if(!this.needPagination)return this.data;const e=Math.max(this.pagination.pageSize*(this.pagination.pageIndex-1),0),t=Math.min(this.data.length,e+this.pagination.pageSize);return this.data.length===this.pagination.total?this.data.slice(e,t):this.data},_checkedData:{get(){return this.checkedData},set(e){this.$emit("update:checkedData",e)}}},data(){return{selectedColumn:[],dialogVisible:!1}},watch:{data:{handler(e,t){this.resetSelect(),this.localPaginate&&(this.pagination.total=this.data&&this.data.length||0)},immediate:!0},filterColumns(){this.selectedColumn=[]}},mounted(){this.resetSelect()},methods:{loadData(){this.$emit("loadData")},reload(){this.pagination.pageIndex=1,this._checkedData=[],this.$emit("loadData")},selectionChange(e,t){if(e&&e.length>this.selectCountLimit){this.$refs.table.clearSelection();for(let t=0;t<this.selectCountLimit;t++)this.$refs.table.toggleRowSelection(e[e.length-t-1],!0)}else this._checkedData=e},resetSelect(){if(this.$refs.table){this.$refs.table.clearSelection();for(let e of this.data)for(let t of this._checkedData)JSON.stringify(e)===JSON.stringify(t)&&this.$refs.table.toggleRowSelection(e,!0)}},handleSizeChange(){this.localPaginate||(this.pagination.pageIndex=1,this.loadData())},handleCurrentChange(){!this.localPaginate&&this.loadData()}}},b=v,_=(0,u.A)(b,a,l,!1,null,"5d4ce1c3",null),k=_.exports},68286:function(e,t,i){i.r(t),i.d(t,{default:function(){return D}});var a=function(){var e=this,t=e._self._c;return t("div",[t("el-card",[e.portShow?t("port-view",{on:{activeClick:e.activeClick}}):e._e()],1)],1)},l=[],s=i(92161),n=(i(12878),function(){var e=this,t=e._self._c;return t("span",[t("el-row",[t("el-col",{attrs:{span:18}},[t("el-select",{attrs:{size:"mini",placeholder:"请选择来源",clearable:""},model:{value:e.fromValue,callback:function(t){e.fromValue=t},expression:"fromValue"}},e._l(this.condData.from,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1),t("el-select",{attrs:{size:"mini",placeholder:"请选择类型",clearable:""},model:{value:e.typeofValue,callback:function(t){e.typeofValue=t},expression:"typeofValue"}},e._l(this.condData.typeof,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1),t("el-input",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"请输入主题"},model:{value:e.subject,callback:function(t){e.subject=t},expression:"subject"}}),t("el-date-picker",{attrs:{"value-format":"timestamp",type:"datetime",placeholder:"选择起始日期时间",size:"mini"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}}),t("el-date-picker",{attrs:{"value-format":"timestamp",type:"datetime",placeholder:"选择结束日期时间",size:"mini"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}}),t("span",{staticStyle:{margin:"10px 0"}},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.getEvent}},[e._v("搜索")])],1),t("span",{staticStyle:{margin:"10px 0"}},[t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.resetSelect}},[e._v("重置")])],1)],1),t("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("span",{staticStyle:{margin:"10px 0"}},[t("el-button",{attrs:{type:"success",size:"mini",plain:""},on:{click:e.getEvent}},[e._v("刷新")])],1),t("span",{staticStyle:{margin:"10px 0"}},[t("el-button",{attrs:{type:"success",size:"mini",plain:""},on:{click:e.allCancel}},[e._v("忽略")])],1),t("el-button-group",[t("el-button",{attrs:{type:"info",size:"mini"},on:{click:e.fileShow}},[e._v("端口视角")]),t("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("事件视角")])],1)],1)],1),t("el-table",{staticClass:"event-tabel",staticStyle:{width:"100%","margin-top":"5px"},attrs:{data:e.eventsData.records,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"}},on:{"expand-change":e.changeTable,"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"45"}}),t("el-table-column",{attrs:{prop:"level",width:"60"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{type:"严重"===i.row.level?"danger":"高危"===i.row.level?"warning":"中危"===i.row.level?"":"info",size:"mini"}},[e._v(e._s(i.row.level))])]}}])}),t("el-table-column",{attrs:{prop:"inet",label:"IP",width:"130"}}),t("el-table-column",{attrs:{prop:"created_at",label:"时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("date")(t.row.created_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),t("el-table-column",{attrs:{prop:"subject",label:"主题"}}),t("el-table-column",{attrs:{prop:"typeof",label:"类型",width:"180"}}),t("el-table-column",{attrs:{prop:"from",label:"来源",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.from_code||"无")+" ")]}}])}),t("el-table-column",{attrs:{prop:"msg",label:"内容"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tooltip",{staticClass:"item",attrs:{placement:"top"}},[t("div",{staticStyle:{"max-width":"300px"},attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(i.row.msg)+" ")]),t("div",{staticClass:"oneLine"},[e._v(e._s(i.row.msg))])])]}}])}),t("el-table-column",{attrs:{prop:"remote_addr",label:"远端地址",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.remote_addr||"无")+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.detailEvernt(i.row)}}},[e._v("详情")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.cancelEvent(i.row.id)}}},[e._v("忽略")])]}}])})],1),t("Page",{attrs:{size:e.pageSize,current:e.currentPage,pageTotal:e.eventsData.total},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),t("el-drawer",{staticClass:"eventDrawer",attrs:{visible:e.detailShow,direction:"rtl",size:"20%"},on:{"update:visible":function(t){e.detailShow=t},close:e.eventsClose}},[t("div",{staticStyle:{padding:"0 20px"}},[t("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:12}},[t("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[e._v("事件详情")])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("主题 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.subject))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("类型 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.typeof))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("来源 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.from_code||"-"))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("时间 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e._f("date")(e.detailEverntData.created_at,"yyyy-MM-dd hh:mm:ss")))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("内容 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.msg))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("报错 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.error||"-"))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("远程地址 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.remote_addr||"-"))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("远程端口 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.remote_addr||"-"))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("地理位置 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.region||"-"))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("认证信息 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.auth||"-"))])])],1),t("el-row",{staticStyle:{"margin-bottom":"14px"}},[t("el-col",{attrs:{span:24}},[e._v("用户信息 "),t("span",{staticClass:"subtitle"},[e._v(e._s(e.detailEverntData.user||"-"))])])],1)],1)])])],1)}),r=[],o={components:{Page:s.A},props:["dayTime"],name:"vuln",data(){return{eventsData:{},pageSizeArray:["10","20","30","40"],currentPage:1,pageSize:15,pageTotal:0,searchData:"",constData:[],timer:null,startTime:"",endTime:"",condData:{},fromValue:"",typeofValue:"",subject:"",allSelection:[],detailShow:!1,detailEverntData:{},value:"",operator:"",field:"",filters:[],accountLoading:!1,accountData:{},selectForm:{name:"",inet:"",msg:[]},msgArray:[{value:"登录成功",label:"登录成功"},{value:"用户注销",label:"用户注销"},{value:"登录失败",label:"登录失败"}],fileDetailShow:!1,fileDetailData:{},fileDetailLoading:!1,vulnDetailShow:!1,vulnDetailData:{},vulnLoading:!1,activeIndex:null,eventLogon:"logon_at"}},created(){this.getEvent(),this.getSelectType()},methods:{getEvent(){this.eventShow=!0,""!==this.startTime&&(this.startTime=new Date(this.startTime).toJSON()),""!==this.endTime&&(this.endTime=new Date(this.endTime).toJSON()),this.$request.fetchGetEents(this.currentPage,this.pageSize,"",this.startTime,this.endTime,this.fromValue,this.typeofValue,this.subject).then((e=>{null!==e.data.records?this.eventsData=e.data:this.eventsData=[]}))},handleSizeChange(e){this.pageSize=e,this.getEvent()},handleCurrentChange(e){this.currentPage=e,this.getEvent()},getSelectType(){this.$request.fetchGetEventCond(this.$store.getters.addNodeData.id).then((e=>{this.condData=e.data}))},resetSelect(){this.startTime="",this.endTime="",this.fromValue="",this.typeofValue="",this.subject="",this.getEvent()},detailEvernt(e){this.detailShow=!0,this.detailEverntData=e},cancelEvent(e){this.$request.fetchReadEents(e).then((e=>{this.$message({message:"已读",type:"success"})})).catch((e=>{this.$message.error(e.data)})),this.getEvent()},changeTable(e,t){-1!==t.indexOf(e)?this.$emit("clearTimer"):this.$emit("openTimer")},handleSelectionChange(e){this.allSelection=e},eventsClose(){this.detailShow=!1,this.detailEverntData={}},fileShow(){this.$emit("activeClick",!0,!1)},allCancel(){this.$request.fetchReadEents(this.allSelection).then((e=>{this.$message({message:"已读",type:"success"})})).catch((e=>{this.$message.error(e.data)})),this.getEvent()}}},c=o,p=i(81656),u=(0,p.A)(c,n,r,!1,null,"65f669d0",null),d=u.exports,h=function(){var e=this,t=e._self._c;return t("span",[t("el-row",[t("el-col",{attrs:{span:14}},[t("select-search",{attrs:{condData:e.condData},on:{searchBasic:e.searchBasic}})],1),t("el-col",{staticStyle:{"text-align":"right"},attrs:{span:10}},[t("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:e.activeImport}},[e._v("导出")]),t("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:e.initPort}},[e._v("刷新")])],1)],1),t("el-table",{staticStyle:{width:"100%","margin-top":"5px"},attrs:{data:e.listenData.records,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"},"cell-style":{padding:"12px 0"}}},[t("el-table-column",{attrs:{prop:"inet",label:"终端IP",width:"120"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.innetactive(i.row)}}},[e._v(e._s(i.row.inet))])]}}])}),t("el-table-column",{attrs:{prop:"protocol",label:"协议",width:"100"}}),t("el-table-column",{attrs:{prop:"local_port",label:"本地端口",width:"100"}}),t("el-table-column",{attrs:{prop:"pid",label:"pid",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[0===i.row.pid?t("span",[e._v(" - ")]):t("span",[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.processDetail(i.row)}}},[e._v(e._s(i.row.pid))])],1)]}}])}),t("el-table-column",{attrs:{prop:"remote_ip",label:"是否对外",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return["127.0.0.1"===i.row.local_ip?t("span",[t("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v(" 不对外")])],1):t("span",[t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(" 对外")])],1)]}}])}),t("el-table-column",{attrs:{prop:"process",label:"进程名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.process)+" ")]}}])}),t("el-table-column",{attrs:{prop:"username",label:"用户名",width:"255"}}),t("el-table-column",{attrs:{prop:"updated_at",label:"更新时间",width:"255"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("date")(t.row.updated_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])})],1),t("Page",{attrs:{size:e.pageSize,current:e.current,pageSizeArray:e.pageSizeArray,pageTotal:e.listenData.total},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),t("el-drawer",{staticClass:"eventDrawer",attrs:{title:e.ipTtitel.inet,visible:e.drawer,direction:e.directions,"before-close":e.drawerClose,size:"90%"},on:{"update:visible":function(t){e.drawer=t}}},[t("node-detail",{ref:"ipDetail",attrs:{minionId:e.ipTtitel.minion_id}})],1),t("processDetail",{ref:"processDetailRef"})],1)},m=[],f=i(1477),g=i(23947),y=i(90177),v={components:{Page:s.A,selectSearch:f.A,NodeDetail:g.A,processDetail:y.A},props:["dayTime"],name:"vuln",data(){return{current:1,pageSize:10,listenData:{},searchNameListen:"",process:"",listen:"",port:"",pidShow:!1,detailProcessShow:!1,processDetailData:{},condData:{},value:"",operator:"",field:"",filters:[],pageSizeArray:["10","20","30","40"],activeIndex:null,ipTtitel:{},drawer:!1,directions:"rtl"}},created(){this.initPort(),this.getCond()},methods:{drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(e){this.ipTtitel=e,this.drawer=!0},activeImport(){this.$message({message:"开发中！！！",type:"warning"})},initPort(){var e={current:this.current,size:this.pageSize,filters:this.filters};this.$request.fetchGetListen(e).then((e=>{this.listenData=e.data,this.listenShow=!0}))},handleSizeChange(e){this.pageSize=e,this.initPort()},handleCurrentChange(e){this.current=e,this.initPort()},processDetail(e){this.$refs.processDetailRef.openProcessDetial(e.minion_id,e.pid)},processCancel(){this.processDetailData={},this.processShow=!1},getCond(){this.$request.fetchListentCond().then((e=>{this.condData=e.data}))},searchBasic(e){this.current=1,this.filters=e,this.initPort()},delTag(e,t){this.filters.splice(t,1)},editTag(e,t){this.activeIndex=t,this.field=e.field,this.value=e.value,this.operator=e.operator},eventShow(){this.$emit("activeClick",!1,!0)}}},b=v,_=(0,p.A)(b,h,m,!1,null,"616263e2",null),k=_.exports,x={components:{Page:s.A,eventView:d,portView:k},name:"index",data(){return{eventShow:!1,portShow:!0}},methods:{activeClick(e,t){this.portShow=e,this.eventShow=t},getDay(e){this.dayTime=e}}},S=x,w=(0,p.A)(S,a,l,!1,null,"741386c3",null),D=w.exports},12878:function(e,t,i){var a=i(85471);a["default"].filter("date",(function(e,t){var i=new Date(e),a={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var l in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp(`(${l})`).test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[l]:("00"+a[l]).substr((""+a[l]).length)));return t}))}}]);