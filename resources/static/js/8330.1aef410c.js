"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[8330],{84241:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t._self._c;return t.condData?e("div",[t.multiCondition?e("el-row",{staticStyle:{"margin-bottom":"5px"}},[e("el-col",{attrs:{span:24}},t._l(t.filters,(function(a,i){return e("span",{key:i,staticStyle:{"margin-right":"5px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff",display:"inline-block"}},[t._v(" "+t._s(a.keyDesc)+" "+t._s(a.operatorDesc)+" "+t._s(a.value)+" "),e("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.editTag(a,i)}}}),e("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delTag(a,i)}}})])})),0)],1):t._e(),e("div",{class:"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?"dom":"doms"},[t._l(t.selectArray,(function(a,i){return e("span",{key:i},["蜜罐"!==t.nameIndex?e("el-dropdown",{staticStyle:{"margin-right":"5px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v(" "+t._s(a.placeholder)),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(a.dataArray,(function(i){return e("el-dropdown-item",{key:i.key,attrs:{value:i.key},nativeOn:{click:function(e){return t.selectActive(i,a)}}},[t._v(t._s(i.desc))])})),1)],1):t._e()],1)})),"事件展示"===t.nameIndex?e("span",[e("el-dropdown",{staticStyle:{"margin-right":"5px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v(" 时间搜索"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.eventTime,(function(a){return e("el-dropdown-item",{key:a.value,attrs:{value:a.value},nativeOn:{click:function(e){return t.eventTimeChange(a)}}},[t._v(t._s(a.label))])})),1)],1)],1):t._e(),"事件详情"===t.nameIndex?e("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.oneClear}},[t._v("一键清除")]):t._e(),"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?e("el-button",{staticStyle:{"margin-right":"7px"},attrs:{type:"success",size:"mini"},on:{click:t.refresh}},[t._v("刷新")]):t._e(),e("el-select",{staticStyle:{width:"150px","margin-right":"7px"},attrs:{size:"mini","value-key":"key"},on:{change:t.selectField},model:{value:t.key,callback:function(e){t.key=e},expression:"key"}},[t._l(t.condData.conditions,(function(a,i){return[a.key!==t.eventLogon?e("el-option",{key:i,attrs:{value:a.key,label:a.desc}}):t._e()]}))],2),e("el-select",{staticStyle:{width:"100px","margin-right":"7px"},attrs:{size:"mini","value-key":"key"},on:{change:t.selectOperator},model:{value:t.operator,callback:function(e){t.operator=e},expression:"operator"}},t._l(t.selectFieldDerive.operatorArray,(function(t,a){return e("el-option",{key:a,attrs:{value:t.key,label:t.desc}})})),1),["datetime","time"].includes(t.selectFieldDerive.typeConditions)?e("span",{staticStyle:{display:"inline-block","margin-right":"7px"}},[e("el-date-picker",{attrs:{clearable:"",type:"datetime",pickerOptions:t.pickerOptions,placeholder:"选择时间",size:"mini"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1):e("span",{staticStyle:{display:"inline-block","margin-right":"7px"}},[t.selectFieldDerive.selectType?e("el-select",{staticStyle:{width:"180px"},attrs:{size:"mini",clearable:"","value-key":"key",multiple:"in"===t.operator||"notin"===t.operator,"collapse-tags":""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.selectFieldDerive.valueArray,(function(t,a){return e("el-option",{key:a,attrs:{value:t.key,label:t.desc}})})),1):e("span",{staticStyle:{position:"relative",display:"inline-block"}},[e("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",clearable:""},on:{focus:function(e){t.suggestVisible=!0}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1),e("el-button",{class:"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?"buttons":"buttonsearch",attrs:{icon:"el-icon-search",size:"mini"},on:{click:()=>{t.suggestVisible=!1,t.searchCond()}}},[t._v(t._s(t.titleH)+" ")])],2)],1):t._e()},s=[],l={name:"index",props:{titleH:{type:String,default:function(){return""}},condData:{type:Object,default:function(){return{}}},defaultData:{type:Object,default:function(){return{}}},eventLogon:{type:String,default:function(){return""}},nameIndex:{type:String,default:function(){return""}},selectArray:{type:Array,default:function(){return[]}},multiCondition:{default:!0},inputSuggestOptions:{type:Object}},computed:{selectFieldDerive(){var t=this.condData?.conditions?.findIndex((t=>t.key===this.key));return{operatorArray:this.condData?.conditions?.[t]?.operators||[],selectType:this.condData?.conditions?.[t]?.enum,valueArray:this.condData?.conditions?.[t]?.enums||[],typeConditions:this.condData?.conditions?.[t]?.type}},suggestOption(){return this.inputSuggestOptions&&this.inputSuggestOptions[this.key]||[]}},data(){return{operator:"",value:null,key:"",filters:[],current:1,pageSize:15,suggestVisible:!1,eventTime:[{value:"900",label:"十五分钟"},{value:"3600",label:"一小时"},{value:"86400",label:"一天"},{value:"604800",label:"一周"},{value:"2592000",label:"一个月"}],pickerOptions:{disabledDate(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(t){t.$emit("pick",new Date)}},{text:"昨天",onClick(t){const e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick(t){const e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}},{text:"三十天前",onClick(t){const e=new Date;e.setTime(e.getTime()-2592e6),t.$emit("pick",e)}}]}}},created(){const t=this.filters.push.bind(this.filters);this.filters.push=(...e)=>{for(let a of e){const e=this.filters.find((t=>t.key===a.key));e?Object.assign(e,a):(!this.multiCondition&&this.filters.length>0&&(this.filters.length=0),t(a))}},"彻底删除"===this.nameIndex?(this.filters.push(this.getSelectItem("status","eq","4")),this.$emit("searchBasic",this.filters)):(this.key=this.defaultData?.key||null,this.operator=this.defaultData?.operator||null)},methods:{refresh(){this.$emit("refresh")},oneClear(){this.$emit("oneClear")},selectField(t){this.value=void 0,this.$nextTick((()=>{this.operator=this.selectFieldDerive.operatorArray.some((t=>"like"===t.key))?"like":this.selectFieldDerive.operatorArray?.[0].key}))},selectOperator(t){this.operatorValue=t.key,this.value=null},eventTimeChange(t){this.filters.length=0,this.filters.push(this.getSelectItem("created_at","lt",new Date)),this.filters.push(this.getSelectItem("created_at","gt",new Date(new Date-24e3*t.value))),this.$emit("searchBasic",this.filters)},selectActive(t,e){this.filters.push(this.getSelectItem(e.name,"eq",t.key)),this.$emit("searchBasic",this.filters)},delTag(t,e){("蜜罐"!==this.nameIndex&&"事件详情"!==this.nameIndex&&"风险详情"!==this.nameIndex||0!==e)&&(this.filters.splice(e,1),this.$emit("searchBasic",this.filters))},editTag(t,e){("蜜罐"!==this.nameIndex&&"事件详情"!==this.nameIndex&&"风险详情"!==this.nameIndex||0!==e)&&(this.key=t.key,this.value=t.value,this.operator=t.operator)},getSelectItem(t,e,a){return{key:t,keyDesc:this.condData?.conditions?.find((e=>e.key===t))?.desc,value:a,operator:e,operatorDesc:this.selectFieldDerive.operatorArray.find((t=>t.key===e))?.desc}},searchCond(){if(""!==this.key&&void 0!==this.value&&void 0!==this.operator&&null!==this.value&&""!==this.value){const t=this.getSelectItem(this.key,this.operator,this.value);this.filters.push(t)}if(!this.value&&this.key){const t=this.filters.find((t=>t.key===this.key));-1!==t&&this.filters.splice(t,1)}this.$emit("searchBasic",this.filters)},setOption(t,e,a){this.key=t,this.operator=e,this.value=a,this.searchCond()}},watch:{nameIndex:function(t,e){"彻底删除"===t&&t!==e&&(this.filters.push(this.getSelectItem("status","eq","4")),this.$emit("searchBasic",this.filters))}}},n=l,o=a(1001),r=(0,o.Z)(n,i,s,!1,null,"1e98ace1",null),c=r.exports},62476:function(t,e,a){a.d(e,{Z:function(){return b}});var i=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"100%"}},[e("div",{staticClass:"tableHead"},[e("div",{staticStyle:{flex:"1","margin-right":"5px"}},[t._t("right_top_btn")],2),e("span",{staticClass:"icon"},[t.refreshAble?e("i",{staticClass:"el-icon-refresh",attrs:{title:"重加载数据"},on:{click:t.loadData}}):t._e(),t.configAble&&"inhead"!==t.configIconPos?e("i",{class:{"el-icon-setting":!0},attrs:{title:"编辑表格"},on:{click:function(e){t.dialogVisible=!0}}}):t._e()])]),e("div",{staticStyle:{position:"relative"}},[t.configAble&&"inhead"===t.configIconPos?e("i",{staticClass:"el-icon-setting iconInHead",attrs:{title:"编辑表格"},on:{click:function(e){t.dialogVisible=!0}}}):t._e()]),e("el-table",t._g(t._b({ref:"table",staticStyle:{width:"100%"},attrs:{"header-cell-style":t.$attrs["header-cell-style"]||{color:"#909399",textAlign:"center",background:"#f5f7fa"},data:t.showData,stripe:t.stripe},on:{"selection-change":t.selectionChange}},"el-table",t.$attrs,!1),t.$listeners),[t.selection?e("el-table-column",{attrs:{selectable:t.selectable,type:"selection"}}):t._e(),t.index?e("el-table-column",{attrs:{type:"index",label:"序号",align:"center",fixed:"left"}}):t._e(),t._l(t.showColumn,(function(a,i){return[e("el-table-column",{key:i,attrs:{prop:a&&a.prop,label:a&&a.label,width:a&&a.width,"min-width":a&&a["min-width"],fixed:a&&a.fixed,formatter:a&&a.formatter,"show-overflow-tooltip":a&&a["show-overflow-tooltip"]||!1,sortable:a&&a.sortable,"sort-method":a&&a["sort-method"],"sort-by":a&&a["sort-by"],align:a&&a.align||"center","sort-orders":a&&a["sort-orders"],type:a&&a.type,"class-name":a&&a["class-name"]},scopedSlots:t._u([a&&a.slotHeader?{key:"header",fn:function(e){return[t._t(a&&a.slotHeader,null,{row:e.row,col:a,$index:e.$index})]}}:null,a&&a.slot?{key:"default",fn:function(e){return[t._t(a&&a.slot,null,{row:e.row,col:a,$index:e.$index})]}}:null],null,!0)})]}))],2),t.needPagination?e("div",{style:t.paginationStyle},[e("el-pagination",{attrs:{"current-page":t.pagination.pageIndex,"page-sizes":t.pagination.pageSizes||[15,30,50],"page-size":t.pagination.pageSize,layout:t.pagination.layout||"jumper, sizes, prev, pager, next,total",total:t.pagination.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pagination,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.pagination,"pageIndex",e)},"update:pageSize":function(e){return t.$set(t.pagination,"pageSize",e)},"update:page-size":function(e){return t.$set(t.pagination,"pageSize",e)}}})],1):t._e(),e("ColumnConfig",{attrs:{columns:t.filterColumns,visible:t.dialogVisible,selectColumn:t.selectedColumn},on:{"update:visible":function(e){t.dialogVisible=e},"update:selectColumn":function(e){t.selectedColumn=e},"update:select-column":function(e){t.selectedColumn=e}}})],1)},s=[],l=function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:"设置需展示的列",visible:t.dialogVisible,width:"800px","append-to-body":""},on:{open:function(e){return t.opened()},"update:visible":function(e){t.dialogVisible=e}}},[e("div",[e("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")]),e("el-button",{staticStyle:{"text-decoration":"underline",color:"red"},attrs:{type:"text"},on:{click:function(e){return t.$refs.SortColumn.open()}}},[t._v("手动排序")]),e("el-button",{staticStyle:{"text-decoration":"underline",color:"red"},attrs:{type:"text"},on:{click:t.reset}},[t._v("重置配置")]),e("div",{staticStyle:{margin:"15px 0"}}),e("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.checkboxSelectBuff,callback:function(e){t.checkboxSelectBuff=e},expression:"checkboxSelectBuff"}},t._l(t.__column,(function(a){return e("el-col",{key:a.columnUUkey,staticClass:"colCheckbox",attrs:{span:8}},[e("el-checkbox",{attrs:{title:a.label,label:a.columnUUkey}},[t._v(t._s(a.label)+" ")])],1)})),1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)]),e("SortColumn",{ref:"SortColumn",attrs:{column:t.__column},on:{close:t.clsoeSort}})],1)},n=[],o=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"拖动节点进行排序",visible:t.dialogVisible,width:"500px","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-tree",{attrs:{data:t.data,"node-key":"columnUUkey","default-expand-all":"",draggable:"","allow-drop":t.allowDrog}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.close}},[t._v("确 定")])],1)],1)},r=[],c={props:{column:{type:Array,require:!0}},data(){return{data:[],dialogVisible:!1}},created(){},methods:{open(){this.dialogVisible=!0,this.data=this.column.map((t=>({columnUUkey:t.columnUUkey,label:t.label})))},close(){this.dialogVisible=!1,this.$emit("close",this.data.map((t=>t.columnUUkey)))},allowDrog(t,e,a){return"inner"!==a}}},d=c,h=a(1001),u=(0,h.Z)(d,o,r,!1,null,null,null),p=u.exports,m={props:{columns:{type:Array,default:()=>[]},visible:{type:Boolean,require:!0,default:!1},selectColumn:{type:Array,default:()=>[]}},components:{SortColumn:p},computed:{dialogVisible:{get(){return this.visible},set(t){this.$emit("update:visible",t)}},checkboxSelect:{get(){return this.selectColumn},set(t){this.$emit("update:selectColumn",t)}},__column(){return this.columns.map((t=>({label:t.label,columnUUkey:t.prop||t.slot}))).sort(((t,e)=>(this.__sortWeight[t.columnUUkey]||0)-(this.__sortWeight[e.columnUUkey]||0)))},__sortWeight(){const t={};for(let e=0;e<this.sortColumnList.length;e++)t[this.sortColumnList[e]]=e;return t}},data(){return{sortColumnList:[],checkAll:!1,isIndeterminate:!1,checkboxSelectBuff:[],oldColumns:[]}},methods:{handleCheckAllChange(t){this.checkboxSelectBuff=t?this.__column.map((t=>t.columnUUkey)):[],this.isIndeterminate=!1},handleCheckedCitiesChange(t){this.checkboxSelectBuff=t;let e=t.length;this.checkAll=e===this.__column.length,this.isIndeterminate=e>0&&e<this.__column.length},opened(){const t=this.__column.filter((t=>!this.oldColumns.includes(t.columnUUkey))).map((t=>t.columnUUkey));this.checkboxSelectBuff=this.checkboxSelectBuff.concat(t).sort(((t,e)=>(this.__sortWeight[t]||0)-(this.__sortWeight[e]||0))),this.oldColumns=this.__column.map((t=>t.columnUUkey)),this.checkAll=this.checkboxSelectBuff.length===this.__column.length,this.isIndeterminate=this.checkboxSelectBuff.length>0&&this.checkboxSelectBuff.length<this.__column.length},clsoeSort(t){this.sortColumnList=this.oldColumns=t||[],this.checkboxSelectBuff=this.checkboxSelectBuff.sort(((t,e)=>(this.__sortWeight[t]||0)-(this.__sortWeight[e]||0)))},reset(){this.sortColumnList=[],this.checkboxSelectBuff=this.__column.map((t=>t.columnUUkey))},confirm(){this.checkboxSelect=this.checkboxSelectBuff,this.sortColumnList=this.oldColumns,this.dialogVisible=!1}}},f=m,v=(0,h.Z)(f,l,n,!1,null,"25f6eb76",null),g=v.exports,y={name:"table_list",components:{ColumnConfig:g},props:{data:{type:Array,required:!0,default:()=>[]},pagination:{type:Object,default:()=>({pageIndex:1,pageSize:15,total:0,pageSizes:[15,30,50],layout:"jumper, sizes, prev, pager, next,total"})},localPaginate:{type:Boolean,default:!1},needPagination:{type:Boolean,default:!0},columns:{required:!0,type:Array,default:()=>[]},index:{type:Boolean,default:!1},selection:{type:Boolean,default:!1},selectable:{type:Function,default:()=>()=>{}},selectCountLimit:{type:Number,default:1e6},checkedData:{type:Array,default:()=>[]},configAble:{type:[Boolean],default:!0},configIconPos:{default:"",type:String},refreshAble:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1}},computed:{paginationStyle(){return{display:"flex","padding-top":"10px","flex-direction":"row","justify-content":"left"===this.pagination.align?"flex-start":"flex-end"}},filterColumns(){return this.columns.filter((t=>t.hidden&&"function"===typeof t.hidden?!t.hidden():!t.hidden))},showColumn(){let t=this.filterColumns;return this.selectedColumn.length&&(t=this.selectedColumn.map((t=>this.filterColumns.find((e=>e.prop===t||e.slot===t)))).filter((t=>!!t))),t.map((t=>({...t,columnUUkey:t.prop||t.slot})))},showData(){if(!this.data||!this.data.length)return[];if(!this.needPagination)return this.data;const t=Math.max(this.pagination.pageSize*(this.pagination.pageIndex-1),0),e=Math.min(this.data.length,t+this.pagination.pageSize);return this.data.length===this.pagination.total?this.data.slice(t,e):this.data},_checkedData:{get(){return this.checkedData},set(t){this.$emit("update:checkedData",t)}}},data(){return{selectedColumn:[],dialogVisible:!1}},watch:{data:{handler(t,e){this.resetSelect(),this.localPaginate&&(this.pagination.total=this.data&&this.data.length||0)},immediate:!0},filterColumns(){this.selectedColumn=[]}},mounted(){this.resetSelect()},methods:{loadData(){this.$emit("loadData")},reload(){this.pagination.pageIndex=1,this._checkedData=[],this.$emit("loadData")},selectionChange(t,e){if(t&&t.length>this.selectCountLimit){this.$refs.table.clearSelection();for(let e=0;e<this.selectCountLimit;e++)this.$refs.table.toggleRowSelection(t[t.length-e-1],!0)}else this._checkedData=t},resetSelect(){if(this.$refs.table){this.$refs.table.clearSelection();for(let t of this.data)for(let e of this._checkedData)JSON.stringify(t)===JSON.stringify(e)&&this.$refs.table.toggleRowSelection(t,!0)}},handleSizeChange(){this.localPaginate||(this.pagination.pageIndex=1,this.loadData())},handleCurrentChange(){!this.localPaginate&&this.loadData()}}},_=y,k=(0,h.Z)(_,i,s,!1,null,"6202e7cb",null),b=k.exports},20039:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",[4===t.cvssScore||"紧急"===t.cvssScore?e("div",{staticStyle:{height:"24px",margin:"0 auto"}},[e("div",{staticClass:"severity-critical-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(0)]):t._e(),3===t.cvssScore||"高危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-high-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(1)]):t._e(),2===t.cvssScore||"中危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-medium-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(2)]):t._e(),1===t.cvssScore||"低危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-low-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(3)]):t._e(),0===t.cvssScore||"无风险"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-no-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(4)]):t._e()])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("紧急")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("高危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("中危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("低危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("无风险")])])])}],l={name:"CvssScore",props:["cvssScore"]},n=l,o=a(1001),r=(0,o.Z)(n,i,s,!1,null,"77d4d761",null),c=r.exports},52914:function(t,e,a){a.d(e,{Z:function(){return m}});var i=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"padding-bottom":"5px"}},[e("el-row",{staticStyle:{"margin-bottom":"10px"}},[e("el-col",{attrs:{span:6}},[e("el-button-group",[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("事件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.taskShow}},[t._v("终端")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.riskShow}},[t._v("风险")])],1)],1),e("el-col",{attrs:{span:18}},[e("select-search",{staticStyle:{float:"right","text-align":"right"},attrs:{condData:t.condData,defaultData:t.dataTask,multiCondition:!1,nameIndex:"事件详情"},on:{searchBasic:t.searchBasic,oneClear:t.oneClear,refresh:t.refresh}})],1)],1),e("tableList",{attrs:{data:t.eventsData.records,columns:t.columns,configIconPos:"inhead",pagination:t.pagination,"cell-style":{padding:"0px",background:"#303133",color:"#86909c"},"header-cell-style":{background:"#303133",color:"#f2f6fca8",fontWeight:"600",fontSize:"12px"}},on:{loadData:t.getEventData},scopedSlots:t._u([{key:"level",fn:function(t){return[e("span",{staticClass:"circle_content"},[e("span",{class:"严重"===t.row.level?"critical":"高危"===t.row.level?"high":"中危"===t.row.level?"medium":"low"})])]}},{key:"operate",fn:function(a){return[e("el-button",{staticStyle:{color:"#4175b3"},attrs:{size:"mini",type:"text"},on:{click:function(e){return t.detailEvent(a.row)}}},[t._v("详情")]),e("el-button",{staticStyle:{color:"#4175b3"},attrs:{size:"mini",type:"text"},on:{click:function(e){return t.cancelEvent(a.row.id)}}},[t._v("忽略")])]}}])}),e("el-drawer",{staticClass:"eventDrawer",attrs:{title:"事件详情",visible:t.eventDetailShow,direction:"rtl",size:"35%","append-to-body":!0},on:{"update:visible":function(e){t.eventDetailShow=e},close:t.eventDetailCancel}},[e("div",{staticStyle:{padding:"0 20px"}},[e("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("主题"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.eventDetailData.subject||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("类型"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.eventDetailData.typeof||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("来源"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.eventDetailData.from_code||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("时间"),e("span",{staticClass:"subtitle"},[t._v(t._s(t._f("date")(t.eventDetailData.created_at,"yyyy-MM-dd hh:mm:ss")))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("远程地址"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.eventDetailData.remote_addr||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("远程端口"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.eventDetailData.remote_port||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("地理位置"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.eventDetailData.region||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("认证信息"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.eventDetailData.auth||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("用户信息"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.eventDetailData.user||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[e("span",{staticStyle:{float:"left"}},[t._v("内容：")]),e("span",{staticClass:"subtitle",staticStyle:{float:"left"}},[e("pre",{staticStyle:{"font-family":"none","white-space":"pre-wrap","word-break":"break-all"}},[t._v(t._s(t.eventDetailData.msg||"-"))])])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[e("span",{staticStyle:{float:"left"}},[t._v("报错：")]),e("span",{staticClass:"subtitle",staticStyle:{float:"left"}},[e("pre",{staticStyle:{"font-family":"none","white-space":"pre-wrap","word-break":"break-all"}},[t._v(t._s(t.eventDetailData.error||"-"))])])])],1)],1)])]),e("el-dialog",{attrs:{title:"批量删除",visible:t.delshow,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.delshow=e}}},[e("span",[t._v("共计: "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(0===t.filters.length?0:t.pageTotal))]),t._v(" 是否删除？")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.handleClose=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.delSubmit}},[t._v("确 定")])],1)])],1)},s=[],l=a(12037),n=(a(28451),a(84241)),o=a(62476),r=a(30381),c=a.n(r),d={components:{Page:l.Z,selectSearch:n.Z,tableList:o.Z},props:["dataTask"],name:"index",data(){return{columns:[{label:"",slot:"level",width:"20"},{label:"IP",prop:"inet",width:"120p"},{label:"时间",prop:"time",width:"150",formatter(t){return c()(t.created_at).format("YYYY-MM-DD HH:mm:ss")}},{label:"主题",prop:"subject","show-overflow-tooltip":!0,width:"100"},{label:"类型",prop:"typeof",width:"100"},{label:"来源",prop:"from_code",width:"150"},{label:"内容",prop:"msg","show-overflow-tooltip":!0},{label:"远端地址",width:"150",prop:"remote_addr"},{label:"操作",width:"100",slot:"operate"}],delshow:!1,current:1,pageSize:13,pageTotal:0,pagination:{pageIndex:1,pageSize:15,total:0,pageSizes:[15,30,50],layout:"jumper, sizes, prev, pager, next,total"},searchData:"",constData:[],timer:null,startTime:"",endTime:"",condData:{},fromValue:"",typeofValue:"",subject:"",eventsData:[],eventDetailShow:!1,eventDetailData:{},filters:[],nameShow:"事件详情"}},created(){this.getSelectType(),this.getCond(),this.getEventData()},watch:{dataTask:function(){this.filters=[],this.getEventData()}},methods:{taskShow(){this.$emit("activeClick",!1,!0,!1)},riskShow(){this.$emit("activeClick",!1,!1,!0)},getCond(){this.$request.fetchEventCond().then((t=>{this.condData=t.data}))},handleClose(){this.delshow=!1},delSubmit(){var t=this,e={filters:this.filters};this.$request.fetchDeleteEvent(e).then((e=>{t.$message({message:"删除成功!!!",type:"success"}),t.delshow=!1,t.getEventData()})).catch((t=>{this.$message.error(t.data)}))},searchBasic(t){this.filters=t,this.current=1,this.getEventData()},getSelectType(){this.$request.fetchGetEventCond("").then((t=>{this.condData=t.data}))},getEventData(){var t={current:this.pagination.pageIndex,size:this.pagination.pageSize,filters:[{key:"from_code",operator:"eq",value:this.dataTask.name},...this.dataTask.minion_id?[{key:"minion_id",operator:"eq",value:this.dataTask.minion_id}]:[],...this.filters||[]]};this.$request.fetchGetEents(t).then((t=>{null!==t.data.records?this.eventsData=t.data:this.eventsData=[],this.pagination.total=t.data.total}))},oneClear(){var t={filters:[{key:"from_code",operator:"eq",value:this.dataTask.name},...this.dataTask.minion_id?[{key:"minion_id",operator:"eq",value:this.dataTask.minion_id}]:[],...this.filters||[]]};this.$request.fetchDeleteEvent(t).then((t=>{this.$message({message:"清除成功!!!",type:"success"}),this.getEventData()})).catch((t=>{this.$message.error(t.data)}))},refresh(){this.getEventData(),this.$message({message:"已刷新",type:"success"})},nullChange(t){return""!==t?t:"无"},async cancelEvent(t){try{await this.$request.fetchReadEents(t),this.$message({message:"已读",type:"success"}),this.getEventData()}catch(e){this.$message.error(e||"操作出错")}},detailEvent(t){this.eventDetailShow=!0,this.eventDetailData=t},eventDetailCancel(){this.eventDetailShow=!1,this.eventDetailData={}}}},h=d,u=a(1001),p=(0,u.Z)(h,i,s,!1,null,"9e765204",null),m=p.exports},68330:function(t,e,a){a.r(e),a.d(e,{default:function(){return B}});var i=function(){var t=this,e=t._self._c;return e("div",[t.evnetShow?e("Event",{attrs:{dataTask:t.dataTask},on:{activeClick:t.activeClick}}):t._e(),t.taskShow?e("Task",{attrs:{dataTasks:t.dataTask},on:{activeClick:t.activeClick}}):t._e(),t.riskShow?e("Risk",{attrs:{dataTasks:t.dataTask},on:{activeClick:t.activeClick}}):t._e()],1)},s=[],l=a(52914),n=function(){var t=this,e=t._self._c;return e("div",[e("el-row",[e("el-col",{attrs:{span:5,clas:"namdf"}},[e("el-button-group",[e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.eventShow}},[t._v("事件")]),e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("终端")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.riskShow}},[t._v("风险")])],1)],1),e("el-col",{attrs:{span:19}},[e("select-search",{ref:"select",staticStyle:{"text-align":"right"},attrs:{condData:t.condData,defaultData:t.dataTasks,multiCondition:!1,nameIndex:"任务详情"},on:{searchBasic:t.searchBasic,refresh:t.refresh}})],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{data:t.initData.records,"cell-style":{padding:"0px",background:"#303133",color:"#86909c"},"header-cell-style":{background:"#303133",color:"#f2f6fca8",fontWeight:"600",fontSize:"14px"}}},[e("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(a){return["console"===a.row.from?e("span",[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"scope.row.error",placement:"bottom"}},[a.row.status?e("span",[e("span",{staticClass:"circle_content"},[e("span",{class:"running"===a.row.status?"running":"error"===a.row.status?"error":"other"})]),t._v(" "+t._s(a.row.status)+" ")]):e("span",[t._v("未知 ")])])],1):e("span",[a.row.status?e("span",[e("span",{staticClass:"circle_content"},[e("span",{class:"running"===a.row.status?"running":"error"===a.row.status?"error":"other"})]),t._v(" "+t._s(a.row.status)+" ")]):e("span",[t._v("未知 ")])])]}}])}),e("el-table-column",{attrs:{prop:"inet",label:"终端IP",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.inet)+" ")]}}])}),e("el-table-column",{attrs:{prop:"name",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.report_hash!==a.row.hash?e("span",{staticStyle:{color:"red"}},[t._v(" "+t._s(a.row.name)+" "),e("el-tooltip",{attrs:{effect:"dark",content:"下发的配置与数据库中的配置校验不一致",placement:"right"}},[e("i",{staticClass:"fa fa-exclamation-circle"})])],1):e("span",[t._v(" "+t._s(a.row.name)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"from",label:"来源"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.from?e("span",[t._v(t._s(a.row.from))]):e("span",[t._v("未知")])]}}])}),e("el-table-column",{attrs:{prop:"dialect",label:"属性"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(!0===e.row.dialect?"私有":"公有")+" ")]}}])}),e("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("date")(e.row.created_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),e("el-table-column",{attrs:{label:"操作",align:"right",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return["console"!==a.row.from?e("span",[e("el-button",{staticStyle:{color:"#4175b3"},attrs:{size:"mini",type:"text"},on:{click:function(e){return t.handleEvent(a.row)}}},[t._v("详情")])],1):t._e()]}}])})],1),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.initData.total,nameShow:t.nameShow},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("Event",{ref:"eventDetailRef"})],1)},o=[],r=function(){var t=this,e=t._self._c;return e("el-drawer",{attrs:{title:"事件详情",visible:t.drawerShow,direction:t.direction,size:"40%","append-to-body":!0},on:{"update:visible":function(e){t.drawerShow=e}}},[e("div",{staticStyle:{padding:"0 20px"}},[t.eventsData?e("span",[t.isJSON?e("jsonView",{attrs:{data:t.eventsData,deep:2}}):e("pre",[t._v(t._s(t.eventsData))])],1):e("span",[e("el-empty",{attrs:{description:"暂无数据"}})],1)])])},c=[],d=a(67223),h={components:{jsonView:d.Z},data(){return{direction:"rtl",eventsData:null,drawerShow:!1,isJSON:!1}},methods:{openDialog(t){this.eventsData=t,this.drawerShow=!0,this.isJSON=t&&("object"===typeof t||Array.isArray(t))}}},u=h,p=a(1001),m=(0,p.Z)(u,r,c,!1,null,null,null),f=m.exports,v=a(12037),g=a(84241),y=(a(28451),{components:{Page:v.Z,selectSearch:g.Z,Event:f},name:"taskDetail",props:["dataTasks"],data(){return{drawerEvent:!1,eventDetailShow:!1,tableLoading:!1,topEchartShow:!1,initData:{},currentPage:1,pageSize:15,delLoading:!1,ipTtitel:{},drawer:!1,directions:"rtl",dataTask:{},processShow:!1,processDetailData:{},searchName:"",condData:{},startTime:null,endTime:null,value:"",operator:"",field:"",filters:[],activeIndex:null,nameShow:"事件详情"}},created(){this.getCond(),this.init()},methods:{eventShow(){this.$emit("activeClick",!0,!1,!1)},riskShow(){this.$emit("activeClick",!1,!1,!0)},closeEvent(t){this.drawerEvent=t},attackShow(){this.$emit("activeClick",!0,!1)},echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow")},getCond(){this.$request.fetchTaskCond().then((t=>{this.condData=t.data}))},searchBasic(t){this.currentPage=1,this.filters=t,this.init()},async init(){try{this.tableLoading=!0;var t={current:this.currentPage,size:this.pageSize,filters:[{key:"minion_task.name",operator:"eq",value:this.dataTasks.name},...this.dataTasks.minion_id?[{key:"minion_task.minion_id",operator:"eq",value:this.dataTasks.minion_id}]:[],...this.filters||[]]};const{data:e}=await this.$request.fetchGetTask(t);this.initData=e}catch(e){this.$message.error(e||"查询出错")}finally{this.tableLoading=!1}},handleSizeChange(t){this.pageSize=t,this.init()},handleCurrentChange(t){this.currentPage=t,this.init()},reloadService(t){var e={id:t.minion_id,substance_id:t.substance_id,dialect:t.dialect};this.$request.fetchPatchReload(e).then((t=>{this.$message.success("重启成功！！")})).catch((t=>{this.$message.error(t.data)}))},handleEvent(t){this.$refs.eventDetailRef.openDialog(t)},handleEdit(t){const e=this.$refs.formAdd;this.$request.fetchdetailDialect(t.minion_id,t.substance_id).then((i=>{let s=a(19575).Base64;e.serverData=i.data,e.dataTask=t,i.data.chunk?e.dialogValue=s.decode(i.data.chunk):e.dialogValue=s.decode(" "),e.form={id:i.data.id,icon:i.data.icon,chunk:i.data.chunk,version:i.data.version},e.codeName=i.data.name,e.linkArray=i.data.links,e.dialogVisible=!0})).catch((t=>{this.$message.error(t.data)}))},delCode(t){this.$refs[t].doClose();var e=this;e.delLoading=!0,this.$request.fetchDeleteCodeEdit(t).then((()=>{e.$message({message:"删除成功!!!",type:"success"}),e.delLoading=!1,e.init()})).catch((t=>{e.delLoading=!1,this.$message.error(t.data)}))},getNode(){this.init()},refresh(){this.init(),this.$message({message:"已刷新",type:"success"})}}}),_=y,k=(0,p.Z)(_,n,o,!1,null,"3c00ff74",null),b=k.exports,S=function(){var t=this,e=t._self._c;return e("div",[e("el-row",[e("el-row",{staticStyle:{"margin-bottom":"10px"}},[e("el-col",{attrs:{span:6}},[e("el-button-group",{staticClass:"primary"},[e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.eventShow}},[t._v("事件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.taskShow}},[t._v("终端")]),e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("风险")])],1)],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[e("select-search",{attrs:{condData:t.condData,nameIndex:"风险详情",multiCondition:!1,defaultData:t.dataTasks},on:{searchBasic:t.searchBasic,refresh:t.refresh}})],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:t.riskData,"cell-style":{padding:"0px",background:"#303133",color:"#86909c"},"header-cell-style":{background:"#303133",color:"#f2f6fca8",fontWeight:"600",fontSize:"14px"},stripe:"",align:"center"}},[t._l(t.activeUsers,(function(a,i){return e("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",label:a.lable,prop:a.key,width:a.width},scopedSlots:t._u([{key:"default",fn:function(i){return["inet"===a.key?e("span",[t._v(" "+t._s(i.row.inet)+" ")]):"level"===a.key?e("span",[e("CvssScore",{attrs:{cvssScore:i.row.level}})],1):"region"===a.key?e("span",[t._v(" "+t._s(i.row.region||"0|0|0|未知|未知")+" ")]):"remote_ip"===a.key?e("span",[t._v(" "+t._s(i.row.remote_ip||"未知")+" ")]):"send_alert"===a.key?e("span",[t._v(" "+t._s(!0===i.row[a.key]?"是":"否")+" ")]):"occur_at"===a.key?e("span",[t._v(" "+t._s(t._f("date")(i.row.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]):"payload"===a.key||"reference"===a.key?e("pre",[t._v(t._s(i.row.payload))]):e("span",[t._v(" "+t._s(i.row[a.key])+" ")])]}}],null,!0)})})),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.riskDetailCilck(a.row)}}},[t._v("详情")])]}},{key:"header",fn:function(a){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t._l(t.tableHeader,(function(a,i){return e("div",{key:i},[e("el-checkbox",{attrs:{label:a.title},model:{value:t.colOptions,callback:function(e){t.colOptions=e},expression:"colOptions"}})],1)})),e("div",{attrs:{slot:"reference"},slot:"reference"},[t._v(" 操作"),e("i",{staticClass:"el-icon-setting",staticStyle:{"padding-left":"10px"}})])],2)]}}])})],2),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.pageTotal,nameShow:t.nameShow},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"vulnDrawer",attrs:{title:t.vulnDetailData.inet,visible:t.vulnDetailShow,direction:"rtl",size:"35%","append-to-body":!0},on:{"update:visible":function(e){t.vulnDetailShow=e},close:t.vulnmDetailCancel}},[e("div",{staticStyle:{padding:"0 20px"}},[e("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("等级"),e("span",{staticClass:"subtitle"},["无风险"===t.vulnDetailData.level?e("el-tag",{attrs:{type:"success",size:"mini"}},[e("span",[t._v("无风险")])]):t._e(),"低危"===t.vulnDetailData.level?e("el-tag",{attrs:{type:"",size:"mini"}},[e("span",[t._v("低危")])]):t._e(),"中危"===t.vulnDetailData.level?e("el-tag",{staticStyle:{color:"#adad24","background-color":"#ffff0161","border-color":"#d9d92461"},attrs:{size:"mini"}},[e("span",[t._v("中危")])]):t._e(),"高危"===t.vulnDetailData.level?e("el-tag",{attrs:{type:"warning",size:"mini"}},[e("span",[t._v("高危")])]):t._e(),"紧急"===t.vulnDetailData.level?e("el-tag",{attrs:{type:"danger",size:"mini"}},[e("span",[t._v("紧急")])]):t._e()],1)])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("告警："),e("span",{staticClass:"subtitle"},[t._v(t._s(!0===t.vulnDetailData.send_alert?"是":"否"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("类型："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.risk_type))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("主题："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.subject))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("源IP："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.local_ip))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("源端口："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.local_port))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("外部IP："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.remote_ip))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("外部端口："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.remote_port))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("任务名称："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.from_code))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("地理位置："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.region))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("创建时间："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.created_at))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("产生时间："),e("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.occur_at))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[e("span",{staticStyle:{float:"left"}},[t._v("参考信息：")]),e("span",{staticClass:"subtitle",staticStyle:{float:"left"}},[e("pre",{staticStyle:{"font-family":"none"}},[t._v(t._s(t.vulnDetailData.reference||"-"))])])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[e("span",{staticStyle:{float:"left"}},[t._v("攻击载荷：")]),e("span",{staticClass:"subtitle",staticStyle:{float:"left"}},[e("pre",{staticStyle:{"font-family":"none"}},[t._v(t._s(t.vulnDetailData.payload||"-"))])])])],1)],1)])]),e("el-drawer",{attrs:{title:"事件通知",visible:t.noticeShow,"append-to-body":!0,direction:t.noticedirections,"custom-class":"demo-drawer","before-close":t.noticeClose,size:"20%"},on:{"update:visible":function(e){t.noticeShow=e}}},[e("div",{staticClass:"demo-drawer__content"},[e("el-form",{attrs:{model:t.form}},[e("el-form-item",{attrs:{label:"联系人","label-width":"80px"}},[e("el-select",{staticStyle:{width:"71%"},attrs:{size:"mini"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}},t._l(t.contactData,(function(t,a){return e("el-option",{key:a,attrs:{lable:t.name,value:t.name}})})),1)],1),e("el-form-item",{attrs:{label:"通知方式","label-width":"80px"}},[e("el-checkbox-group",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[e("el-checkbox",{attrs:{label:"邮件",name:"type"}}),e("el-checkbox",{attrs:{label:"短信",name:"type"}}),e("el-checkbox",{attrs:{label:"咚咚",name:"type"}}),e("el-checkbox",{attrs:{label:"电话",name:"type"}}),e("el-checkbox",{attrs:{label:"微信",name:"type"}})],1)],1)],1),e("div",{staticClass:"demo-drawer__footer"},[e("el-button",{staticStyle:{float:"right",margin:"10px"},attrs:{type:"primary"}},[t._v("发送")])],1)],1)])],1)},w=[],x=a(20039),C={name:"risk",components:{Page:v.Z,selectSearch:g.Z,CvssScore:x.Z},props:["dataTasks"],data(){return{nameShow:"事件详情",form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},groupArray:[{key:"risk_type",desc:"类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"任务名称"}],condData:{},riskLoading:!1,actionType:["批量删除","批量忽略","批量处理"],actionTitle:"",colData:[{lable:"终端IP",key:"inet",istrue:!0,width:150},{lable:"主题",key:"subject",istrue:!0},{lable:"等级",key:"level",istrue:!0,width:100},{lable:"源IP",key:"local_ip",istrue:!1,width:150},{lable:"源端口",key:"local_port",istrue:!1,width:150},{lable:"外部IP",key:"remote_ip",istrue:!0,width:150},{lable:"外部端口",key:"remote_port",istrue:!0},{lable:"地理位置",key:"region",istrue:!1},{lable:"类型",key:"risk_type",istrue:!0,width:100},{lable:"攻击载荷",key:"payload",istrue:!1},{lable:"告警",key:"send_alert",istrue:!1},{lable:"产生时间",key:"occur_at",istrue:!0},{lable:"任务名称",key:"from_code",istrue:!0},{lable:"参考信息",key:"reference",istrue:!1}],tableHeader:[{title:"终端IP",istrue:!0},{title:"类型",istrue:!0},{title:"等级",istrue:!0},{title:"源IP",istrue:!1},{title:"源端口",istrue:!1},{title:"外部端口",istrue:!0},{title:"外部IP",istrue:!0},{title:"地理位置",istrue:!0},{title:"主题",istrue:!0},{title:"攻击载荷",istrue:!1},{title:"告警",istrue:!1},{title:"产生时间",istrue:!0},{title:"任务名称",istrue:!0},{title:"参考信息",istrue:!1}],colOptions:["终端IP","类型","等级",,"远程IP","目的端口","目的IP","主题","产生时间","任务名称"],colSelect:["终端IP","类型","等级","源IP","源端口","目的端口","目的IP","地理位置","主题","攻击载荷","告警","产生时间","任务名称","参考信息"],riskData:[],currentPage:1,pageSize:15,vulnDetailShow:!1,vulnDetailData:{},ipTtitel:{},drawer:!1,noticedirections:"rtl",filters:[],noticeShow:!1,pageTotal:0,topEchartShow:!1,contactData:[]}},created(){this.getCond(),this.initRisk()},computed:{activeUsers:function(){return this.colData.filter((function(t){return t.istrue}))}},methods:{refresh(){this.initRisk(),this.$message({message:"已刷新",type:"success"})},taskShow(){this.$emit("activeClick",!1,!0,!1)},eventShow(){this.$emit("activeClick",!0,!1,!1)},selectActive(t){this.$emit("activeClick",!1,!1,!0,t)},cancel(){this.actionTitle=""},bulkClick(t){const e=this.$refs.actionForm;e.actionDialog=!0,this.actionTitle=t},noticeClose(){this.noticeShow=!1},innetactive(t){},attackShow(){this.$emit("activeClick",!1,!0,!1)},initRisk(){var t={current:this.currentPage,size:this.pageSize,filters:[{key:"from_code",operator:"eq",value:this.dataTasks.name},...this.dataTasks.minion_id?[{key:"minion_id",operator:"eq",value:this.dataTasks.minion_id}]:[],...this.filters]};this.riskLoading=!0,this.$request.fetchRisks(t).then((t=>{this.riskData=t.data.records,this.pageTotal=t.data.total,this.riskLoading=!1}))},getCond(){this.$request.fetchRisksCond().then((t=>{this.condData=t.data}))},searchBasic(t){this.currentPage=1,this.filters=t,this.initRisk()},echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow",this.topEchartShow)},sheetode(){var t={filters:this.filters};this.$request.fetchSheetode(t).then((t=>{const e=document.createElement("a");let a=new Blob([t.data],{type:"text/csv"});e.style.display="none",e.href=URL.createObjectURL(a);let i=t.headers["content-disposition"].split("''");e.setAttribute("download",decodeURI(i[1])),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},handleSizeChange(t){this.pageSize=t,this.initRisk()},handleCurrentChange(t){this.currentPage=t,this.initRisk()},riskDetailCilck(t){this.vulnDetailShow=!0,this.vulnDetailData=t},riskNoticeCilck(){this.noticeShow=!0;var t={current:1,size:100,name:""};this.$request.fetchGetContact(t).then((t=>{this.contactData=t.data.records}))},kaifa(){this.$message({message:"开发中！！！",type:"warning"})},vulnmDetailCancel(){this.vulnDetailShow=!1,this.vulnDetailData={}},click(){this.$message({message:"开发中！！！",type:"warning"})}},watch:{colOptions(t){if(t){var e=this.colSelect.filter((e=>t.indexOf(e)<0));this.colData.filter((t=>{e.indexOf(t.lable)>-1?t.istrue=!1:t.istrue=!0}))}}}},D=C,z=(0,p.Z)(D,S,w,!1,null,"418d986e",null),$=z.exports,I={props:["dataTask"],components:{Risk:$,Event:l.Z,Task:b},name:"eventTask",data(){return{evnetShow:!0,taskShow:!1,riskShow:!1}},methods:{activeClick(t,e,a){this.evnetShow=t,this.taskShow=e,this.riskShow=a}}},T=I,L=(0,p.Z)(T,i,s,!1,null,"3fbaac62",null),B=L.exports}}]);