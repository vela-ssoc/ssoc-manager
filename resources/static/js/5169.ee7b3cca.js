"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[5169],{9721:function(t,s,e){e.r(s),e.d(s,{default:function(){return p}});var o=function(){var t=this,s=t._self._c;return s("div",{staticClass:"flex items-center h-full justify-center"},[t.errorMsg?s("el-result",{attrs:{icon:"error",title:"登录失败:"+t.errorMsg},scopedSlots:t._u([{key:"extra",fn:function(){return[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.toLogin}},[t._v("重新登录")])]},proxy:!0}],null,!1,2194045880)}):s("div",{staticClass:"app-loading"},[s("div",{staticClass:"app-loading-wrap"},[s("div",{staticClass:"app-loading-dots"},[s("span",{staticClass:"dot dot-spin"},[s("i"),s("i"),s("i"),s("i")])])])])],1)},r=[],i=e(98362),a=e(35287),n=e.p+"img/链接失败.d1b6931e.png",c={created(){this.init()},data(){return{errorMsg:"",errorImg:n}},methods:{async init(){try{const{code:t}=a.A.parse(location.search);if(!t)throw"无code，无token，定向回登录页";this.login(t)}catch(t){this.toLogin()}},async login(t){try{const{data:s}=await i.A.post("/auth/oauth",{code:t});this.setLoginInfo(s),this.clearQuery("code"),this.toHome()}catch(s){this.errorMsg=s+""}},setLoginInfo(t){this.$store.dispatch("setToken",t.token),this.$store.dispatch("setUserInso",t)},clearQuery(t){const s=new URL(location.href);s.searchParams.delete(t),history.replaceState({},"",s.href)},toHome(){this.$router.push("/control")},toLogin(){localStorage.removeItem("token"),this.$router.push("/login")}}},l=c,h=e(81656),u=(0,h.A)(l,o,r,!1,null,"76a02bf5",null),p=u.exports}}]);