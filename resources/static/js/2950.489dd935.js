"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[2950],{86389:function(t,e,i){i.d(e,{A:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("detail",t._g(t._b({},"detail",t.$attrs,!1),t.$listeners))},s=[],l=i(24869),r={components:{detail:l.A}},n=r,o=i(81656),c=(0,o.A)(n,a,s,!1,null,null,null),d=c.exports},77538:function(t,e,i){i.d(e,{A:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",[4===t.cvssScore||"紧急"===t.cvssScore?e("div",{staticStyle:{height:"24px",margin:"0 auto"}},[e("div",{staticClass:"severity-critical-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(0)]):t._e(),3===t.cvssScore||"高危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-high-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(1)]):t._e(),2===t.cvssScore||"中危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-medium-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(2)]):t._e(),1===t.cvssScore||"低危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-low-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(3)]):t._e(),0===t.cvssScore||"无风险"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-no-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(4)]):t._e()])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("紧急")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("高危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("中危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("低危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("无风险")])])])}],l={name:"CvssScore",props:["cvssScore"]},r=l,n=i(81656),o=(0,n.A)(r,a,s,!1,null,"77d4d761",null),c=o.exports},67424:function(t,e,i){i.d(e,{A:function(){return p}});var a=function(){var t=this,e=t._self._c;return e("el-drawer",{staticClass:"vulnDrawer",attrs:{visible:t.visible,direction:"rtl",size:"50%","append-to-body":""},on:{"update:visible":function(e){t.visible=e}},scopedSlots:t._u([{key:"title",fn:function(){return[e("div",[e("el-button",{staticClass:"text-blue-500",attrs:{size:"mini",round:""}},[t._v(t._s(t.riskData.inet))]),e("b",{staticClass:"text-[#000] ml-2"},[t._v(" "+t._s(t.riskData.subject||"--")+" ")])],1)]},proxy:!0}])},[e("div",{staticStyle:{padding:"10px 20px"}},[e("el-descriptions",{attrs:{column:2,labelStyle:{color:"#000","font-weight":600}}},[e("el-descriptions-item",{attrs:{label:"级别"}},["无风险"===t.riskData.level?e("el-tag",{attrs:{type:"success",size:"mini"}},[e("span",[t._v("无风险")])]):t._e(),"低危"===t.riskData.level?e("el-tag",{attrs:{type:"",size:"mini"}},[e("span",[t._v("低危")])]):t._e(),"中危"===t.riskData.level?e("el-tag",{staticStyle:{color:"#adad24","background-color":"#ffff0161","border-color":"#d9d92461"},attrs:{size:"mini"}},[e("span",[t._v("中危")])]):t._e(),"高危"===t.riskData.level?e("el-tag",{attrs:{type:"warning",size:"mini"}},[e("span",[t._v("高危")])]):t._e(),"紧急"===t.riskData.level?e("el-tag",{attrs:{type:"danger",size:"mini"}},[e("span",[t._v("紧急")])]):t._e(),e("el-tag",{staticStyle:{"margin-left":"3px"},attrs:{size:"mini",type:t.riskData.send_alert?"warning":"danger"}},[t._v(" "+t._s(t.riskData.send_alert?"已告警":"未告警")+" ")])],1),e("el-descriptions-item",{attrs:{label:"风险类型"}},[t._v(" "+t._s(t.riskData.risk_type||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"风险ID"}},[t._v(" "+t._s(t.riskData.id)+" ")]),e("el-descriptions-item",{attrs:{label:"终端ID"}},[t._v(" "+t._s(t.riskData.minion_id)+" ")]),e("el-descriptions-item",{attrs:{label:"源IP"}},[t._v(" "+t._s(t.riskData.local_ip||"")+":"+t._s(t.riskData.local_port)+" ")]),e("el-descriptions-item",{attrs:{label:"外部IP"}},[t._v(" "+t._s(t.riskData.remote_ip||"")+":"+t._s(t.riskData.remote_port)+" ")]),e("el-descriptions-item",{attrs:{label:"来源模块"}},[t._v(" "+t._s(t.riskData.from_code||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"归属地"}},[t._v(" "+t._s(t.riskData.region||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"服务端事件创建时间"}},[t._v(" "+t._s(t.riskData.created_at?t.moment(t.riskData.created_at).format("YYYY-MM-DD HH:mm:ss"):"--")+" ")]),e("el-descriptions-item",{attrs:{label:"事件产生本地时间"}},[t._v(" "+t._s(t.riskData.occur_at?t.moment(t.riskData.occur_at).format("YYYY-MM-DD HH:mm:ss"):"--")+" ")]),e("el-descriptions-item",{attrs:{label:"参考信息",span:2}},[e("jsonView",{attrs:{data:t.riskData.referenceHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"攻击载荷",span:2}},[e("jsonView",{attrs:{data:t.riskData.payloadHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"template",span:2}},[e("jsonView",{attrs:{data:t.riskData.templateHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"metadata",span:2}},[e("jsonView",{attrs:{data:t.riskData.metadata||"--",beauty:!1}})],1)],1)],1)])},s=[],l=i(23203),r=i(95093),n=i.n(r);function o(t){try{return t=decodeURIComponent(t),JSON.parse(t)}catch(e){return t}}var c={components:{jsonView:l.A},data(){return{moment:n(),riskData:{inet:null,level:null,send_alert:null,risk_type:null,subject:null,local_ip:null,local_port:null,remote_ip:null,remote_port:null,from_code:null,region:null,created_at:null,occur_at:null,reference:null,payload:null,payloadHJS:null,referenceHJS:null,metadata:null,template:null,templateHJS:null},visible:!1}},methods:{openRiskDetail(t){this.$set(this,"riskData",t),this.riskData.payloadHJS=o(this.riskData.payload),this.riskData.referenceHJS=o(this.riskData.reference),this.riskData.templateHJS=o(this.riskData.template),this.visible=!0}}},d=c,h=i(81656),u=(0,h.A)(d,a,s,!1,null,"56788c05",null),p=u.exports},43793:function(t,e,i){i.r(e),i.d(e,{default:function(){return Z}});var a=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"contentCard_"},[t.chartShow?e("el-row",{attrs:{gutter:10}},[e("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:24}},[t.recentShow?e("Notice",{attrs:{recentData:t.recentData},on:{selectChange:t.selectChange}}):t._e()],1)],1):t._e(),t.riskShow?e("Risk",{on:{activeClick:t.activeClick,activechartShow:t.activechartShow}}):t._e(),t.attackShow?e("Attack",{on:{activeClick:t.activeClick,activechartShow:t.activechartShow}}):t._e()],1)},s=[],l=(i(12878),function(){var t=this,e=t._self._c;return e("el-card",{attrs:{shadow:"never"}},[e("div",{staticClass:"statusChart",style:{float:"left",width:"100%",height:"245px"},attrs:{id:"statusChart"}})])}),r=[],n=i(83779),o={name:"eventChart",data(){return{riskstsData:{}}},created(){this.initStatus()},methods:{initStatus(){this.$request.getRisklvl().then((t=>{this.riskstsData=t.data,this.initRisksts()}))},initRisksts(){var t=[];for(let r in this.riskstsData){var e={};"critical"===r?(e={name:"紧急",value:this.riskstsData[r]},t.push(e)):"high"===r?(e={name:"高风险",value:this.riskstsData[r]},t.push(e)):"middle"===r?(e={name:"中风险",value:this.riskstsData[r]},t.push(e)):"low"===r&&(e={name:"低风险",value:this.riskstsData[r]},t.push(e))}let i=0;t.forEach((function(t){i+=t.value}));let a=["#f86c6b","#fd8c00","#ffc107","#4dbd74"];var s={backgroundColor:"#fff",tooltip:{trigger:"item",formatter:"{b}{c}",textStyle:{color:"#fff"},padding:[10,10],axisPointer:{type:"shadow",shadowStyle:{color:"#fff"}}},title:{text:i,subtext:"总数",x:"32.5%",y:"40%",textStyle:{fontSize:14,fontWeight:"normal",color:"#333"},subtextStyle:{fontSize:14,fontWeight:"normal",align:"center",color:"#555"}},legend:{orient:"vertical",right:"5%",align:"left",top:"middle",itemWidth:10,itemHeight:13,icon:"circle",itemGap:20,data:t,formatter:function(e){let a=0;for(var s="",l=0;l<t.length;l++)t[l].name===e&&(a=(t[l].value/i*100).toFixed(2)+"%",s+="{a|"+e+"}| {b|"+a+"}{b|"+t[l].value+"}");return s},textStyle:{color:"#000",rich:{a:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20},b:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20}}}},series:[{type:"pie",zlevel:3,radius:["50","90"],center:["35%","50%"],color:a,itemStyle:{normal:{borderWidth:10,borderColor:"#fff"}},data:t,labelLine:{normal:{show:!1}},label:{show:!1}}]};const l=n.init(document.getElementById("statusChart"));l.setOption(s),window.addEventListener("resize",(()=>{l.resize()}))},detailClick(){this.$router.push("/node")}}},c=o,d=i(81656),h=(0,d.A)(c,l,r,!1,null,null,null),u=h.exports,p=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"card",staticStyle:{height:"265px"},attrs:{shadow:"never"}},[e("div",{style:{float:"left",width:"100%",height:"240px"},attrs:{id:"riskstsEcharts"}}),e("el-checkbox-group",{staticClass:"day_select",attrs:{size:"mini"},on:{change:t.selectChange},model:{value:t.dayCheck,callback:function(e){t.dayCheck=e},expression:"dayCheck"}},t._l(t.dayArray,(function(i,a){return e("div",{key:a},[e("el-checkbox",{attrs:{label:i.value}},[t._v(t._s(i.label))])],1)})),0)],1)},f=[],v=i(92161),m={name:"Eventnotice",components:{Page:v.A},props:["recentData"],data(){return{current:1,riskData:{},echartData:[],dayCheck:["15"],dayArray:[{value:"1",label:"查询今天"},{value:"3",label:"查询三天"},{value:"5",label:"查询五天"},{value:"7",label:"查询一周"},{value:"15",label:"查询半月"},{value:"30",label:"查询每月"}]}},mounted(){this.chartRecent()},methods:{selectChange(t){this.dayCheck.length>1&&this.dayCheck.shift(),void 0===this.dayCheck[0]&&(this.dayCheck[0]="15"),this.$emit("selectChange",this.dayCheck[0])},chartRecent(){var t=[],e=[];e=this.recentData.risk.map((t=>t.type)),this.recentData.risk.length>0&&this.recentData.risk.forEach((e=>{t.push({backgroundStyle:{color:"rgba(111, 162, 135, 0.2)"},name:e.type,type:"bar",emphasis:{focus:"series"},data:e.count})}));var i={color:["#5470C6","#91CC75","#FAC858","#f44336","#9c27b0","#03a9f4","#4caf50","#ffc107","#ff5722","#795548","#607d8b"],grid:{left:"4%",right:"8%",top:"16%",bottom:"8%"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{orient:"vertical",top:"1%",right:20,itemWidth:10,itemHeight:10,data:e},xAxis:{type:"category",data:this.recentData.date},yAxis:[{type:"value",show:!1}],series:t};const a=n.init(document.getElementById("riskstsEcharts"));a.setOption(i,!0),window.addEventListener("resize",(()=>{a.resize()}))}},watch:{recentData:function(t){this.recentData=t,this.chartRecent()}}},g=m,y=(0,d.A)(g,p,f,!1,null,"4a12f768",null),k=y.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{height:"100%"}},[e("div",{staticStyle:{display:"flex","align-items":"flex-end","justify-content":"space-between"}},[e("div",{staticStyle:{flex:"1",display:"flex","align-items":"flex-end","margin-bottom":"1px","margin-right":"10px"}},[e("span",{staticClass:"buttonsearch_2",staticStyle:{margin:"0 5px 0 0"},attrs:{size:"mini"},on:{click:function(e){t.tagShow=!t.tagShow}}},[e("i",{class:t.tagShow?"el-icon-s-unfold":"el-icon-s-fold",staticStyle:{"font-size":"25px",color:"#939597",transform:"translateY(-1px)"}})]),e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filters,callback:function(e){t.filters=e},expression:"filters"}})],1),e("div",[e("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:t.echartShow}},[t._v(t._s(!0===t.topEchartShow?"隐藏图表":"显示图表")+" ")]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.sheetode}},[t._v("导出"),e("i",{staticClass:"el-icon-upload2 el-icon--right"})]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.click}},[t._v("一键操作")]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.initRisk}},[t._v("刷新")]),e("el-dropdown",{staticStyle:{"margin-left":"7px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{"el-button":"",type:"primary",plain:"",size:"mini"}},[t._v(" 批量操作"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.actionType,(function(i,a){return e("el-dropdown-item",{key:a,nativeOn:{click:function(e){return t.bulkClick(i)}}},[t._v(" "+t._s(i)+" ")])})),1)],1),e("el-button-group",{staticStyle:{"margin-top":"-2px","margin-left":"7px"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("风险事件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.attackShow}},[t._v("攻击统计")])],1)],1)]),e("div",{staticStyle:{display:"flex","margin-top":"5px",width:"100%"}},[e("leftMenu",{directives:[{name:"show",rawName:"v-show",value:t.tagShow,expression:"tagShow"}],attrs:{"active-option":t.curtag,filters:t.filters},on:{change:t.leftChange},model:{value:t.leftMenuValue,callback:function(e){t.leftMenuValue=e},expression:"leftMenuValue"}}),e("div",{style:t.tagShow?"width: calc(100% - 300px)":"width:100%"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:t.riskData,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"},on:{"row-dblclick":t.riskDetailCilck}},[t._l(t.activeUsers,(function(i,a){return e("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"",label:i.lable,prop:i.key,width:i.width},scopedSlots:t._u([{key:"default",fn:function(a){return["inet"===i.key?e("span",[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(a.row)}}},[t._v(t._s(a.row.inet))])],1):"level"===i.key?e("span",[e("CvssScore",{attrs:{cvssScore:a.row.level}})],1):"region"===i.key?e("span",[t._v(" "+t._s(a.row.region||"0|0|0|未知|未知")+" ")]):"remote_ip"===i.key?e("span",[t._v(" "+t._s(a.row.remote_ip||"未知")+" ")]):"send_alert"===i.key?e("span",[t._v(" "+t._s(!0===a.row[i.key]?"是":"否")+" ")]):"occur_at"===i.key?e("span",[t._v(" "+t._s(t._f("date")(a.row.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]):"created_at"===i.key?e("span",[t._v(" "+t._s(t._f("date")(a.row.created_at,"yyyy-MM-dd hh:mm:ss"))+" ")]):"payload"===i.key||"reference"===i.key?e("pre",[t._v(t._s(a.row.payload))]):e("span",[t._v(" "+t._s(a.row[i.key])+" ")])]}}],null,!0)})})),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.riskDetailCilck(i.row)}}},[t._v("详情")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.riskNoticeCilck()}}},[t._v("通知")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.kaifa}},[t._v("处理")])]}}])},[e("template",{slot:"header"},[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t._l(t.tableHeader,(function(i,a){return e("div",{key:a},[e("el-checkbox",{attrs:{label:i.title},model:{value:t.colOptions,callback:function(e){t.colOptions=e},expression:"colOptions"}})],1)})),e("div",{attrs:{slot:"reference"},slot:"reference"},[t._v(" 操作"),e("i",{staticClass:"el-icon-setting",staticStyle:{"padding-left":"10px"}})])],2)],1)],2)],2),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.pageTotal},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}})],1)],1),e("el-drawer",{staticClass:"inetDrawer",attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"destroy-on-close":"","before-close":t.drawerClose,"append-to-body":"",size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1),e("el-drawer",{attrs:{title:"事件通知",visible:t.noticeShow,direction:t.noticedirections,"custom-class":"demo-drawer","before-close":t.noticeClose,"destroy-on-close":"",size:"20%"},on:{"update:visible":function(e){t.noticeShow=e}}},[e("div",{staticClass:"demo-drawer__content"},[e("el-form",{attrs:{model:t.form}},[e("el-form-item",{attrs:{label:"联系人","label-width":"80px"}},[e("el-select",{staticStyle:{width:"71%"},attrs:{size:"mini"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}},t._l(t.contactData,(function(t,i){return e("el-option",{key:i,attrs:{lable:t.name,value:t.name}})})),1)],1),e("el-form-item",{attrs:{label:"通知方式","label-width":"80px"}},[e("el-checkbox-group",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[e("el-checkbox",{attrs:{label:"邮件",name:"type"}}),e("el-checkbox",{attrs:{label:"短信",name:"type"}}),e("el-checkbox",{attrs:{label:"咚咚",name:"type"}}),e("el-checkbox",{attrs:{label:"电话",name:"type"}}),e("el-checkbox",{attrs:{label:"微信",name:"type"}})],1)],1)],1),e("div",{staticClass:"demo-drawer__footer"},[e("el-button",{staticStyle:{float:"right",margin:"10px"},attrs:{type:"primary"}},[t._v("发送")])],1)],1)]),e("ActionForm",{ref:"actionForm",attrs:{title:t.actionTitle,pageTotal:t.pageTotal,filters:t.filters,nodeData:t.riskData},on:{initRisk:t.initRisk,cancel:t.cancel}}),e("riskDetail",{ref:"riskDetailRef"})],1)},b=[],w=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{"el-dialog":"","close-on-click-modal":!1,"before-close":t.handleClose,visible:t.actionDialog,title:t.title,"append-to-body":"",width:"500px"},on:{"update:visible":function(e){t.actionDialog=e}}},[t.filters.length>0?e("div",[t._l(t.nodeData,(function(i){return e("el-tag",{key:i.id,staticStyle:{"margin-right":"3px","margin-bottom":"3px"},attrs:{size:"mini",type:"彻底删除"===t.title||"逻辑删除"===t.title?"danger":"success"}},[t._v(t._s(i.inet)+" ")])})),t._v(" 等，共计 "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.pageTotal))]),t._v(" 条是否操作？ ")],2):e("div",[e("span",{staticStyle:{color:"red"}},[t._v("请输入筛选条件")])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.actionDialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v("确定")])],1)])},S=[],x={name:"actionForm",props:["title","pageTotal","filters","nodeData"],data(){return{actionDialog:!1,dataAction:[]}},methods:{handleClose(){this.actionDialog=!1,this.$emit("cancel")},onSubmit(){var t=this,e={filters:this.filters};"批量删除"===this.title?this.$request.fetchDeleteRisk(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)})):"批量忽略"===this.title?this.$request.fetchRiskIgnore(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)})):"批量处理"===this.title&&this.$request.fetchRiskProcess(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)}))}},watch:{nodeData:function(t){this.nodeData=t},filters:function(t){this.filters=t}}},C=x,D=(0,d.A)(C,w,S,!1,null,"0016035a",null),z=D.exports,L=i(77538),A=i(86389),P=i(67424),$=function(){var t=this,e=t._self._c;return e("div",{staticClass:"leftBox"},[e("div",{staticClass:"fitlerBox"},[e("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini"},on:{change:t.loadMenu},model:{value:t.leftBoxType,callback:function(e){t.leftBoxType=e},expression:"leftBoxType"}},t._l(t.groupArray,(function(t,i){return e("el-option",{key:i,attrs:{label:t.desc,value:t.key}})})),1)],1),e("div",{staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(e){return t.leftItemClick(null)}}},[e("i",{staticClass:"el-icon-caret-right",staticStyle:{color:"#939597"}}),t._v(" 全部 ")]),t._l(t.menuList,(function(i,a){return e("div",{key:a,class:{tagItem:!0,tagItemActive:i.name===t.activeOption},on:{click:function(e){return t.leftItemClick(i.name)}}},[e("span",{staticStyle:{display:"inline-block",width:"4px",height:"4px","margin-right":"5px","background-color":"#86909c","border-radius":"2px"}}),e("el-tooltip",{attrs:{effect:"light",content:i.name+"("+i.count+")",placement:"top-start","open-delay":800}},[e("span",{staticClass:"contentBox"},[t._v(" "+t._s(i.name||"--")+" "),e("span",{staticStyle:{color:"#a8acb1","font-size":"14px"}},[t._v("("+t._s(i.count)+")")])])])],1)})),e("el-pagination",{attrs:{"current-page":t.pageIndex,"page-size":15,small:"",layout:"prev, pager, next",total:t.total},on:{"update:currentPage":function(e){t.pageIndex=e},"update:current-page":function(e){t.pageIndex=e},"current-change":t.loadMenu}})],2)},M=[],R={props:["activeOption","value","filters"],data(){return{leftBoxType:"risk_type",pageIndex:1,activeMenu:null,pageSize:15,total:0,menuList:[],groupArray:[{key:"subject",desc:"主题"},{key:"risk_type",desc:"类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"任务名称"}]}},watch:{filters:{handler(){this.loadMenu()},deep:!0}},created(){this.loadMenu()},methods:{async loadMenu(){try{const{data:t}=await this.$request.fetchGroup({current:this.pageIndex,size:this.pageSize,group:this.leftBoxType,filters:this.filters})||{};this.menuList=t?.records,this.total=t?.total}catch(t){this.menuList=[],this.total=0,console.error(t)}},emit(){this.$emit("input",{key:this.leftBoxType,operator:"eq",value:this.activeMenu}),this.$emit("change",{key:this.leftBoxType,operator:"eq",value:this.activeMenu})},leftItemClick(t){t===this.activeMenu&&(t=null),this.activeMenu=t,this.emit()}}},I=R,T=(0,d.A)(I,$,M,!1,null,"e937eb58",null),B=T.exports,E=i(72953),O=i(95093),q=i.n(O),H={name:"risk",components:{Page:v.A,CvssScore:L.A,NodeDetail:A.A,ActionForm:z,riskDetail:P.A,leftMenu:B,filterOption:E.A},data(){return{form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},leftBoxType:"risk_type",groupArray:[{key:"subject",desc:"主题"},{key:"risk_type",desc:"风险类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"来源模块"}],condData:{},riskLoading:!1,actionType:["批量删除","批量忽略","批量处理"],actionTitle:"",selectArray:[{model:"",placeholder:"风险类型",name:"risk_type",dataArray:[{key:"暴力破解",desc:"暴力破解"},{key:"病毒事件",desc:"病毒事件"},{key:"弱口令",desc:"弱口令"},{key:"数据爬虫",desc:"数据爬虫"},{key:"蜜罐应用",desc:"蜜罐应用"},{key:"web攻击",desc:"web攻击"},{key:"登录事件",desc:"登录事件"},{key:"监控事件",desc:"监控事件"}]}],colData:[{lable:"终端IP",key:"inet",istrue:!0,width:120},{lable:"级别",key:"level",istrue:!0,width:120},{lable:"本地IP",key:"local_ip",istrue:!1,width:150},{lable:"本地端口",key:"local_port",istrue:!1,width:150},{lable:"外部IP",key:"remote_ip",istrue:!0,width:150},{lable:"外部端口",key:"remote_port",istrue:!0,width:80},{lable:"归属地",key:"region",istrue:!1},{lable:"风险类型",key:"risk_type",istrue:!0,width:100},{lable:"告警",key:"send_alert",istrue:!1},{lable:"产生时间",key:"created_at",istrue:!0,width:150},{lable:"参考信息",key:"reference",istrue:!1},{lable:"主题",key:"subject",istrue:!0,width:280},{lable:"来源模块",key:"from_code",istrue:!0}],tableHeader:[{title:"终端IP",istrue:!0},{title:"风险类型",istrue:!0},{title:"级别",istrue:!0},{title:"本地IP",istrue:!1},{title:"本地端口",istrue:!1},{title:"外部端口",istrue:!0},{title:"外部IP",istrue:!0},{title:"归属地",istrue:!0},{title:"主题",istrue:!0},{title:"告警",istrue:!1},{title:"产生时间",istrue:!0},{title:"来源模块",istrue:!0},{title:"参考信息",istrue:!1}],colOptions:["终端IP","风险类型","级别","远程IP","目的端口","目的IP","主题","产生时间","来源模块"],colSelect:["终端IP","风险类型","级别","源IP","源端口","目的端口","目的IP","归属地","主题","告警","产生时间","来源模块","参考信息"],riskData:[],currentPage:1,pageSize:15,vulnDetailShow:!1,vulnDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",noticedirections:"rtl",filters:[{key:"occur_at",operator:"gt",value:q()().startOf("days").subtract(7,"days")},{key:"level",operator:"notin",value:"低危"}],noticeShow:!1,pageTotal:0,topEchartShow:!1,contactData:[],tagShow:!1,leftMenuValue:{key:"risk_type",operator:"",value:""}}},created(){this.initRisk(),this.getCond()},computed:{activeUsers:function(){return this.colData.filter((function(t){return t.istrue}))},curtag(){if(!this.filters)return"";const t=this.filters.find((t=>t.key===this.leftMenuValue.key));return t&&"eq"===t.operator&&t.value?t.value:void 0}},methods:{selectActive(t){this.$emit("activeClick",!1,!1,!0,t)},cancel(){this.actionTitle=""},bulkClick(t){const e=this.$refs.actionForm;e.actionDialog=!0,this.actionTitle=t},drawerClose(){this.drawer=!1,this.ipTtitel={}},noticeClose(){this.noticeShow=!1},innetactive(t){this.ipTtitel=t,this.drawer=!0},attackShow(){this.$emit("activeClick",!1,!0,!1)},initRisk(){var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchRisks(t).then((t=>{this.riskData=t.data.records,this.pageTotal=t.data.total,this.riskLoading=!1})).catch((t=>{this.riskLoading=!1,this.$message.error(t)}))},getCond(){this.$request.fetchRisksCond().then((t=>{this.condData=t.data}))},searchBasic(){this.currentPage=1,this.initRisk()},echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow",this.topEchartShow)},sheetode(){var t={filters:this.filters};this.$request.fetchSheetode(t).then((t=>{const e=document.createElement("a");let i=new Blob([t.data],{type:"text/csv"});e.style.display="none",e.href=URL.createObjectURL(i);let a=t.headers["content-disposition"].split("''");e.setAttribute("download",decodeURI(a[1])),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},handleSizeChange(t){this.pageSize=t,this.initRisk()},handleCurrentChange(t){this.currentPage=t,this.initRisk()},riskDetailCilck(t){this.$refs.riskDetailRef.openRiskDetail(t)},riskNoticeCilck(){this.noticeShow=!0;var t={current:1,size:100,name:""};this.$request.fetchGetContact(t).then((t=>{this.contactData=t.data.records}))},kaifa(){this.$message({message:"开发中！！！",type:"warning"})},click(){this.$message({message:"开发中！！！",type:"warning"})},leftChange(){this.$refs.selectSearchRef?.pushFilter({key:this.leftMenuValue.key,operator:this.leftMenuValue.operator,value:this.leftMenuValue.value})}},watch:{colOptions(t){if(t){var e=this.colSelect.filter((e=>t.indexOf(e)<0));this.colData.filter((t=>{e.indexOf(t.lable)>-1?t.istrue=!1:t.istrue=!0}))}}}},j=H,V=(0,d.A)(j,_,b,!1,null,"78577164",null),F=V.exports,N=function(){var t=this,e=t._self._c;return e("div",[e("el-row",[e("el-col",{staticStyle:{"text-align":"left"},attrs:{xs:24,sm:24,md:24,lg:15,xl:15}},[e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filters,callback:function(e){t.filters=e},expression:"filters"}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{xs:24,sm:24,md:24,lg:9,xl:9}},[e("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:t.echartShow}},[t._v(t._s(!0===t.topEchartShow?"隐藏图表":"显示图表")+" ")]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.click}},[t._v("一键操作")]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.initAttact}},[t._v("刷新")]),e("el-button-group",{staticStyle:{"margin-left":"7px","margin-top":"-1px"}},[e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.riskShow}},[t._v("风险事件")]),e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("攻击统计")])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:t.riskData.records,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[e("el-table-column",{attrs:{prop:"subject",label:"主题"}}),e("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remote_ip||"未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"count",label:"次数"}}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.evnetDetail(i.row)}}},[t._v("事件详情")])]}}])})],1),e("Page",{attrs:{size:t.riskData.size,current:t.riskData.current,pageTotal:t.riskData.total},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"vulnDrawer",attrs:{title:"事件详情",visible:t.detailShow,direction:"rtl",size:"90%"},on:{"update:visible":function(e){t.detailShow=e},close:t.vulnmDetailCancel}},[e("div",{staticStyle:{padding:"0 10px"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.detalLoading,expression:"detalLoading"}],attrs:{data:t.detailData.records,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[e("el-table-column",{attrs:{prop:"inet",label:"终端IP",width:"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(i.row)}}},[t._v(t._s(i.row.inet))])]}}])}),e("el-table-column",{attrs:{prop:"risk_type",label:"类型",width:"120"}}),e("el-table-column",{attrs:{prop:"level",label:"等级",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("CvssScore",{attrs:{cvssScore:t.row.level}})]}}])}),e("el-table-column",{attrs:{prop:"local_port",label:"本地端口",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.local_port)+" ")]}}])}),e("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remote_ip||"未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"region",label:"地理位置",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.region||"0|0|0|未知|未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"subject",label:"主题"}}),e("el-table-column",{attrs:{prop:"payload",label:"Payload","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"send_alert",label:"告警",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(!0===e.row.send_alert?"是":"否")+" ")]}}])}),e("el-table-column",{attrs:{prop:"occur_at",label:"产生时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("date")(e.row.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])})],1),e("Page",{attrs:{size:t.detailPage.pageSize,current:t.detailPage.current,pageTotal:t.detailData.total},on:{handleSizeChange:t.detailhandleSizeChange,handleCurrentChange:t.detailhandleCurrentChange}})],1)]),e("el-drawer",{attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1)],1)},J=[],U={name:"risk",components:{filterOption:E.A,Page:v.A,CvssScore:L.A,NodeDetail:A.A},data(){return{groupArray:[{key:"subject",desc:"主题"},{key:"risk_type",desc:"类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"任务名称"}],condData:{},riskLoading:!1,selectArray:[{model:"",placeholder:"风险类型",name:"risk_type",dataArray:[{key:"暴力破解",desc:"暴力破解"},{key:"病毒事件",desc:"病毒事件"},{key:"弱口令",desc:"弱口令"},{key:"数据爬虫",desc:"数据爬虫"},{key:"蜜罐应用",desc:"蜜罐应用"},{key:"web攻击",desc:"web攻击"},{key:"登录事件",desc:"登录事件"},{key:"监控事件",desc:"监控事件"}]}],riskData:{},currentPage:1,pageSize:15,detailcurrentPage:1,detailpageSize:15,detailShow:!1,vulnDetailLoading:!1,vulnDetailData:{},filters:[],detailData:{},detailPage:{pageSize:15,current:1},detalLoading:!1,activeDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",topEchartShow:!1}},created(){this.initAttact(),this.getCond()},methods:{echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow",this.topEchartShow)},drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(t){this.ipTtitel=t,this.drawer=!0},evnetDetail(t){if(!t.remote_ip)return this.$message.warning("未知IP无法查询详情");this.activeDetailData=t,this.detailShow=!0;var e={current:this.detailPage.current,size:this.detailPage.pageSize,filters:[{key:"remote_ip",value:t.remote_ip,operator:"eq"},{key:"subject",value:t.subject,operator:"eq"}]};this.detalLoading=!0,this.$request.fetchRisks(e).then((t=>{this.detailData=t.data,this.detalLoading=!1}))},riskShow(){this.$emit("activeClick",!0,!1,!1)},selectActive(t){this.$emit("activeClick",!1,!1,!0,t)},initAttact(){var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchAttack(t).then((t=>{this.riskData=t.data,this.riskLoading=!1}))},getCond(){this.$request.fetchRisksCond().then((t=>{this.condData=t.data}))},searchBasic(t){this.currentPage=1,this.initAttact()},sheetode(){var t={filters:this.filters};this.$request.fetchSheetode(t).then((t=>{const e=document.createElement("a");let i=new Blob([t.data],{type:"text/csv"});e.style.display="none",e.href=URL.createObjectURL(i);let a=t.headers["content-disposition"].split("''");e.setAttribute("download",decodeURI(a[1])),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},handleSizeChange(t){this.pageSize=t,this.initAttact()},handleCurrentChange(t){this.currentPage=t,this.initAttact()},detailhandleSizeChange(t){this.detailpageSize=t,this.evnetDetail(this.activeDetailData)},detailhandleCurrentChange(t){this.detailcurrentPage=t,this.evnetDetail(this.activeDetailData)},vulnmDetailCancel(){this.detailShow=!1,this.activeDetailData={}},click(){this.$message({message:"开发中！！！",type:"warning"})}}},Y=U,W=(0,d.A)(Y,N,J,!1,null,"e9946b48",null),G=W.exports,K={components:{eventChart:u,Notice:k,Risk:F,Attack:G},name:"vuln",data(){return{riskShow:!0,attackShow:!1,groupShow:!1,recentData:[],recentShow:!1,chartShow:!1,group:{},day:"15"}},methods:{activeClick(t,e,i,a){this.group=a,this.chartShow=!1,this.riskShow=t,this.attackShow=e,this.groupShow=i},activechartShow(){void 0===this.recentData.date&&this.getRecent(this.day),this.chartShow=!this.chartShow},selectChange(t){this.getRecent(t)},getRecent(t){this.$request.fetchRevent(t).then((t=>{this.recentData=t.data,this.recentShow=!0}))}}},Q=K,X=(0,d.A)(Q,a,s,!1,null,"3dbf2bc8",null),Z=X.exports}}]);