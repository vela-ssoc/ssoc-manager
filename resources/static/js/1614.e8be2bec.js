"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[1614],{78188:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var i=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("el-button",{staticStyle:{"margin-left":"0"},attrs:{"el-button":"",type:"primary",size:"mini"},on:{click:e.addStore}},[e._v("添加")]),t("el-table",{staticStyle:{width:"100%","margin-top":"5px"},attrs:{data:e.storeData,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"}}},[t("el-table-column",{attrs:{prop:"id",label:"ID"}}),t("el-table-column",{attrs:{prop:"desc",label:"描述"}}),t("el-table-column",{attrs:{prop:"created_at",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("date")(t.row.created_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),t("el-table-column",{attrs:{prop:"updated_at",label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("date")(t.row.updated_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.editRoom(a.row)}}},[e._v("编辑")]),t("el-popover",{ref:a.row.id,attrs:{placement:"top"}},[t("p",[e._v("确定删除?")]),t("div",{staticStyle:{"text-align":"right",margin:"0"}},[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.$refs[a.row.id].doClose()}}},[e._v("取消")]),t("el-button",{attrs:{loading:e.delLoading,type:"primary",size:"mini"},on:{click:function(t){return e.delCode(a.row)}}},[e._v("确定")])],1),t("el-button",{attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),t("Page",{attrs:{size:e.pageSize,current:e.current,pageTotal:e.total},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),t("StoreForm",{ref:"storeform"})],1)},s=[],r=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"code-form",attrs:{"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,top:"50px","el-dialog":"",visible:e.dialogVisible,"append-to-body":"",width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",staticClass:"formAdd",attrs:{model:e.form,rules:e.rules,"label-width":"40px"}},[t("el-row",[t("el-col",{staticStyle:{margin:"20px 20px",color:"#86909c"},attrs:{span:5}},[t("el-form-item",{attrs:{label:"ID",prop:"id"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini","allow-create":"",filterable:""},on:{change:e.idChange},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}},e._l(e.idList,(function(e,a){return t("el-option",{key:a,attrs:{value:e,label:e}})})),1)],1),t("el-form-item",{attrs:{label:"描述",prop:"desc"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入描述"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提交")])],1)],1),t("div",{staticStyle:{height:"20px","text-align":"right",padding:"5px"}},[t("i",{staticClass:"fa fa-close",staticStyle:{margin:"0 5px 0 10px",color:"#9e9e9e",cursor:"pointer"},on:{click:e.storeCancel}})]),t("div",{ref:"generateId",staticClass:"code-editor"})],1)],1),t("div",{attrs:{slot:"title"},slot:"title"})],1)},o=[],l=a(91938),n=a(53239),d=a.n(n),c=(a(83734),a(70790),a(37336),a(58119),a(55259)),u=a.n(c),h=a(6201),m=a.n(h),f=a(74358),p=a.n(f);d().config.setModuleUrl("ace/mode/lua_worker",u()),d().config.setModuleUrl("ace/mode/lua_worker",u()),d().config.setModuleUrl("ace/mode/css_worker",m()),d().config.setModuleUrl("ace/keyboard/vim",p());var g={name:"addForm",components:{IconSelect:l.Z},props:{isAdd:Boolean},data(){return{idList:["startup.template","startup.default","alert.dong.template","alert.email.template","alert.detail.template","event.max_age"],form:{id:"",value:"",desc:"",version:0},dialogVisible:!1,dialogValue:"",rules:{},editor:""}},updated(){var e=this;e.editor=d().edit(this.$refs.generateId,{keyboardHandler:"ace/keyboard/vim",enableSnippets:!0,enableLiveAutocompletion:!0,enableBasicAutocompletion:!0,mode:"ace/mode/lua",theme:"ace/theme/dracula",fontSize:12,tabSize:4,value:this.dialogValue,selectionStyle:"text'",showLineNumbers:!0,showGutter:!0,showPrintMargin:!0,printMarginColumn:170}),e.editor.getSession().on("change",(function(t){e.form.value=e.editor.getValue(this.dialogValue)}))},methods:{storeCancel(){this.dialogVisible=!1,this.form={},this.dialogValue="",this.editor.setValue(this.dialogValue)},idChange(){this.$request.fetchGetStore(this.form.id).then((e=>{if(e.data.id){this.form=e.data;var t=a(19575).Base64;e.data.value&&(this.dialogValue=t.decode(e.data.value),this.editor.setValue(this.dialogValue))}}))},linkCompare(e){var t=this.linkArray.some((t=>{if(t.id===e.id)return!0}));return t},deleteLink(e){JSON.stringify(this.linkArray);var t=this.linkArray.indexOf(e);this.linkArray.splice(t,1)},pushLink(e){this.linkArray.push(e)},selected(e){this.form.icon=e,this.codeIcon=e},beforeRemove(e,t){return this.$confirm("确定移除 $ { file.name } ？")},filseSuccess(e,t){var a=this;if(e.raw){let t=new FileReader;t.onload=function(e){a.form.value=e.target.result},t.readAsText(e.raw)}},handleRemove(e,t){var a=this;a.form.value=""},handleExceed(e,t){this.$message.warning(`当前限制选择 3 个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+t.length} 个文件`)},handleClose(){this.dialogVisible=!1,this.form={}},onSubmit(e){this.isAdd&&this.$refs[e].validate((e=>{if(e){let e=a(19575).Base64;this.form.value=e.encode(this.form.value),this.$request.fetchPostStores(this.form).then((e=>{this.$parent.getStore(),this.dialogVisible=!1,this.editor.setValue(""),this.form={id:"",value:"",desc:"",version:0},this.$message({message:"新增成功",type:"success"})})).catch((e=>{this.$message.error(e.data)}))}})),this.$refs[e].validate((e=>{if(e){let e=a(19575).Base64;this.form.value=e.encode(this.form.value),this.$request.fetchPostStores(this.form).then((e=>{this.$parent.$parent.getStore(),this.dialogVisible=!1,this.dialogValue="",this.editor.setValue(""),this.form={id:"",value:"",desc:"",version:0},this.$message({message:"成功",type:"success"})})).catch((e=>{this.$message.error(e.data)}))}}))}},watch:{dialogValue:function(e){this.editor&&this.editor.setValue(e)}}},v=g,b=a(1001),y=(0,b.Z)(v,r,o,!1,null,"23b9fee5",null),S=y.exports,k=a(12037),_=(a(28451),{name:"index",components:{StoreForm:S,Page:k.Z},data(){return{storeData:[],current:1,pageSize:15,total:0,delLoading:!1}},mounted(){this.getStore()},methods:{getStore(){this.$request.fetchGetStores(this.current,this.pageSize).then((e=>{this.storeData=e.data.records;var t=a(19575).Base64;this.storeData.forEach((e=>{e.value=t.decode(e.value)})),this.total=e.data.total}))},addStore(){const e=this.$refs.storeform;e.dialogVisible=!0},editRoom(e){const t=this.$refs.storeform;t.dialogVisible=!0,t.dialogValue=e.value,t.form={id:e.id,value:e.value,desc:e.desc,version:e.version}},delCode(e){this.$request.fetchDelStore(e.id).then((()=>{this.$refs[e.id].doClose(),this.$message({message:"删除成功!!!",type:"success"}),this.getStore()}))},handleSizeChange(e){this.pageSize=e,this.getStore()},handleCurrentChange(e){this.current=e,this.getStore()}}}),w=_,x=(0,b.Z)(w,i,s,!1,null,"69182b15",null),C=x.exports}}]);