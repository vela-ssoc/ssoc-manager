"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[1626],{49236:function(t,e,i){i.d(e,{Z:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("detail",t._g(t._b({},"detail",t.$attrs,!1),t.$listeners))},l=[],s=i(50265),r={components:{detail:s.Z}},n=r,o=i(1001),c=(0,o.Z)(n,a,l,!1,null,null,null),d=c.exports},20039:function(t,e,i){i.d(e,{Z:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",[4===t.cvssScore||"紧急"===t.cvssScore?e("div",{staticStyle:{height:"24px",margin:"0 auto"}},[e("div",{staticClass:"severity-critical-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(0)]):t._e(),3===t.cvssScore||"高危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-high-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(1)]):t._e(),2===t.cvssScore||"中危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-medium-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(2)]):t._e(),1===t.cvssScore||"低危"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-low-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(3)]):t._e(),0===t.cvssScore||"无风险"===t.cvssScore?e("div",{staticStyle:{height:"24px"}},[e("div",{staticClass:"severity-no-bg text-pull"},[e("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[e("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._m(4)]):t._e()])},l=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("紧急")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("高危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("中危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("低危")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[t._v("无风险")])])])}],s={name:"CvssScore",props:["cvssScore"]},r=s,n=i(1001),o=(0,n.Z)(r,a,l,!1,null,"77d4d761",null),c=o.exports},80124:function(t,e,i){i.r(e),i.d(e,{default:function(){return F}});var a=function(){var t=this,e=t._self._c;return e("el-card",{staticClass:"contentCard_"},[t.chartShow?e("el-row",{attrs:{gutter:10}},[e("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:24}},[e("TaskCount",{attrs:{recentData:t.recentData},on:{selectChange:t.selectChange}})],1)],1):t._e(),t.riskShow?e("Risk",{on:{activeClick:t.activeClick,activechartShow:t.activechartShow}}):t._e(),t.attackShow?e("Attack",{on:{activeClick:t.activeClick,activechartShow:t.activechartShow}}):t._e()],1)},l=[],s=function(){var t=this,e=t._self._c;return e("span",[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard"},[t._v("配置维度统计")])])],1),e("div",{style:{float:"left",width:"100%",height:"200px"},attrs:{id:"risklvlEchart"}})],1),e("el-col",{attrs:{span:12}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard"},[t._v("风险级别统计")])])],1),e("div",{style:{float:"left",width:"100%",height:"200px"},attrs:{id:"riskstsEchart"}})],1)],1)],1)},r=[],n=i(84772),o={data(){return{countData:{},countLevel:{},riskstsData:{}}},created(){this.init()},methods:{init(){var t={group:"from_code",topn:5};this.$request.fetchGetPie(t).then((t=>{this.countData=t.data,this.initright()}));var e={group:"level",topn:5};this.$request.fetchGetPie(e).then((t=>{this.countLevel=t.data,this.initleft()}))},initright(){var t=[],e={};for(let s in this.countData.topn)e={name:this.countData.topn[s].name,value:this.countData.topn[s].count},t.push(e);this.countData.other>0&&(e={name:"other",value:this.countData.other,itemStyle:{color:"#D0C5C5FA"}},t.push(e));let i=0;t.forEach((function(t){i+=t.value}));var a={legend:{orient:"vertical",right:"15%",align:"left",top:"middle",itemWidth:10,itemHeight:13,icon:"circle",itemGap:20,data:t,formatter:function(e){let a=0;for(var l="",s=0;s<t.length;s++)t[s].name==e&&(a=(t[s].value/i*100).toFixed(2)+"%",l+="{a|"+e+"}| {b|"+a+"}{b|"+t[s].value+"}");return l},textStyle:{color:"#000",rich:{a:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20},b:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20}}}},tooltip:{trigger:"item"},series:[{type:"pie",data:t,center:["35%","50%"],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};const l=n.init(document.getElementById("risklvlEchart"));l.setOption(a),window.addEventListener("resize",(()=>{l.resize()}))},initleft(){var t=[],e={};for(let s in this.countLevel.topn)e={name:this.countLevel.topn[s].name,value:this.countLevel.topn[s].count},t.push(e);this.countLevel.other>0&&(e={name:"other",value:this.countLevel.other,itemStyle:{color:"#D0C5C5FA"}},t.push(e));let i=0;t.forEach((function(t){i+=t.value}));var a={legend:{orient:"vertical",right:"15%",align:"left",top:"middle",itemWidth:10,itemHeight:13,icon:"circle",itemGap:20,data:t,formatter:function(e){let a=0;for(var l="",s=0;s<t.length;s++)t[s].name==e&&(a=(t[s].value/i*100).toFixed(2)+"%",l+="{a|"+e+"}| {b|"+a+"}{b|"+t[s].value+"}");return l},textStyle:{color:"#000",rich:{a:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20},b:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20}}}},tooltip:{trigger:"item"},series:[{type:"pie",data:t,center:["35%","50%"],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};const l=n.init(document.getElementById("riskstsEchart"));l.setOption(a),window.addEventListener("resize",(()=>{l.resize()}))}}},c=o,d=i(1001),h=(0,d.Z)(c,s,r,!1,null,null,null),u=h.exports,p=(i(28451),function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{display:"flex","align-items":"flex-end","justify-content":"space-between"}},[e("div",{staticStyle:{flex:"1","margin-right":"10px","margin-bottom":"2px"}},[e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filtersQuery,callback:function(e){t.filtersQuery=e},expression:"filtersQuery"}})],1),e("div",[e("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:t.echartShow}},[t._v(t._s(!0===t.topEchartShow?"隐藏图表":"显示图表")+" ")]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.initRisk}},[t._v("刷新")]),e("el-dropdown",{staticStyle:{"margin-left":"7px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{"el-button":"",type:"primary",plain:"",size:"mini"}},[t._v(" 批量操作"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.actionType,(function(i,a){return e("el-dropdown-item",{key:a,nativeOn:{click:function(e){return t.bulkClick(i)}}},[t._v(" "+t._s(i)+" ")])})),1)],1),e("el-button-group",{staticStyle:{"margin-left":"7px","margin-top":"-1px"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("风险事件")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.attackShow}},[t._v("攻击统计")])],1)],1)]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:t.riskData,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[e("el-table-column",{attrs:{prop:"inet",label:"终端IP",width:"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(i.row)}}},[t._v(t._s(i.row.inet))])]}}])}),e("el-table-column",{attrs:{prop:"risk_type",label:"类型",width:"120"}}),e("el-table-column",{attrs:{prop:"risk_type",label:"产生时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t._f("date")(e.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),e("el-table-column",{attrs:{prop:"level",label:"等级",width:"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("CvssScore",{attrs:{cvssScore:t.row.level}})]}}])}),e("el-table-column",{attrs:{prop:"local_port",label:"本地端口",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.local_port)+" ")]}}])}),e("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remote_ip||"未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"region",label:"地理位置",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.region||"0|0|0|未知|未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"subject",label:"主题",width:"280","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"payload",label:"Payload","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"send_alert",label:"告警",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(!0===e.row.send_alert?"是":"否")+" ")]}}])}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.vulnDetailCilck(i.row)}}},[t._v("详情")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.kaifa}},[t._v("通知")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.kaifa}},[t._v("处理")])]}}])})],1),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.pageTotal},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"inetDrawer",attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1),e("ActionForm",{ref:"actionForm",attrs:{title:t.actionTitle,pageTotal:t.pageTotal,filters:t.filters,nodeData:t.riskData},on:{initRisk:t.initRisk,cancel:t.cancel}}),e("riskDetail",{ref:"riskDetailRef"})],1)}),f=[],v=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{"el-dialog":"","close-on-click-modal":!1,"before-close":t.handleClose,visible:t.actionDialog,title:t.title,"append-to-body":"",width:"500px"},on:{"update:visible":function(e){t.actionDialog=e}}},[t.filters.length>0?e("div",[t._l(t.nodeData,(function(i){return e("el-tag",{key:i.id,staticStyle:{"margin-right":"3px","margin-bottom":"3px"},attrs:{size:"mini",type:"彻底删除"===t.title||"逻辑删除"===t.title?"danger":"success"}},[t._v(t._s(i.inet)+" ")])})),t._v(" 等，共计 "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.pageTotal))]),t._v(" 条是否操作？ ")],2):e("div",[e("span",{staticStyle:{color:"red"}},[t._v("请输入筛选条件")])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.actionDialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v("确定")])],1)])},g=[],m={name:"actionForm",props:["title","pageTotal","filters","nodeData"],data(){return{actionDialog:!1,dataAction:[]}},methods:{handleClose(){this.actionDialog=!1,this.$emit("cancel")},onSubmit(){var t=this,e={filters:this.filters};"批量删除"===this.title?this.$request.fetchDeleteRisk(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)})):"批量忽略"===this.title?this.$request.fetchRiskIgnore(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)})):"批量处理"===this.title&&this.$request.fetchRiskProcess(e).then((e=>{this.$message({message:t.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((t=>{this.$message.error(t.data)}))}},watch:{nodeData:function(t){this.nodeData=t},filters:function(t){this.filters=t}}},y=m,_=(0,d.Z)(y,v,g,!1,null,"64c616c9",null),k=_.exports,S=i(20039),w=i(12037),b=i(49236),D=i(15246),C=i(24861),x={components:{Page:w.Z,CvssScore:S.Z,NodeDetail:b.Z,ActionForm:k,riskDetail:D.Z,filterOption:C.Z},name:"vuln",data(){return{actionTitle:"",nameIndex:"蜜罐",actionType:["批量删除","批量忽略","批量处理"],selectArray:[{model:"",placeholder:"风险类型",name:"risk_type",dataArray:[{key:"暴力破解",desc:"暴力破解"},{key:"病毒事件",desc:"病毒事件"},{key:"弱口令",desc:"弱口令"},{key:"数据爬虫",desc:"数据爬虫"},{key:"蜜罐应用",desc:"蜜罐应用"},{key:"web攻击",desc:"web攻击"},{key:"登录事件",desc:"登录事件"},{key:"监控事件",desc:"监控事件"}]}],riskData:[],riskLoading:!1,currentPage:1,pageSize:15,pageTotal:0,inet:"",startAt:null,endAt:null,filters:[{key:"risk_type",operator:"eq",value:"蜜罐应用"}],filtersQuery:[],vulnId:"",fromArray:[{value:"",label:"全部"},{value:"文件",label:"文件"},{value:"组件",label:"组件"}],searchData:"",vulnDetailShow:!1,vulnDetailData:{},condData:{},value:"",operator:"",field:"",ipTtitel:{},drawer:!1,directions:"rtl",topEchartShow:!1}},created(){this.initRisk(),this.getCond()},methods:{echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow")},cancel(){this.actionTitle=""},bulkClick(t){const e=this.$refs.actionForm;e.actionDialog=!0,this.actionTitle=t},attackShow(){this.$emit("activeClick",!1,!0)},drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(t){this.ipTtitel=t,this.drawer=!0},sheetode(){var t={filters:this.filters};this.$request.fetchSheetode(t).then((t=>{const e=document.createElement("a");let i=new Blob([t.data],{type:"text/csv"});e.style.display="none",e.href=URL.createObjectURL(i);let a=t.headers["content-disposition"].split("''");e.setAttribute("download",decodeURI(a[1])),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},getCond(){this.$request.fetchRisksCond().then((t=>{this.condData=t.data}))},delTag(t,e){this.filters.splice(e,1)},searchBasic(){this.filters.length=1,this.filters.push(...this.filtersQuery),this.currentPage=1,this.initRisk()},initRisk(){var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchRisks(t).then((t=>{this.riskData=t.data.records,this.pageTotal=t.data.total,this.riskLoading=!1})).catch((()=>{this.riskLoading=!1}))},vulnDetailCilck(t){this.$refs.riskDetailRef.openRiskDetail(t)},kaifa(){this.$message({message:"开发中！！！",type:"warning"})},handleSizeChange(t){this.pageSize=t,this.initRisk()},handleCurrentChange(t){this.currentPage=t,this.initRisk()}}},z=x,L=(0,d.Z)(z,p,f,!1,null,"0ecb0586",null),R=L.exports,P=function(){var t=this,e=t._self._c;return e("div",[e("el-row",[e("el-col",{staticStyle:{"text-align":"left"},attrs:{xs:24,sm:24,md:24,lg:15,xl:15}},[e("filterOption",{ref:"selectSearchRef",attrs:{options:t.condData.conditions||[]},on:{change:t.searchBasic},scopedSlots:t._u([{key:"textSlot",fn:function(){return[t._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:t.filtersQuery,callback:function(e){t.filtersQuery=e},expression:"filtersQuery"}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{xs:24,sm:24,md:24,lg:9,xl:9}},[e("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:t.echartShow}},[t._v(t._s(!0===t.topEchartShow?"隐藏图表":"显示图表")+" ")]),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.initAttact}},[t._v("刷新")]),e("el-button-group",[e("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.riskShow}},[t._v("风险事件")]),e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("攻击统计")])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:t.riskData.records,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[e("el-table-column",{attrs:{prop:"subject",label:"类型"}}),e("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remote_ip||"未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"count",label:"次数"}}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.evnetDetail(i.row)}}},[t._v("事件详情")])]}}])})],1),e("Page",{attrs:{size:t.riskData.size,current:t.riskData.current,pageTotal:t.riskData.total},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"vulnDrawer",attrs:{title:"事件详情",visible:t.detailShow,direction:"rtl",size:"70%"},on:{"update:visible":function(e){t.detailShow=e},close:t.vulnmDetailCancel}},[e("div",{staticStyle:{padding:"0 10px"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.detalLoading,expression:"detalLoading"}],attrs:{data:t.detailData.records,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[e("el-table-column",{attrs:{prop:"inet",label:"终端IP"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(i.row)}}},[t._v(t._s(i.row.inet))])]}}])}),e("el-table-column",{attrs:{prop:"risk_type",label:"类型"}}),e("el-table-column",{attrs:{prop:"level",label:"等级"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("CvssScore",{attrs:{cvssScore:t.row.level}})]}}])}),e("el-table-column",{attrs:{prop:"local_port",label:"本地端口"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.local_port)+" ")]}}])}),e("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remote_ip||"未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"region",label:"地理位置"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.region||"0|0|0|未知|未知")+" ")]}}])}),e("el-table-column",{attrs:{prop:"subject",label:"主题"}}),e("el-table-column",{attrs:{prop:"payload",label:"Payload","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"send_alert",label:"告警"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(!0===e.row.send_alert?"是":"否")+" ")]}}])}),e("el-table-column",{attrs:{prop:"occur_at",label:"产生时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("date")(e.row.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])})],1),e("Page",{attrs:{size:t.detailData.size,current:t.detailData.current,pageTotal:t.detailData.total},on:{handleSizeChange:t.detailhandleSizeChange,handleCurrentChange:t.detailhandleCurrentChange}})],1)]),e("el-drawer",{attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1)],1)},$=[],T={name:"risk",components:{Page:w.Z,CvssScore:S.Z,NodeDetail:b.Z,filterOption:C.Z},data(){return{nameIndex:"蜜罐",groupArray:[{key:"risk_type",desc:"类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"任务名称"}],condData:{},riskLoading:!1,selectArray:[{model:"",placeholder:"风险类型",name:"risk_type",dataArray:[{key:"暴力破解",desc:"暴力破解"},{key:"病毒事件",desc:"病毒事件"},{key:"弱口令",desc:"弱口令"},{key:"数据爬虫",desc:"数据爬虫"},{key:"蜜罐应用",desc:"蜜罐应用"},{key:"web攻击",desc:"web攻击"},{key:"登录事件",desc:"登录事件"},{key:"监控事件",desc:"监控事件"}]}],riskData:{},currentPage:1,pageSize:15,detailcurrentPage:1,detailpageSize:15,detailShow:!1,vulnDetailLoading:!1,vulnDetailData:{},filters:[{key:"risk_type",operator:"eq",value:"蜜罐应用"}],filtersQuery:[],detailData:{},detalLoading:!1,activeDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",topEchartShow:!1}},created(){this.searchBasic(),this.getCond()},methods:{echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow")},drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(t){this.ipTtitel=t,this.drawer=!0},evnetDetail(t){this.activeDetailData=t,this.detailShow=!0;var e={current:this.detailcurrentPage,size:this.detailpageSize,filters:[{key:"remote_ip",value:t.remote_ip,operator:"eq"},{key:"subject",value:t.subject,operator:"eq"}]};this.detalLoading=!0,this.$request.fetchRisks(e).then((t=>{this.detailData=t.data,this.detalLoading=!1}))},riskShow(){this.$emit("activeClick",!0,!1)},initAttact(){var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchAttack(t).then((t=>{this.riskData=t.data,this.riskLoading=!1}))},getCond(){this.$request.fetchRisksCond().then((t=>{this.condData=t.data}))},searchBasic(){this.filters.length=1,this.filters.push(...this.filtersQuery),this.currentPage=1,this.initAttact()},sheetode(){var t={filters:this.filters};this.$request.fetchSheetode(t).then((t=>{const e=document.createElement("a");let i=new Blob([t.data],{type:"text/csv"});e.style.display="none",e.href=URL.createObjectURL(i);let a=t.headers["content-disposition"].split("''");e.setAttribute("download",decodeURI(a[1])),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},handleSizeChange(t){this.pageSize=t,this.initAttact()},handleCurrentChange(t){this.currentPage=t,this.initAttact()},detailhandleSizeChange(t){this.detailpageSize=t,this.evnetDetail(this.activeDetailData)},detailhandleCurrentChange(t){this.detailcurrentPage=t,this.evnetDetail(this.activeDetailData)},vulnmDetailCancel(){this.detailShow=!1,this.activeDetailData={}}}},A=T,Z=(0,d.Z)(A,P,$,!1,null,"78db5a81",null),E=Z.exports,I={components:{Risk:R,Attack:E,TaskCount:u},name:"vuln",data(){return{riskShow:!0,attackShow:!1,recentData:[],chartShow:!1}},methods:{activeClick(t,e){this.chartShow=!1,this.riskShow=t,this.attackShow=e},activechartShow(){this.chartShow=!this.chartShow},selectChange(t){this.getRecent(t)},getRecent(t){this.$request.fetchRevent(t).then((t=>{this.recentData=t.data,this.recentShow=!0}))}}},M=I,q=(0,d.Z)(M,a,l,!1,null,"695e892a",null),F=q.exports},15246:function(t,e,i){i.d(e,{Z:function(){return h}});var a=function(){var t=this,e=t._self._c;return e("el-drawer",{staticClass:"vulnDrawer",attrs:{title:t.riskData.inet,visible:t.visible,direction:"rtl",size:"50%"},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticStyle:{padding:"0 20px"}},[e("el-descriptions",{attrs:{column:2,labelStyle:{color:"#000","font-weight":600}}},[e("el-descriptions-item",{attrs:{label:"主题",span:2}},[t._v(" "+t._s(t.riskData.subject||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"等级"}},["无风险"===t.riskData.level?e("el-tag",{attrs:{type:"success",size:"mini"}},[e("span",[t._v("无风险")])]):t._e(),"低危"===t.riskData.level?e("el-tag",{attrs:{type:"",size:"mini"}},[e("span",[t._v("低危")])]):t._e(),"中危"===t.riskData.level?e("el-tag",{staticStyle:{color:"#adad24","background-color":"#ffff0161","border-color":"#d9d92461"},attrs:{size:"mini"}},[e("span",[t._v("中危")])]):t._e(),"高危"===t.riskData.level?e("el-tag",{attrs:{type:"warning",size:"mini"}},[e("span",[t._v("高危")])]):t._e(),"紧急"===t.riskData.level?e("el-tag",{attrs:{type:"danger",size:"mini"}},[e("span",[t._v("紧急")])]):t._e(),e("el-tag",{staticStyle:{"margin-left":"3px"},attrs:{size:"mini",type:t.riskData.send_alert?"warning":"danger"}},[t._v(" "+t._s(t.riskData.send_alert?"已告警":"未告警")+" ")])],1),e("el-descriptions-item",{attrs:{label:"类型"}},[t._v(" "+t._s(t.riskData.risk_type||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"源IP"}},[t._v(" "+t._s(t.riskData.local_ip||"")+":"+t._s(t.riskData.local_port)+" ")]),e("el-descriptions-item",{attrs:{label:"外部IP"}},[t._v(" "+t._s(t.riskData.remote_ip||"")+":"+t._s(t.riskData.remote_port)+" ")]),e("el-descriptions-item",{attrs:{label:"任务名称"}},[t._v(" "+t._s(t.riskData.from_code||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"地理位置"}},[t._v(" "+t._s(t.riskData.region||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"创建时间"}},[t._v(" "+t._s(t.riskData.created_at||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"产生时间"}},[t._v(" "+t._s(t.riskData.occur_at||"--")+" ")]),e("el-descriptions-item",{attrs:{label:"参考信息",span:2}},[e("jsonView",{attrs:{data:t.riskData.referenceHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"攻击载荷",span:2}},[e("jsonView",{attrs:{data:t.riskData.payloadHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"template",span:2}},[e("jsonView",{attrs:{data:t.riskData.templateHJS||"--"}})],1),e("el-descriptions-item",{attrs:{label:"metadata",span:2}},[e("jsonView",{attrs:{data:t.riskData.metadata||"--",beauty:!1}})],1)],1)],1)])},l=[],s=i(10736);function r(t){t=decodeURIComponent(t);try{return JSON.parse(t)}catch(e){return t}}var n={components:{jsonView:s.Z},data(){return{riskData:{inet:null,level:null,send_alert:null,risk_type:null,subject:null,local_ip:null,local_port:null,remote_ip:null,remote_port:null,from_code:null,region:null,created_at:null,occur_at:null,reference:null,payload:null,payloadHJS:null,referenceHJS:null,metadata:null,template:null,templateHJS:null},visible:!1}},methods:{openRiskDetail(t){this.$set(this,"riskData",t),this.riskData.payloadHJS=r(this.riskData.payload),this.riskData.referenceHJS=r(this.riskData.reference),this.riskData.templateHJS=r(this.riskData.template),this.visible=!0}}},o=n,c=i(1001),d=(0,c.Z)(o,a,l,!1,null,"2786d9ce",null),h=d.exports}}]);