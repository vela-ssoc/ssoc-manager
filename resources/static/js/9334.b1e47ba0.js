"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[9334],{65524:function(e,t,i){i.d(t,{A:function(){return y}});var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{display:"flex","flex-wrap":"wrap","align-items":"center"}},[e._t("prefix"),e._l(e.tabs,(function(i,a){return t("el-popover",{key:a,attrs:{"popper-class":"filterOptionsPopover",placement:e.placement,width:"280",trigger:"click"},on:{show:function(t){return e.popovershow(a)}},scopedSlots:e._u([{key:"reference",fn:function(){return[t("span",[0===a?t("el-button",{staticClass:"buttonsearch",staticStyle:{"margin-right":"3px"},attrs:{size:"mini"}},[e._t("textSlot",(function(){return[e._v("添加条件")]}))],2):[t("span",{key:a,staticStyle:{margin:"2px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff",display:"inline-block"},on:{click:function(t){return e.editTag(t,i,a-1)}}},[e._v(" "+e._s(i.keyDesc)+" "+e._s(i.operatorDesc)+" "+e._s(i.valueDesc)+" "),i.clearable?t("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.delTag(i,a-1)}}}):e._e()])]],2)]},proxy:!0}],null,!0),model:{value:i.show,callback:function(t){e.$set(i,"show",t)},expression:"item.show"}},[t("el-form",{ref:"formRef",refInFor:!0,attrs:{model:e.form,"label-position":"right","label-width":"70px"}},[t("el-form-item",{attrs:{label:"关键字",prop:"key",rules:e.required}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",size:"mini"},on:{change:e.selectField},model:{value:e.form.key,callback:function(t){e.$set(e.form,"key",t)},expression:"form.key"}},e._l(e.options,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1)],1),t("el-form-item",{attrs:{label:"操作符",prop:"operator",rules:e.required}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini"},model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}},e._l(e.selectFieldDerive.operatorArray,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1)],1),t("el-form-item",{attrs:{label:"值",rules:e.required,prop:"value"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:["datetime","time"].includes(e.selectFieldDerive.valueType),expression:"['datetime', 'time'].includes(selectFieldDerive.valueType)"}],on:{click:function(e){e.stopPropagation()}}},[t("el-date-picker",{ref:"dateRef",refInFor:!0,staticStyle:{width:"100%"},attrs:{clearable:"","popper-class":"filterDate",teleported:!1,"append-to-body":!1,type:"datetime",pickerOptions:e.pickerOptions,placeholder:"选择时间",size:"mini"},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1),["datetime","time"].includes(e.selectFieldDerive.valueType)?e._e():[e.selectFieldDerive.isEnum?t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:"",multiple:"in"===e.form.operator||"notin"===e.form.operator,"collapse-tags":""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}},e._l(e.selectFieldDerive.valueArray,(function(e,i){return t("el-option",{key:i,attrs:{value:e.key,label:e.desc}})})),1):[e.suggestOptions&&e.suggestOptions[e.form.key]?t("el-autocomplete",{staticStyle:{width:"100%"},attrs:{size:"mini","fetch-suggestions":e.querySearch,clearable:""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}}):t("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:""},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})]]],2),t("el-form-item",[t("el-button",{staticClass:"buttonsearch",attrs:{size:"mini"},on:{click:function(t){return e.confirm(a)}}},[e._v("确定")])],1)],1)],1)}))],2)},s=[],l=i(95093),r=i.n(l);class n{constructor(e){this.key=e?.key,this.operator=e?.operator,this.value=e?.value}}const o=r()().startOf("days"),c=r()().startOf("days").subtract(1,"days"),d=r()().startOf("days").subtract(7,"days"),u=r()().startOf("days").subtract(15,"days"),p=r()().startOf("days").subtract(30,"days"),h={[o]:"今天",[c]:"昨天",[d]:"七天前",[u]:"十五天前",[p]:"三十天前"};var f={props:{value:{type:Array,default:()=>[]},options:{default:()=>[]},placement:{default:"top"},initData:{type:Object,default:null},suggestOptions:{default:()=>({})},multiCondition:{default:!0}},created(){},mounted(){},data(){return{moment:Object.freeze(r()),form:new n,show:!1,editIdx:-1,pickerOptions:{disabledDate(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(e){e.$emit("pick",o)}},{text:"昨天",onClick(e){e.$emit("pick",c)}},{text:"七天前",onClick(e){e.$emit("pick",d)}},{text:"十五天前",onClick(e){e.$emit("pick",u)}},{text:"三十天前",onClick(e){e.$emit("pick",p)}}]},required:{required:!0,message:"请检查必填项",trigger:["blur","change"]}}},computed:{filters:{get(){return this.value?.map((e=>this.getSelectItem(e)))},set(e){this.$emit("input",e),this.$emit("change",e)}},selectFieldDerive(){var e=this.options.findIndex((e=>e.key===this.form.key));return{operatorArray:this.options?.[e]?.operators||[],isEnum:!!this.options?.[e]?.enums,valueArray:this.options?.[e]?.enums||[],valueType:this.options?.[e]?.type}},tabs(){return[{show:!1},...this.filters]}},methods:{querySearch(e,t){var i=this.suggestOptions?.[this.form.key],a=e?i.filter((t=>-1!==String(t).toLowerCase().indexOf(e.toLowerCase()))):i;t(a.map((e=>({value:e}))))},selectField(e){this.form.value=null,this.$nextTick((()=>{this.form.operator=this.selectFieldDerive.operatorArray.some((e=>"like"===e.key))?"like":this.selectFieldDerive.operatorArray?.[0]?.key}))},selectOperator(e){this.form.value=null},async confirm(e){try{if(await(this.$refs.formRef?.[e].validate().catch((()=>{throw"请检查必填项"}))),this.show=!1,this.editIdx>=0&&this.editIdx<this.filters.length){const e=this.filters||[];e[this.editIdx]=this.valueDecode(Object.assign(e[this.editIdx],this.form)),this.filters=[...e],this.editIdx=-1}else this.pushFilter(this.form)}catch(t){this.$message.warning(t)}},valueDecode(e){const t=this.options?.find((t=>t.key===e.key));return t.enum&&e.value&&("in"===e.operator||"notin"===e.operator)&&Array.isArray(e.value)?{...e,value:e.value.join(",")}:{...e}},valueEncode(e){const t=this.options?.find((t=>t.key===e.key));return t?.enum&&e.value&&("in"===e.operator||"notin"===e.operator)&&(e.value=e.value?.split(",")||e.value),e},pushFilter(e){const t=this.filters||[],i=t.findIndex((t=>t.key===e.key)),a=t[i];e=this.valueDecode(e),a?(null===e.value||void 0===e||""===e?t.splice(i,1):Object.assign(a,e),this.filters=[...t]):null!==e.value&&void 0!==e&&""!==e&&(!this.multiCondition&&t.length>0&&(t.length=0),this.filters=[...t,{...e}])},getSelectItem({key:e,operator:t,value:i,clearable:a=!0,disabled:s=!1}){const l=this.options?.find((t=>t.key===e)),n=l?.operators,o=l?.enums||[],c=()=>{const a=this.valueEncode({key:e,operator:t,value:i})?.value;if("time"===l?.type){const e=r()(i);return e in h?h[e]:e.format("YYYY-MM-DD HH:mm:ss")}return l?.enum?"in"===t||"notin"===t?a?.map((e=>o.find((t=>t.key===e))?.desc))?.join(",")||a:o.find((e=>e.key===a))?.desc:i};return{key:e,keyDesc:l?.desc,value:i,valueDesc:c(),show:!1,valueType:l?.type,operator:t,clearable:a,disabled:s,operatorDesc:n?.find((e=>e.key===t))?.desc}},delTag(e,t){const i=this.filters||[];i.splice(t,1),this.filters=i},editTag(e,t,i){t.disabled?e.stopPropagation():(this.editIdx=i,this.form=new n(this.valueEncode(t)))},popovershow(e){this.$refs.dateRef[e].placement="right"}}},m=f,v=i(81656),g=(0,v.A)(m,a,s,!1,null,"84dd770c",null),y=g.exports},23947:function(e,t,i){i.d(t,{A:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("detail",e._g(e._b({},"detail",e.$attrs,!1),e.$listeners))},s=[],l={components:{detail:()=>Promise.all([i.e(9534),i.e(5358),i.e(6131),i.e(4461),i.e(6),i.e(9141),i.e(9121),i.e(8271),i.e(2376)]).then(i.bind(i,88271))}},r=l,n=i(81656),o=(0,n.A)(r,a,s,!1,null,null,null),c=o.exports},92161:function(e,t,i){i.d(t,{A:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",{class:"事件详情"===e.nameShow?"pageClass":"",staticStyle:{height:"20px","padding-top":"10px"}},[t("span",{staticStyle:{display:"inline-block","font-size":"13px","min-width":"35.5px",height:"28px","line-height":"30px","vertical-align":"top","box-sizing":"border-box",float:"right"}},[e._v("共"+e._s(e.pageTotal)+"条")]),t("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"jumper,sizes,prev, pager, next","page-size":e.size||15,"current-page":e.pageCurrent,total:e.pageTotal,"page-sizes":e.pageSizeArray||[15,30,45]},on:{"update:currentPage":function(t){e.pageCurrent=t},"update:current-page":function(t){e.pageCurrent=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},s=[],l={name:"page",props:{pageSizeArray:Array,size:Number,pageTotal:Number,current:Number,nameShow:String},data(){return{pageCurrent:this.current}},methods:{handleSizeChange(e){this.$emit("handleSizeChange",e)},handleCurrentChange(e){this.$emit("handleCurrentChange",e)}},watch:{current:function(e){this.pageCurrent=e}}},r=l,n=i(81656),o=(0,n.A)(r,a,s,!1,null,"277403d7",null),c=o.exports},77538:function(e,t,i){i.d(t,{A:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",[4===e.cvssScore||"紧急"===e.cvssScore?t("div",{staticStyle:{height:"24px",margin:"0 auto"}},[t("div",{staticClass:"severity-critical-bg text-pull"},[t("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[t("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),e._m(0)]):e._e(),3===e.cvssScore||"高危"===e.cvssScore?t("div",{staticStyle:{height:"24px"}},[t("div",{staticClass:"severity-high-bg text-pull"},[t("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[t("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),e._m(1)]):e._e(),2===e.cvssScore||"中危"===e.cvssScore?t("div",{staticStyle:{height:"24px"}},[t("div",{staticClass:"severity-medium-bg text-pull"},[t("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[t("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),e._m(2)]):e._e(),1===e.cvssScore||"低危"===e.cvssScore?t("div",{staticStyle:{height:"24px"}},[t("div",{staticClass:"severity-low-bg text-pull"},[t("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[t("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),e._m(3)]):e._e(),0===e.cvssScore||"无风险"===e.cvssScore?t("div",{staticStyle:{height:"24px"}},[t("div",{staticClass:"severity-no-bg text-pull"},[t("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[t("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),e._m(4)]):e._e()])},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[t("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[t("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[e._v("紧急")])])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[t("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[t("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[e._v("高危")])])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[t("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[t("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[e._v("中危")])])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[t("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[t("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[e._v("低危")])])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[t("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[t("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[e._v("无风险")])])])}],l={name:"CvssScore",props:["cvssScore"]},r=l,n=i(81656),o=(0,n.A)(r,a,s,!1,null,"77d4d761",null),c=o.exports},48654:function(e,t,i){i.d(t,{A:function(){return h}});var a=function(){var e=this,t=e._self._c;return t("div",[t("el-row",[t("el-col",{staticStyle:{"text-align":"left"},attrs:{xs:24,sm:24,md:24,lg:15,xl:15}},[t("filterOption",{ref:"selectSearchRef",attrs:{options:e.condData.conditions||[]},on:{change:e.searchBasic},scopedSlots:e._u([{key:"textSlot",fn:function(){return[e._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:e.filters,callback:function(t){e.filters=t},expression:"filters"}})],1),t("el-col",{staticStyle:{"text-align":"right"},attrs:{xs:24,sm:24,md:24,lg:9,xl:9}},[e._t("showChartBtn"),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.click}},[e._v("一键操作")]),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.initAttact}},[e._v("刷新")]),t("el-button-group",{staticStyle:{"margin-left":"7px","margin-top":"-1px"}},[t("el-button",{attrs:{type:"info",size:"mini"},on:{click:e.riskShow}},[e._v("风险事件")]),t("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("攻击统计")])],1)],2)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:e.riskData.records,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[t("el-table-column",{attrs:{prop:"subject",label:"主题"}}),t("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.remote_ip||"未知")+" ")]}}])}),t("el-table-column",{attrs:{prop:"count",label:"次数"}}),t("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.evnetDetail(i.row)}}},[e._v("事件详情")])]}}])})],1),t("Page",{attrs:{size:e.riskData.size,current:e.riskData.current,pageTotal:e.riskData.total},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),t("el-drawer",{staticClass:"vulnDrawer",attrs:{title:"事件详情",visible:e.detailShow,direction:"rtl",size:"90%"},on:{"update:visible":function(t){e.detailShow=t},close:e.vulnmDetailCancel}},[t("div",{staticStyle:{padding:"0 10px"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.detalLoading,expression:"detalLoading"}],attrs:{data:e.detailData.records,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"}},[t("el-table-column",{attrs:{prop:"inet",label:"终端IP",width:"120"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.innetactive(i.row)}}},[e._v(e._s(i.row.inet))])]}}])}),t("el-table-column",{attrs:{prop:"risk_type",label:"类型",width:"120"}}),t("el-table-column",{attrs:{prop:"level",label:"等级",width:"100"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("CvssScore",{attrs:{cvssScore:e.row.level}})]}}])}),t("el-table-column",{attrs:{prop:"local_port",label:"本地端口",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.local_port)+" ")]}}])}),t("el-table-column",{attrs:{prop:"remote_ip",label:"远程IP",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.remote_ip||"未知")+" ")]}}])}),t("el-table-column",{attrs:{prop:"region",label:"地理位置",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.region||"0|0|0|未知|未知")+" ")]}}])}),t("el-table-column",{attrs:{prop:"subject",label:"主题"}}),t("el-table-column",{attrs:{prop:"payload",label:"Payload","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"send_alert",label:"告警",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(!0===t.row.send_alert?"是":"否")+" ")]}}])}),t("el-table-column",{attrs:{prop:"occur_at",label:"产生时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("date")(t.row.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])})],1),t("Page",{attrs:{size:e.detailPage.pageSize,current:e.detailPage.current,pageTotal:e.detailData.total},on:{handleSizeChange:e.detailhandleSizeChange,handleCurrentChange:e.detailhandleCurrentChange}})],1)]),t("el-drawer",{attrs:{title:e.ipTtitel.inet,visible:e.drawer,direction:e.directions,"before-close":e.drawerClose,size:"90%"},on:{"update:visible":function(t){e.drawer=t}}},[t("node-detail",{ref:"ipDetail",attrs:{minionId:e.ipTtitel.minion_id}})],1)],1)},s=[],l=i(92161),r=i(77538),n=i(23947),o=i(65524),c={name:"risk",props:{initFilters:{type:Array,default:()=>[]}},components:{filterOption:o.A,Page:l.A,CvssScore:r.A,NodeDetail:n.A},data(){return{groupArray:[{key:"subject",desc:"主题"},{key:"risk_type",desc:"类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"任务名称"}],condData:{},riskLoading:!1,selectArray:[{model:"",placeholder:"风险类型",name:"risk_type",dataArray:[{key:"暴力破解",desc:"暴力破解"},{key:"病毒事件",desc:"病毒事件"},{key:"弱口令",desc:"弱口令"},{key:"数据爬虫",desc:"数据爬虫"},{key:"蜜罐应用",desc:"蜜罐应用"},{key:"web攻击",desc:"web攻击"},{key:"登录事件",desc:"登录事件"},{key:"监控事件",desc:"监控事件"}]}],riskData:{},currentPage:1,pageSize:15,detailcurrentPage:1,detailpageSize:15,detailShow:!1,vulnDetailLoading:!1,vulnDetailData:{},filters:[...this.initFilters||[]],detailData:{},detailPage:{pageSize:15,current:1},detalLoading:!1,activeDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",topEchartShow:!1}},created(){this.initAttact(),this.getCond()},methods:{echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow",this.topEchartShow)},drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(e){this.ipTtitel=e,this.drawer=!0},evnetDetail(e){if(!e.remote_ip)return this.$message.warning("未知IP无法查询详情");this.activeDetailData=e,this.detailShow=!0;var t={current:this.detailPage.current,size:this.detailPage.pageSize,filters:[{key:"remote_ip",value:e.remote_ip,operator:"eq"},{key:"subject",value:e.subject,operator:"eq"}]};this.detalLoading=!0,this.$request.fetchRisks(t).then((e=>{this.detailData=e.data,this.detalLoading=!1}))},riskShow(){this.$emit("activeClick",!0,!1,!1)},selectActive(e){this.$emit("activeClick",!1,!1,!0,e)},initAttact(){var e={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchAttack(e).then((e=>{this.riskData=e.data,this.riskLoading=!1}))},getCond(){this.$request.fetchRisksCond().then((e=>{this.condData=e.data}))},searchBasic(e){this.currentPage=1,this.initAttact()},sheetode(){var e={filters:this.filters};this.$request.fetchSheetode(e).then((e=>{const t=document.createElement("a");let i=new Blob([e.data],{type:"text/csv"});t.style.display="none",t.href=URL.createObjectURL(i);let a=e.headers["content-disposition"].split("''");t.setAttribute("download",decodeURI(a[1])),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))},handleSizeChange(e){this.pageSize=e,this.initAttact()},handleCurrentChange(e){this.currentPage=e,this.initAttact()},detailhandleSizeChange(e){this.detailpageSize=e,this.evnetDetail(this.activeDetailData)},detailhandleCurrentChange(e){this.detailcurrentPage=e,this.evnetDetail(this.activeDetailData)},vulnmDetailCancel(){this.detailShow=!1,this.activeDetailData={}},click(){this.$message({message:"开发中！！！",type:"warning"})}}},d=c,u=i(81656),p=(0,u.A)(d,a,s,!1,null,"34afe398",null),h=p.exports},792:function(e,t,i){i.d(t,{A:function(){return A}});var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"100%"}},[t("div",{staticStyle:{display:"flex","align-items":"flex-end","justify-content":"space-between"}},[t("div",{staticStyle:{flex:"1",display:"flex","align-items":"flex-end","margin-bottom":"1px","margin-right":"10px"}},[t("span",{staticClass:"buttonsearch_2",staticStyle:{margin:"0 5px 0 0"},attrs:{size:"mini"},on:{click:function(t){e.tagShow=!e.tagShow}}},[t("i",{class:e.tagShow?"el-icon-s-unfold":"el-icon-s-fold",staticStyle:{"font-size":"25px",color:"#939597",transform:"translateY(-1px)"}})]),t("filterOption",{ref:"selectSearchRef",attrs:{options:e.condData.conditions||[]},on:{change:e.searchBasic},scopedSlots:e._u([{key:"textSlot",fn:function(){return[e._v(" 添加过滤条件 ")]},proxy:!0}]),model:{value:e.filters,callback:function(t){e.filters=t},expression:"filters"}})],1),t("div",[e._t("showChartBtn"),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.sheetode}},[e._v("导出"),t("i",{staticClass:"el-icon-upload2 el-icon--right"})]),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.click}},[e._v("一键操作")]),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.initRisk}},[e._v("刷新")]),t("el-dropdown",{staticStyle:{"margin-left":"7px"},attrs:{trigger:"click"}},[t("el-button",{attrs:{"el-button":"",type:"primary",plain:"",size:"mini"}},[e._v(" 批量操作"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.actionType,(function(i,a){return t("el-dropdown-item",{key:a,nativeOn:{click:function(t){return e.bulkClick(i)}}},[e._v(" "+e._s(i)+" ")])})),1)],1),t("el-button-group",{staticStyle:{"margin-top":"-2px","margin-left":"7px"}},[t("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("风险事件")]),t("el-button",{attrs:{type:"info",size:"mini"},on:{click:e.attackShow}},[e._v("攻击统计")])],1)],2)]),t("div",{staticStyle:{display:"flex","margin-top":"5px",width:"100%"}},[t("leftMenu",{directives:[{name:"show",rawName:"v-show",value:e.tagShow,expression:"tagShow"}],attrs:{"active-option":e.curtag,filters:e.filters},on:{change:e.leftChange},model:{value:e.leftMenuValue,callback:function(t){e.leftMenuValue=t},expression:"leftMenuValue"}}),t("div",{style:e.tagShow?"width: calc(100% - 300px)":"width:100%"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:e.riskData,"header-cell-style":{color:"#606266",background:"#f5f7fa"},stripe:"",align:"center"},on:{"row-dblclick":e.riskDetailCilck}},[e._l(e.activeUsers,(function(i,a){return t("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"",label:i.lable,prop:i.key,width:i.width},scopedSlots:e._u([{key:"default",fn:function(a){return["inet"===i.key?t("span",[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.innetactive(a.row)}}},[e._v(e._s(a.row.inet))])],1):"level"===i.key?t("span",[t("CvssScore",{attrs:{cvssScore:a.row.level}})],1):"region"===i.key?t("span",[e._v(" "+e._s(a.row.region||"0|0|0|未知|未知")+" ")]):"remote_ip"===i.key?t("span",[e._v(" "+e._s(a.row.remote_ip||"未知")+" ")]):"send_alert"===i.key?t("span",[e._v(" "+e._s(!0===a.row[i.key]?"是":"否")+" ")]):"occur_at"===i.key?t("span",[e._v(" "+e._s(e._f("date")(a.row.occur_at,"yyyy-MM-dd hh:mm:ss"))+" ")]):"created_at"===i.key?t("span",[e._v(" "+e._s(e._f("date")(a.row.created_at,"yyyy-MM-dd hh:mm:ss"))+" ")]):"payload"===i.key||"reference"===i.key?t("pre",[e._v(e._s(a.row.payload))]):t("span",[e._v(" "+e._s(a.row[i.key])+" ")])]}}],null,!0)})})),t("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.riskDetailCilck(i.row)}}},[e._v("详情")]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.riskNoticeCilck()}}},[e._v("通知")]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.kaifa}},[e._v("处理")])]}}])},[t("template",{slot:"header"},[t("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[e._l(e.tableHeader,(function(i,a){return t("div",{key:a},[t("el-checkbox",{attrs:{label:i.title},model:{value:e.colOptions,callback:function(t){e.colOptions=t},expression:"colOptions"}})],1)})),t("div",{attrs:{slot:"reference"},slot:"reference"},[e._v(" 操作"),t("i",{staticClass:"el-icon-setting",staticStyle:{"padding-left":"10px"}})])],2)],1)],2)],2),t("Page",{attrs:{size:e.pageSize,current:e.currentPage,pageTotal:e.pageTotal},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)],1),t("el-drawer",{staticClass:"inetDrawer",attrs:{withHeader:!1,"show-close":!1,visible:e.drawer,direction:e.directions,"destroy-on-close":"","before-close":e.drawerClose,"append-to-body":"",size:"90%"},on:{"update:visible":function(t){e.drawer=t}}},[t("node-detail",{ref:"ipDetail",attrs:{minionId:e.ipTtitel.minion_id}})],1),t("el-drawer",{attrs:{title:"事件通知",visible:e.noticeShow,direction:e.noticedirections,"custom-class":"demo-drawer","before-close":e.noticeClose,"destroy-on-close":"",size:"20%"},on:{"update:visible":function(t){e.noticeShow=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"联系人","label-width":"80px"}},[t("el-select",{staticStyle:{width:"71%"},attrs:{size:"mini"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},e._l(e.contactData,(function(e,i){return t("el-option",{key:i,attrs:{lable:e.name,value:e.name}})})),1)],1),t("el-form-item",{attrs:{label:"通知方式","label-width":"80px"}},[t("el-checkbox-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("el-checkbox",{attrs:{label:"邮件",name:"type"}}),t("el-checkbox",{attrs:{label:"短信",name:"type"}}),t("el-checkbox",{attrs:{label:"咚咚",name:"type"}}),t("el-checkbox",{attrs:{label:"电话",name:"type"}}),t("el-checkbox",{attrs:{label:"微信",name:"type"}})],1)],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{staticStyle:{float:"right",margin:"10px"},attrs:{type:"primary"}},[e._v("发送")])],1)],1)]),t("ActionForm",{ref:"actionForm",attrs:{title:e.actionTitle,pageTotal:e.pageTotal,filters:e.filters,nodeData:e.riskData},on:{initRisk:e.initRisk,cancel:e.cancel}}),t("riskDetail",{ref:"riskDetailRef"})],1)},s=[],l=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{"el-dialog":"","close-on-click-modal":!1,"before-close":e.handleClose,visible:e.actionDialog,title:e.title,"append-to-body":"",width:"500px"},on:{"update:visible":function(t){e.actionDialog=t}}},[e.filters.length>0?t("div",[e._l(e.nodeData,(function(i){return t("el-tag",{key:i.id,staticStyle:{"margin-right":"3px","margin-bottom":"3px"},attrs:{size:"mini",type:"彻底删除"===e.title||"逻辑删除"===e.title?"danger":"success"}},[e._v(e._s(i.inet)+" ")])})),e._v(" 等，共计 "),t("span",{staticStyle:{color:"red"}},[e._v(e._s(e.pageTotal))]),e._v(" 条是否操作？ ")],2):t("div",[t("span",{staticStyle:{color:"red"}},[e._v("请输入筛选条件")])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.actionDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("确定")])],1)])},r=[],n={name:"actionForm",props:["title","pageTotal","filters","nodeData"],data(){return{actionDialog:!1,dataAction:[]}},methods:{handleClose(){this.actionDialog=!1,this.$emit("cancel")},onSubmit(){var e=this,t={filters:this.filters};"批量删除"===this.title?this.$request.fetchDeleteRisk(t).then((t=>{this.$message({message:e.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((e=>{this.$message.error(e.data)})):"批量忽略"===this.title?this.$request.fetchRiskIgnore(t).then((t=>{this.$message({message:e.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((e=>{this.$message.error(e.data)})):"批量处理"===this.title&&this.$request.fetchRiskProcess(t).then((t=>{this.$message({message:e.title+"成功!!!",type:"success"}),this.actionDialog=!1,this.$emit("initRisk")})).catch((e=>{this.$message.error(e.data)}))}},watch:{nodeData:function(e){this.nodeData=e},filters:function(e){this.filters=e}}},o=n,c=i(81656),d=(0,c.A)(o,l,r,!1,null,"0016035a",null),u=d.exports,p=i(92161),h=i(77538),f=i(23947),m=i(67424),v=function(){var e=this,t=e._self._c;return t("div",{staticClass:"leftBox"},[t("div",{staticClass:"fitlerBox"},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini"},on:{change:e.loadMenu},model:{value:e.leftBoxType,callback:function(t){e.leftBoxType=t},expression:"leftBoxType"}},e._l(e.groupArray,(function(e,i){return t("el-option",{key:i,attrs:{label:e.desc,value:e.key}})})),1)],1),t("div",{staticStyle:{"font-size":"14px",cursor:"pointer"},on:{click:function(t){return e.leftItemClick(null)}}},[t("i",{staticClass:"el-icon-caret-right",staticStyle:{color:"#939597"}}),e._v(" 全部 ")]),e._l(e.menuList,(function(i,a){return t("div",{key:a,class:{tagItem:!0,tagItemActive:i.name===e.activeOption},on:{click:function(t){return e.leftItemClick(i.name)}}},[t("span",{staticStyle:{display:"inline-block",width:"4px",height:"4px","margin-right":"5px","background-color":"#86909c","border-radius":"2px"}}),t("el-tooltip",{attrs:{effect:"light",content:i.name+"("+i.count+")",placement:"top-start","open-delay":800}},[t("span",{staticClass:"contentBox"},[e._v(" "+e._s(i.name||"--")+" "),t("span",{staticStyle:{color:"#a8acb1","font-size":"14px"}},[e._v("("+e._s(i.count)+")")])])])],1)})),t("el-pagination",{attrs:{"current-page":e.pageIndex,"page-size":15,small:"",layout:"prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.pageIndex=t},"update:current-page":function(t){e.pageIndex=t},"current-change":e.loadMenu}})],2)},g=[],y={props:["activeOption","value","filters"],data(){return{leftBoxType:"risk_type",pageIndex:1,activeMenu:null,pageSize:15,total:0,menuList:[],groupArray:[{key:"subject",desc:"主题"},{key:"risk_type",desc:"类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"任务名称"}]}},watch:{filters:{handler(){this.loadMenu()},deep:!0}},created(){this.loadMenu()},methods:{async loadMenu(){try{const{data:e}=await this.$request.fetchGroup({current:this.pageIndex,size:this.pageSize,group:this.leftBoxType,filters:this.filters})||{};this.menuList=e?.records,this.total=e?.total}catch(e){this.menuList=[],this.total=0,console.error(e)}},emit(){this.$emit("input",{key:this.leftBoxType,operator:"eq",value:this.activeMenu}),this.$emit("change",{key:this.leftBoxType,operator:"eq",value:this.activeMenu})},leftItemClick(e){e===this.activeMenu&&(e=null),this.activeMenu=e,this.emit()}}},k=y,_=(0,c.A)(k,v,g,!1,null,"e937eb58",null),b=_.exports,w=i(65524),S=i(95093),x=i.n(S),C={name:"risk",components:{Page:p.A,CvssScore:h.A,NodeDetail:f.A,ActionForm:u,riskDetail:m.A,leftMenu:b,filterOption:w.A},props:{initFilters:{type:Array,default:()=>[]}},data(){return{form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},leftBoxType:"risk_type",groupArray:[{key:"subject",desc:"主题"},{key:"risk_type",desc:"风险类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"来源模块"}],condData:{},riskLoading:!1,actionType:["批量删除","批量忽略","批量处理"],actionTitle:"",selectArray:[{model:"",placeholder:"风险类型",name:"risk_type",dataArray:[{key:"暴力破解",desc:"暴力破解"},{key:"病毒事件",desc:"病毒事件"},{key:"弱口令",desc:"弱口令"},{key:"数据爬虫",desc:"数据爬虫"},{key:"蜜罐应用",desc:"蜜罐应用"},{key:"web攻击",desc:"web攻击"},{key:"登录事件",desc:"登录事件"},{key:"监控事件",desc:"监控事件"}]}],colData:[{lable:"终端IP",key:"inet",istrue:!0,width:120},{lable:"级别",key:"level",istrue:!0,width:120},{lable:"本地IP",key:"local_ip",istrue:!1,width:150},{lable:"本地端口",key:"local_port",istrue:!1,width:150},{lable:"外部IP",key:"remote_ip",istrue:!0,width:150},{lable:"外部端口",key:"remote_port",istrue:!0,width:80},{lable:"归属地",key:"region",istrue:!1},{lable:"风险类型",key:"risk_type",istrue:!0,width:100},{lable:"告警",key:"send_alert",istrue:!1},{lable:"产生时间",key:"created_at",istrue:!0,width:150},{lable:"参考信息",key:"reference",istrue:!1},{lable:"主题",key:"subject",istrue:!0,width:280},{lable:"来源模块",key:"from_code",istrue:!0}],tableHeader:[{title:"终端IP",istrue:!0},{title:"风险类型",istrue:!0},{title:"级别",istrue:!0},{title:"本地IP",istrue:!1},{title:"本地端口",istrue:!1},{title:"外部端口",istrue:!0},{title:"外部IP",istrue:!0},{title:"归属地",istrue:!0},{title:"主题",istrue:!0},{title:"告警",istrue:!1},{title:"产生时间",istrue:!0},{title:"来源模块",istrue:!0},{title:"参考信息",istrue:!1}],colOptions:["终端IP","风险类型","级别","远程IP","目的端口","目的IP","主题","产生时间","来源模块"],colSelect:["终端IP","风险类型","级别","源IP","源端口","目的端口","目的IP","归属地","主题","告警","产生时间","来源模块","参考信息"],riskData:[],currentPage:1,pageSize:15,vulnDetailShow:!1,vulnDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",noticedirections:"rtl",filters:[{key:"occur_at",operator:"gt",value:x()().startOf("days").subtract(7,"days")},{key:"level",operator:"notin",value:"低危"},...this.initFilters||[]],noticeShow:!1,pageTotal:0,topEchartShow:!1,contactData:[],tagShow:!1,leftMenuValue:{key:"risk_type",operator:"",value:""}}},created(){this.initRisk(),this.getCond()},computed:{activeUsers:function(){return this.colData.filter((function(e){return e.istrue}))},curtag(){if(!this.filters)return"";const e=this.filters.find((e=>e.key===this.leftMenuValue.key));return e&&"eq"===e.operator&&e.value?e.value:void 0}},methods:{selectActive(e){this.$emit("activeClick",!1,!1,!0,e)},cancel(){this.actionTitle=""},bulkClick(e){const t=this.$refs.actionForm;t.actionDialog=!0,this.actionTitle=e},drawerClose(){this.drawer=!1,this.ipTtitel={}},noticeClose(){this.noticeShow=!1},innetactive(e){this.ipTtitel=e,this.drawer=!0},attackShow(){this.$emit("activeClick",!1,!0,!1)},initRisk(){var e={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchRisks(e).then((e=>{this.riskData=e.data.records,this.pageTotal=e.data.total,this.riskLoading=!1})).catch((e=>{this.riskLoading=!1,this.$message.error(e)}))},getCond(){this.$request.fetchRisksCond().then((e=>{this.condData=e.data}))},searchBasic(){this.currentPage=1,this.initRisk()},echartShow(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow",this.topEchartShow)},sheetode(){var e={filters:this.filters};this.$request.fetchSheetode(e).then((e=>{const t=document.createElement("a");let i=new Blob([e.data],{type:"text/csv"});t.style.display="none",t.href=URL.createObjectURL(i);let a=e.headers["content-disposition"].split("''");t.setAttribute("download",decodeURI(a[1])),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))},handleSizeChange(e){this.pageSize=e,this.initRisk()},handleCurrentChange(e){this.currentPage=e,this.initRisk()},riskDetailCilck(e){this.$refs.riskDetailRef.openRiskDetail(e)},riskNoticeCilck(){this.noticeShow=!0;var e={current:1,size:100,name:""};this.$request.fetchGetContact(e).then((e=>{this.contactData=e.data.records}))},kaifa(){this.$message({message:"开发中！！！",type:"warning"})},click(){this.$message({message:"开发中！！！",type:"warning"})},leftChange(){this.$refs.selectSearchRef?.pushFilter({key:this.leftMenuValue.key,operator:this.leftMenuValue.operator,value:this.leftMenuValue.value})}},watch:{colOptions(e){if(e){var t=this.colSelect.filter((t=>e.indexOf(t)<0));this.colData.filter((e=>{t.indexOf(e.lable)>-1?e.istrue=!1:e.istrue=!0}))}}}},D=C,z=(0,c.A)(D,a,s,!1,null,"4decdd0f",null),A=z.exports},67424:function(e,t,i){i.d(t,{A:function(){return h}});var a=function(){var e=this,t=e._self._c;return t("el-drawer",{staticClass:"vulnDrawer",attrs:{visible:e.visible,direction:"rtl",size:"50%","append-to-body":""},on:{"update:visible":function(t){e.visible=t}},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",[t("el-button",{staticClass:"text-blue-500",attrs:{size:"mini",round:""}},[e._v(e._s(e.riskData.inet))]),t("b",{staticClass:"text-[#000] ml-2"},[e._v(" "+e._s(e.riskData.subject||"--")+" ")])],1)]},proxy:!0}])},[t("div",{staticStyle:{padding:"10px 20px"}},[t("el-descriptions",{attrs:{column:2,labelStyle:{color:"#000","font-weight":600}}},[t("el-descriptions-item",{attrs:{label:"级别"}},["无风险"===e.riskData.level?t("el-tag",{attrs:{type:"success",size:"mini"}},[t("span",[e._v("无风险")])]):e._e(),"低危"===e.riskData.level?t("el-tag",{attrs:{type:"",size:"mini"}},[t("span",[e._v("低危")])]):e._e(),"中危"===e.riskData.level?t("el-tag",{staticStyle:{color:"#adad24","background-color":"#ffff0161","border-color":"#d9d92461"},attrs:{size:"mini"}},[t("span",[e._v("中危")])]):e._e(),"高危"===e.riskData.level?t("el-tag",{attrs:{type:"warning",size:"mini"}},[t("span",[e._v("高危")])]):e._e(),"紧急"===e.riskData.level?t("el-tag",{attrs:{type:"danger",size:"mini"}},[t("span",[e._v("紧急")])]):e._e(),t("el-tag",{staticStyle:{"margin-left":"3px"},attrs:{size:"mini",type:e.riskData.send_alert?"warning":"danger"}},[e._v(" "+e._s(e.riskData.send_alert?"已告警":"未告警")+" ")])],1),t("el-descriptions-item",{attrs:{label:"风险类型"}},[e._v(" "+e._s(e.riskData.risk_type||"--")+" ")]),t("el-descriptions-item",{attrs:{label:"风险ID"}},[e._v(" "+e._s(e.riskData.id)+" ")]),t("el-descriptions-item",{attrs:{label:"终端ID"}},[e._v(" "+e._s(e.riskData.minion_id)+" ")]),t("el-descriptions-item",{attrs:{label:"源IP"}},[e._v(" "+e._s(e.riskData.local_ip||"")+":"+e._s(e.riskData.local_port)+" ")]),t("el-descriptions-item",{attrs:{label:"外部IP"}},[e._v(" "+e._s(e.riskData.remote_ip||"")+":"+e._s(e.riskData.remote_port)+" ")]),t("el-descriptions-item",{attrs:{label:"来源模块"}},[e._v(" "+e._s(e.riskData.from_code||"--")+" ")]),t("el-descriptions-item",{attrs:{label:"归属地"}},[e._v(" "+e._s(e.riskData.region||"--")+" ")]),t("el-descriptions-item",{attrs:{label:"服务端事件创建时间"}},[e._v(" "+e._s(e.riskData.created_at?e.moment(e.riskData.created_at).format("YYYY-MM-DD HH:mm:ss"):"--")+" ")]),t("el-descriptions-item",{attrs:{label:"事件产生本地时间"}},[e._v(" "+e._s(e.riskData.occur_at?e.moment(e.riskData.occur_at).format("YYYY-MM-DD HH:mm:ss"):"--")+" ")]),t("el-descriptions-item",{attrs:{label:"参考信息",span:2}},[t("jsonView",{attrs:{data:e.riskData.referenceHJS||"--"}})],1),t("el-descriptions-item",{attrs:{label:"攻击载荷",span:2}},[t("jsonView",{attrs:{data:e.riskData.payloadHJS||"--"}})],1),t("el-descriptions-item",{attrs:{label:"template",span:2}},[t("jsonView",{attrs:{data:e.riskData.templateHJS||"--"}})],1),t("el-descriptions-item",{attrs:{label:"metadata",span:2}},[t("jsonView",{attrs:{data:e.riskData.metadata||"--",beauty:!1}})],1)],1)],1)])},s=[],l=i(67451),r=i(95093),n=i.n(r);function o(e){try{return e=decodeURIComponent(e),JSON.parse(e)}catch(t){return e}}var c={components:{jsonView:l.A},data(){return{moment:n(),riskData:{inet:null,level:null,send_alert:null,risk_type:null,subject:null,local_ip:null,local_port:null,remote_ip:null,remote_port:null,from_code:null,region:null,created_at:null,occur_at:null,reference:null,payload:null,payloadHJS:null,referenceHJS:null,metadata:null,template:null,templateHJS:null},visible:!1}},methods:{openRiskDetail(e){this.$set(this,"riskData",e),this.riskData.payloadHJS=o(this.riskData.payload),this.riskData.referenceHJS=o(this.riskData.reference),this.riskData.templateHJS=o(this.riskData.template),this.visible=!0}}},d=c,u=i(81656),p=(0,u.A)(d,a,s,!1,null,"56788c05",null),h=p.exports},19334:function(e,t,i){i.r(t),i.d(t,{default:function(){return k}});var a=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"contentCard_"},[e.chartShow?t("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"min-h-[260px]",attrs:{gutter:10}},[t("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:24}},[e.recentShow?t("Notice",{attrs:{recentData:e.recentData},on:{selectChange:e.selectChange}}):e._e()],1)],1):e._e(),e.riskShow?t("Risk",{on:{activeClick:e.activeClick},scopedSlots:e._u([{key:"showChartBtn",fn:function(){return[t("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:e.toggleChart}},[e._v(e._s(e.chartShow?"隐藏图表":"显示图表")+" ")])]},proxy:!0}],null,!1,514383144)}):e._e(),e.attackShow?t("Attack",{on:{activeClick:e.activeClick},scopedSlots:e._u([{key:"showChartBtn",fn:function(){return[t("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:e.toggleChart}},[e._v(e._s(e.chartShow?"隐藏图表":"显示图表")+" ")])]},proxy:!0}],null,!1,514383144)}):e._e()],1)},s=[],l=(i(12878),function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"card",staticStyle:{height:"265px"},attrs:{shadow:"never"}},[t("div",{style:{float:"left",width:"100%",height:"240px"},attrs:{id:"riskstsEcharts"}}),t("el-checkbox-group",{staticClass:"day_select",attrs:{size:"mini"},on:{change:e.selectChange},model:{value:e.dayCheck,callback:function(t){e.dayCheck=t},expression:"dayCheck"}},e._l(e.dayArray,(function(i,a){return t("div",{key:a},[t("el-checkbox",{attrs:{label:i.value}},[e._v(e._s(i.label))])],1)})),0)],1)}),r=[],n=i(92161),o=i(83779),c={name:"Eventnotice",components:{Page:n.A},props:["recentData"],data(){return{current:1,riskData:{},echartData:[],dayCheck:["15"],dayArray:[{value:"1",label:"查询今天"},{value:"3",label:"查询三天"},{value:"5",label:"查询五天"},{value:"7",label:"查询一周"},{value:"15",label:"查询半月"},{value:"30",label:"查询每月"}]}},mounted(){this.chartRecent()},methods:{selectChange(e){this.dayCheck.length>1&&this.dayCheck.shift(),void 0===this.dayCheck[0]&&(this.dayCheck[0]="15"),this.$emit("selectChange",this.dayCheck[0])},chartRecent(){var e=[],t=[];t=this.recentData.risk.map((e=>e.type)),this.recentData.risk.length>0&&this.recentData.risk.forEach((t=>{e.push({backgroundStyle:{color:"rgba(111, 162, 135, 0.2)"},name:t.type,type:"bar",emphasis:{focus:"series"},data:t.count})}));var i={color:["#5470C6","#91CC75","#FAC858","#f44336","#9c27b0","#03a9f4","#4caf50","#ffc107","#ff5722","#795548","#607d8b"],grid:{left:"4%",right:"8%",top:"16%",bottom:"8%"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{orient:"vertical",top:"1%",right:20,itemWidth:10,itemHeight:10,data:t},xAxis:{type:"category",data:this.recentData.date},yAxis:[{type:"value",show:!1}],series:e};const a=o.init(document.getElementById("riskstsEcharts"));a.setOption(i,!0),window.addEventListener("resize",(()=>{a.resize()}))}},watch:{recentData:function(e){this.recentData=e,this.chartRecent()}}},d=c,u=i(81656),p=(0,u.A)(d,l,r,!1,null,"4a12f768",null),h=p.exports,f=i(792),m=i(48654),v={components:{Notice:h,Risk:f.A,Attack:m.A},name:"vuln",data(){return{riskShow:!0,attackShow:!1,groupShow:!1,recentData:[],recentShow:!1,chartShow:!1,loading:!1,group:{},day:"15"}},methods:{activeClick(e,t,i,a){this.group=a,this.chartShow=!1,this.riskShow=e,this.attackShow=t,this.groupShow=i},toggleChart(){this.chartShow=!this.chartShow,void 0===this.recentData.date&&this.chartShow&&this.getRecent(this.day)},selectChange(e){this.getRecent(e)},getRecent(e){this.loading=!0,this.$request.fetchRevent(e).then((e=>{this.recentData=e.data,this.recentShow=!0})).finally((()=>{this.loading=!1}))}}},g=v,y=(0,u.A)(g,a,s,!1,null,"1c8d1328",null),k=y.exports},12878:function(e,t,i){var a=i(85471);a["default"].filter("date",(function(e,t){var i=new Date(e),a={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var s in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp(`(${s})`).test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[s]:("00"+a[s]).substr((""+a[s]).length)));return t}))}}]);