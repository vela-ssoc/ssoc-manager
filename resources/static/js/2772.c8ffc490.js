"use strict";(self["webpackChunkssoc"]=self["webpackChunkssoc"]||[]).push([[2772],{86389:function(t,e,i){i.d(e,{A:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("detail",t._g(t._b({},"detail",t.$attrs,!1),t.$listeners))},s=[],l=i(24869),r={components:{detail:l.A}},n=r,o=i(81656),c=(0,o.A)(n,a,s,!1,null,null,null),d=c.exports},1477:function(t,e,i){i.d(e,{A:function(){return c}});var a=function(){var t=this,e=t._self._c;return t.condData?e("div",[t.multiCondition?e("el-row",{staticStyle:{"margin-bottom":"5px"}},[e("el-col",{attrs:{span:24}},t._l(t.filters,(function(i,a){return e("span",{key:a,staticStyle:{"margin-right":"5px","font-size":"12px",color:"#fff",padding:"3px","border-radius":"3px","background-color":"#409eff",display:"inline-block"}},[t._v(" "+t._s(i.keyDesc)+" "+t._s(i.operatorDesc)+" "+t._s(i.value)+" "),e("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.editTag(i,a)}}}),e("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delTag(i,a)}}})])})),0)],1):t._e(),e("div",{class:"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?"dom":"doms"},[t._l(t.selectArray,(function(i,a){return e("span",{key:a},["蜜罐"!==t.nameIndex?e("el-dropdown",{staticStyle:{"margin-right":"5px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v(" "+t._s(i.placeholder)),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(i.dataArray,(function(a){return e("el-dropdown-item",{key:a.key,attrs:{value:a.key},nativeOn:{click:function(e){return t.selectActive(a,i)}}},[t._v(t._s(a.desc))])})),1)],1):t._e()],1)})),"事件展示"===t.nameIndex?e("span",[e("el-dropdown",{staticStyle:{"margin-right":"5px"},attrs:{trigger:"click"}},[e("el-button",{attrs:{type:"primary",size:"mini"}},[t._v(" 时间搜索"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.eventTime,(function(i){return e("el-dropdown-item",{key:i.value,attrs:{value:i.value},nativeOn:{click:function(e){return t.eventTimeChange(i)}}},[t._v(t._s(i.label))])})),1)],1)],1):t._e(),"事件详情"===t.nameIndex?e("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.oneClear}},[t._v("一键清除")]):t._e(),"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?e("el-button",{staticStyle:{"margin-right":"7px"},attrs:{type:"success",size:"mini"},on:{click:t.refresh}},[t._v("刷新")]):t._e(),e("el-select",{staticStyle:{width:"150px","margin-right":"7px"},attrs:{size:"mini","value-key":"key"},on:{change:t.selectField},model:{value:t.key,callback:function(e){t.key=e},expression:"key"}},[t._l(t.condData.conditions,(function(i,a){return[i.key!==t.eventLogon?e("el-option",{key:a,attrs:{value:i.key,label:i.desc}}):t._e()]}))],2),e("el-select",{staticStyle:{width:"100px","margin-right":"7px"},attrs:{size:"mini","value-key":"key"},on:{change:t.selectOperator},model:{value:t.operator,callback:function(e){t.operator=e},expression:"operator"}},t._l(t.selectFieldDerive.operatorArray,(function(t,i){return e("el-option",{key:i,attrs:{value:t.key,label:t.desc}})})),1),["datetime","time"].includes(t.selectFieldDerive.typeConditions)?e("span",{staticStyle:{display:"inline-block","margin-right":"7px"}},[e("el-date-picker",{attrs:{clearable:"",type:"datetime",pickerOptions:t.pickerOptions,placeholder:"选择时间",size:"mini"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1):e("span",{staticStyle:{display:"inline-block","margin-right":"7px"}},[t.selectFieldDerive.selectType?e("el-select",{staticStyle:{width:"180px"},attrs:{size:"mini",clearable:"","value-key":"key",multiple:"in"===t.operator||"notin"===t.operator,"collapse-tags":""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.selectFieldDerive.valueArray,(function(t,i){return e("el-option",{key:i,attrs:{value:t.key,label:t.desc}})})),1):e("span",{staticStyle:{position:"relative",display:"inline-block"}},[e("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",clearable:""},on:{focus:function(e){t.suggestVisible=!0}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1),e("el-button",{class:"事件详情"===t.nameIndex||"任务详情"===t.nameIndex||"风险详情"===t.nameIndex?"buttons":"buttonsearch",attrs:{icon:"el-icon-search",size:"mini"},on:{click:()=>{t.suggestVisible=!1,t.searchCond()}}},[t._v(t._s(t.titleH)+" ")])],2)],1):t._e()},s=[],l={name:"index",props:{titleH:{type:String,default:function(){return""}},condData:{type:Object,default:function(){return{}}},defaultData:{type:Object,default:function(){return{}}},eventLogon:{type:String,default:function(){return""}},nameIndex:{type:String,default:function(){return""}},selectArray:{type:Array,default:function(){return[]}},multiCondition:{default:!0},inputSuggestOptions:{type:Object}},computed:{selectFieldDerive(){var t=this.condData?.conditions?.findIndex((t=>t.key===this.key));return{operatorArray:this.condData?.conditions?.[t]?.operators||[],selectType:this.condData?.conditions?.[t]?.enum,valueArray:this.condData?.conditions?.[t]?.enums||[],typeConditions:this.condData?.conditions?.[t]?.type}},suggestOption(){return this.inputSuggestOptions&&this.inputSuggestOptions[this.key]||[]}},data(){return{operator:"",value:null,key:"",filters:[],current:1,pageSize:15,suggestVisible:!1,eventTime:[{value:"900",label:"十五分钟"},{value:"3600",label:"一小时"},{value:"86400",label:"一天"},{value:"604800",label:"一周"},{value:"2592000",label:"一个月"}],pickerOptions:{disabledDate(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick(t){t.$emit("pick",new Date)}},{text:"昨天",onClick(t){const e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick(t){const e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}},{text:"三十天前",onClick(t){const e=new Date;e.setTime(e.getTime()-2592e6),t.$emit("pick",e)}}]}}},created(){const t=this.filters.push.bind(this.filters);this.filters.push=(...e)=>{for(let i of e){const e=this.filters.find((t=>t.key===i.key));e?Object.assign(e,i):(!this.multiCondition&&this.filters.length>0&&(this.filters.length=0),t(i))}},"彻底删除"===this.nameIndex?(this.filters.push(this.getSelectItem("status","eq","4")),this.$emit("searchBasic",this.filters)):(this.key=this.defaultData?.key||null,this.operator=this.defaultData?.operator||null)},methods:{refresh(){this.$emit("refresh")},oneClear(){this.$emit("oneClear")},selectField(t){this.value=void 0,this.$nextTick((()=>{this.operator=this.selectFieldDerive.operatorArray.some((t=>"like"===t.key))?"like":this.selectFieldDerive.operatorArray?.[0].key}))},selectOperator(t){this.operatorValue=t.key,this.value=null},eventTimeChange(t){this.filters.length=0,this.filters.push(this.getSelectItem("created_at","lt",new Date)),this.filters.push(this.getSelectItem("created_at","gt",new Date(new Date-24e3*t.value))),this.$emit("searchBasic",this.filters)},selectActive(t,e){this.filters.push(this.getSelectItem(e.name,"eq",t.key)),this.$emit("searchBasic",this.filters)},delTag(t,e){("蜜罐"!==this.nameIndex&&"事件详情"!==this.nameIndex&&"风险详情"!==this.nameIndex||0!==e)&&(this.filters.splice(e,1),this.$emit("searchBasic",this.filters))},editTag(t,e){("蜜罐"!==this.nameIndex&&"事件详情"!==this.nameIndex&&"风险详情"!==this.nameIndex||0!==e)&&(this.key=t.key,this.value=t.value,this.operator=t.operator)},getSelectItem(t,e,i){return{key:t,keyDesc:this.condData?.conditions?.find((e=>e.key===t))?.desc,value:i,operator:e,operatorDesc:this.selectFieldDerive.operatorArray.find((t=>t.key===e))?.desc}},searchCond(){if(""!==this.key&&void 0!==this.value&&void 0!==this.operator&&null!==this.value&&""!==this.value){const t=this.getSelectItem(this.key,this.operator,this.value);this.filters.push(t)}if(!this.value&&this.key){const t=this.filters.find((t=>t.key===this.key));-1!==t&&this.filters.splice(t,1)}this.$emit("searchBasic",this.filters)},setOption(t,e,i){this.key=t,this.operator=e,this.value=i,this.searchCond()}},watch:{nameIndex:function(t,e){"彻底删除"===t&&t!==e&&(this.filters.push(this.getSelectItem("status","eq","4")),this.$emit("searchBasic",this.filters))}}},r=l,n=i(81656),o=(0,n.A)(r,a,s,!1,null,"1e98ace1",null),c=o.exports},84127:function(t,e,i){i.r(e),i.d(e,{default:function(){return V}});var a=function(){var t=this,e=t._self._c;return e("el-card",[t.topEchartShow?e("el-row",[e("el-col",{attrs:{span:24}},[e("TaskCount")],1)],1):t._e(),e("el-row",{staticStyle:{"margin-top":"5px"}},[e("el-col",{attrs:{span:18}},[e("select-search",{ref:"select",attrs:{condData:t.condData},on:{searchBasic:t.searchBasic}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e("el-upload",{ref:"file",staticClass:"upload-demo",staticStyle:{margin:"0 10px",float:"right"},attrs:{action:"/","on-change":t.filseSuccess,"show-file-list":!1,accept:".csv","auto-upload":!1}},[e("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-upload",type:"primary",plain:"",size:"mini"}},[t._v("导入数据")])],1),e("span",{staticStyle:{float:"right"}},[e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.refresh}},[t._v("批量操作")])],1),e("el-button",{staticStyle:{margin:"0 10px",float:"right"},attrs:{type:"success",plain:"",size:"mini"},on:{click:t.echartShow}},[t._v(" "+t._s(!0===t.topEchartShow?"隐藏图表":"显示图表")+" ")])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%","margin-top":"5px"},attrs:{data:t.initData.records,"header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"},"cell-style":{padding:"12px 0"}}},[t._l(t.activeUsers,(function(i,a){return e("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"",label:i.lable,prop:i.key,width:i.width},scopedSlots:t._u([{key:"default",fn:function(a){return["members"===i.key?e("span",[t.ipRe(a.row.members).length<2?e("span",t._l(t.ipRe(a.row.members),(function(i,a){return e("el-tag",{key:a,staticStyle:{"margin-right":"3px"},attrs:{size:"mini"}},[t._v(" "+t._s(i.member_ip)+":"+t._s(i.member_port))])})),1):e("span",[t._l(t.ipRe(a.row.members).slice(0,1),(function(i,a){return e("el-tag",{key:a,staticStyle:{"margin-right":"3px"},attrs:{size:"mini"}},[t._v(" "+t._s(i.member_ip)+":"+t._s(i.member_port))])})),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Right Center 提示文字",placement:"right"}},[e("el-tag",{attrs:{size:"mini",type:"info"}},[t._v(" + "+t._s(t.ipRe(a.row.members).length))]),e("div",{attrs:{slot:"content"},slot:"content"},t._l(t.ipRe(a.row.members),(function(i,a){return e("span",{key:a,staticStyle:{"padding-right":"15px"}},[t._v(t._s(i.member_ip)+":"+t._s(i.member_port)),e("br")])})),0)],1)],2)]):e("span",[t._v(" "+t._s(a.row[i.key])+" ")])]}}],null,!0)})})),e("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.reloadService(i.row)}}},[t._v("漏洞")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.reloadService(i.row)}}},[t._v("扫描")]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.reloadService(i.row)}}},[t._v("编辑")]),i.row.dialect&&"startup"!==i.row.name?e("el-popover",{ref:i.row.substance_id,attrs:{placement:"top"}},[e("p",[t._v("确定删除?")]),e("div",{staticStyle:{"text-align":"right",margin:"0"}},[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.$refs[i.row.substance_id].doClose()}}},[t._v("取消")]),e("el-button",{attrs:{loading:t.delLoading,type:"primary",size:"mini"},on:{click:function(e){return t.reloadService(i.row.substance_id)}}},[t._v("确定 ")])],1),e("el-button",{staticStyle:{"margin-left":"3%"},attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[t._v("删除")])],1):e("span",{staticStyle:{color:"#c0c4cc","margin-left":"3%"}},[t._v("删除")])]}},{key:"header",fn:function(i){return[e("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t._l(t.tableHeader,(function(i,a){return e("div",{key:a},[e("el-checkbox",{attrs:{label:i.title},model:{value:t.colOptions,callback:function(e){t.colOptions=e},expression:"colOptions"}})],1)})),e("div",{attrs:{slot:"reference"},slot:"reference"},[t._v(" 操作"),e("i",{staticClass:"el-icon-setting",staticStyle:{"padding-left":"10px"}})])],2)]}}])})],2),e("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.initData.total},on:{handleCurrentChange:t.handleCurrentChange}}),e("el-drawer",{staticClass:"eventDrawer",attrs:{visible:t.processShow,direction:"rtl",size:"25%"},on:{"update:visible":function(e){t.processShow=e},close:t.processCancel}},[e("div",{staticStyle:{padding:"0 20px"}},[e("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("进程详情")])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程名称 "),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.name))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("内存使用"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.mem_size||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程PID"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.pid))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程PPID"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.ppid))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("用户信息"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.username))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("处理字节"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.rss_bytes||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动时间"),e("span",{staticClass:"subtitle"},[t._v(t._s(t._f("date")(t.processDetailData.created_at,"yyyy-MM-dd hh:mm:ss")))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动参数"),e("span",{staticClass:"subtitle"},[t.processDetailData.args?e("span",[t.processDetailData.args.length>0?e("span",t._l(t.processDetailData.args,(function(i,a){return e("span",{key:a},[e("el-tag",{staticStyle:{"margin-right":"10px"},attrs:{type:"info",size:"mini"}},[t._v(t._s(i))])],1)})),0):t._e()]):e("span",[t._v("-")])])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("启动命令"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.cmdline||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("进程路径"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.executable||"-"))])])],1),e("el-row",{staticStyle:{"margin-bottom":"14px"}},[e("el-col",{attrs:{span:24}},[t._v("checksum"),e("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.checksum||"-"))])])],1)],1)])]),e("AddForm",{ref:"formAdd",on:{handleEdit:t.handleEdit}}),e("el-drawer",{attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[e("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1)],1)},s=[],l=i(92161),r=i(1477),n=(i(12878),function(){var t=this,e=t._self._c;return e("span",[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard"},[t._v("应用分类")])])],1),e("div",{style:{float:"left",width:"100%",height:"200px"},attrs:{id:"risklvlEchart"}})],1),e("el-col",{attrs:{span:12}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"controlCard"},[t._v("IP总数")])])],1),e("div",{style:{float:"left",width:"100%",height:"200px"},attrs:{id:"riskstsEchart"}})],1)],1)],1)}),o=[],c=i(83779),d={data(){return{countData:{},riskstsData:{}}},created(){this.init()},methods:{init(){this.$request.fetchGetTackCount().then((t=>{this.countData=t.data,this.initleft(),this.initright()}))},initright(){var t=[];for(let l in this.countData){var e={};"running"===l?(e={name:"运行正常",value:this.countData[l],itemStyle:{color:"#91cc75"}},t.push(e)):"doing"===l?(e={name:"正在启动",value:this.countData[l],itemStyle:{color:"#fd8c00"}},t.push(e)):"fail"===l?(e={name:"运行失败",value:this.countData[l],itemStyle:{color:"#f86c6b"}},t.push(e)):"panic"===l?(e={name:"运行崩溃",value:this.countData[l],itemStyle:{color:"#909399"}},t.push(e)):"update"===l?(e={name:"正在更新",value:this.countData[l],itemStyle:{color:"#409eff"}},t.push(e)):"reg"===l&&(e={name:"注册状态",value:this.countData[l],itemStyle:{color:"#ffc107"}},t.push(e))}let i=0;t.forEach((function(t){i+=t.value}));var a={legend:{orient:"vertical",right:"15%",align:"left",top:"middle",itemWidth:10,itemHeight:13,icon:"circle",itemGap:20,data:t,formatter:function(e){let a=0;for(var s="",l=0;l<t.length;l++)t[l].name==e&&(a=(t[l].value/i*100).toFixed(2)+"%",s+="{a|"+e+"}| {b|"+a+"}{b|"+t[l].value+"}");return s},textStyle:{color:"#000",rich:{a:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20},b:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20}}}},tooltip:{trigger:"item"},series:[{type:"pie",data:t,center:["35%","50%"],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};const s=c.init(document.getElementById("risklvlEchart"));s.setOption(a),window.addEventListener("resize",(()=>{s.resize()}))},initleft(){var t=[];for(let l in this.countData){var e={};"dialect"===l?(e={name:"私有",value:this.countData[l]},t.push(e)):"public"===l&&(e={name:"公有",value:this.countData[l]},t.push(e))}let i=0;t.forEach((function(t){i+=t.value}));var a={legend:{orient:"vertical",right:"15%",align:"left",top:"middle",itemWidth:10,itemHeight:13,icon:"circle",itemGap:20,data:t,formatter:function(e){let a=0;for(var s="",l=0;l<t.length;l++)t[l].name==e&&(a=(t[l].value/i*100).toFixed(2)+"%",s+="{a|"+e+"}| {b|"+a+"}{b|"+t[l].value+"}");return s},textStyle:{color:"#000",rich:{a:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20},b:{fontSize:12,padding:[0,10,0,6],color:"#666",fontFamily:"PingFang SC",fontStyle:"normal",lineHeight:20}}}},tooltip:{trigger:"item"},series:[{type:"pie",data:t,center:["35%","50%"],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};const s=c.init(document.getElementById("riskstsEchart"));s.setOption(a),window.addEventListener("resize",(()=>{s.resize()}))}}},p=d,u=i(81656),h=(0,u.A)(p,n,o,!1,null,null,null),m=h.exports,f=function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"code-form",attrs:{"before-close":t.handleClose,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,top:"50px","el-dialog":"",visible:t.dialogVisible,"append-to-body":"",width:"70%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"70px","label-position":"top"}},[e("el-row",[e("el-col",{staticStyle:{margin:"20px 0 0 20px"},attrs:{span:6}},[e("el-row",[e("el-col",{staticStyle:{"margin-bottom":"8px","margin-top":"10px"}},[e("el-col",{attrs:{span:5}},[t._v("任务名称")]),e("el-col",{attrs:{span:19}},[e("div",{staticClass:"divCard"},[t._v(t._s(t.serverData.name))])])],1),e("el-col",{staticStyle:{"margin-bottom":"8px"}},[e("el-col",{attrs:{span:5}},[t._v("运行状态")]),e("el-col",{attrs:{span:19}},[e("div",{staticClass:"divCard"},[t._v(t._s(t.serverData.status))])])],1),e("el-col",{staticStyle:{"margin-bottom":"8px"}},[e("el-col",{attrs:{span:5}},[t._v("外链详情")]),e("el-col",{attrs:{span:19}},[e("div",{staticClass:"divCard"},[t._v(t._s(t.nullChange(t.serverData.link)))])])],1),e("el-col",{staticStyle:{"margin-bottom":"8px"}},[e("el-col",{attrs:{span:5}},[t._v(" 本地哈希")]),e("el-col",{attrs:{span:19}},[e("div",{staticClass:"divCard"},[t._v(t._s(t.serverData.legal_hash))])])],1),e("el-col",{staticStyle:{"margin-bottom":"8px"}},[e("el-col",{attrs:{span:5}},[t._v(" 上报哈希")]),e("el-col",{attrs:{span:19}},[e("div",{staticClass:"divCard"},[t._v(t._s(t.serverData.actual_hash))])])],1),e("el-col",{staticStyle:{"margin-bottom":"8px"}},[e("el-col",{attrs:{span:5}},[t._v("上报时间")]),e("el-col",{attrs:{span:19}},[e("div",{staticClass:"divCard"},[t._v(t._s(t.dateTime(t.serverData.task_at)))])])],1),e("el-col",{staticStyle:{"margin-bottom":"8px"}},[e("el-col",{attrs:{span:5}},[t._v("启动时间")]),e("el-col",{attrs:{span:19}},[e("div",{staticClass:"divCard"},[t._v(t._s(t.dateTime(t.serverData.uptime)))])])],1),e("el-col",{staticStyle:{"margin-bottom":"20px"}},[e("el-col",{attrs:{span:5}},[t._v("报错信息")]),e("el-col",{attrs:{span:19}},[e("div",{staticClass:"divCard"},[t._v(t._s(t.nullChange(t.serverData.cause)))])])],1)],1),e("el-row",[e("el-col",{staticStyle:{"margin-bottom":"10px"}},[e("h3",[t._v("服务信息")])]),t._l(t.serverData.runners,(function(i,a){return e("div",{key:a},[e("el-col",{staticStyle:{"margin-bottom":"5px"}},[e("el-col",{attrs:{span:3}},[t._v("名称")]),e("el-col",{attrs:{span:20}},[e("el-tag",{staticStyle:{"margin-left":"2px"},attrs:{type:"info",size:"mini"}},[t._v(t._s(i.name))])],1)],1),e("el-col",{staticStyle:{"margin-bottom":"5px"}},[e("el-col",{attrs:{span:3}},[t._v("类型")]),e("el-col",{attrs:{span:20}},[""!==i.type?e("el-tag",{staticStyle:{"margin-left":"2px"},attrs:{type:"info",size:"mini"}},[t._v(t._s(i.type))]):t._e()],1)],1),e("el-col",{staticStyle:{"margin-bottom":"15px"}},[e("el-col",{attrs:{span:3}},[t._v("状态")]),e("el-col",{attrs:{span:20}},[e("el-tag",{staticStyle:{"margin-left":"2px"},attrs:{type:"info",size:"mini"}},[t._v(t._s(i.status))])],1)],1)],1)}))],2)],1),e("div",{staticStyle:{height:"20px","text-align":"right",padding:"5px"}},[e("i",{staticClass:"fa fa-refresh",staticStyle:{"margin-left":"10px",color:"#63a35c",cursor:"pointer"},on:{click:t.refreshCode}}),"startup"!==t.serverData.name&&!0===t.serverData.dialect?e("i",{staticClass:"fa fa-cloud-upload",staticStyle:{"margin-left":"10px",color:"#3d95ff",cursor:"pointer"},on:{click:function(e){return t.onSubmit("form")}}}):t._e(),e("i",{staticClass:"fa fa-close",staticStyle:{margin:"0 5px 0 10px",color:"#9e9e9e",cursor:"pointer"},on:{click:function(e){t.dialogVisible=!1}}})]),e("div",{ref:"generateId",staticClass:"code-editor"})],1)],1),e("div",{attrs:{slot:"title"},slot:"title"})],1)},g=[],v=i(74804),y=i(80952),_=i.n(y),b=(i(94274),i(61670),i(16987),i(50086),i(15802)),k=i.n(b),S=i(45631),x=i.n(S),w=i(61742),D=i.n(w);_().config.setModuleUrl("ace/mode/lua_worker",k()),_().config.setModuleUrl("ace/mode/lua_worker",k()),_().config.setModuleUrl("ace/mode/css_worker",x()),_().config.setModuleUrl("ace/keyboard/vim",D());var C={name:"formCode",components:{IconSelect:v.A},props:{isAdd:Boolean},data(){return{codeIcon:"",codeName:"",linkArray:[],form:{id:"",icon:"",chunk:"",version:0},serverData:[],dialogVisible:!1,linkData:[],dialogValue:"",dataTask:{}}},updated(){this.editor=_().edit(this.$refs.generateId,{keyboardHandler:"ace/keyboard/vim",enableSnippets:!0,enableLiveAutocompletion:!0,enableBasicAutocompletion:!0,mode:"ace/mode/lua",theme:"ace/theme/dracula",fontSize:12,tabSize:2,value:this.dialogValue,selectionStyle:"text",showLineNumbers:!0,showGutter:!0,showPrintMargin:!0,printMarginColumn:170})},methods:{dateTime(t){var e=i(95093);return e(t).format("YYYY-MM-DD HH:mm:ss")},refreshCode(){this.$emit("handleEdit",this.dataTask)},deleteLink(t){JSON.stringify(this.linkArray);var e=this.linkArray.indexOf(t);this.linkArray.splice(e,1)},pushLink(t){this.linkArray.push(t)},selected(t){this.form.icon=t,this.codeIcon=t},nullChange(t){return""!==t?t:"无"},filseSuccess(t,e){var i=this;if(t.raw){let e=new FileReader;e.onload=function(t){i.editor.setValue(t.target.result)},e.readAsText(t.raw)}},handleRemove(t,e){var i=this;i.editor.setValue("")},handlePreview(t){},handleExceed(t,e){this.$message.warning(`当前限制选择 3 个文件，本次选择了 ${t.length} 个文件，共选择了 ${t.length+e.length} 个文件`)},beforeRemove(t,e){return this.$confirm("确定移除 $ { file.name } ？")},handleClose(){this.dialogVisible=!1,this.form={}},onSubmit(){let t=i(8127).Base64,e=t.encode(this.editor.getValue(this.dialogValue)),a=t.encode(this.form.icon);var s={id:this.form.id,icon:a,chunk:e,version:this.form.version};this.serverData.dialect?this.$request.fetchUpdateDialect(s).then((t=>{this.refreshCode(),this.$message({message:"编辑成功",type:"success"})})).catch((t=>{this.$message.error(t.data)})):this.$request.fetchUpdataCode(s).then((t=>{this.refreshCode(),this.$message({message:"编辑成功",type:"success"})})).catch((t=>{this.$message.error(t.data)}))}},watch:{dialogValue:function(t){void 0!==this.editor&&(this.dialogValue=this.editor.setValue(t))}}},z=C,$=(0,u.A)(z,f,g,!1,null,"59f82e2c",null),I=$.exports,A=i(86389),T={components:{Page:l.A,selectSearch:r.A,AddForm:I,TaskCount:m,NodeDetail:A.A},name:"index",data(){return{tableLoading:!1,topEchartShow:!1,initData:{},currentPage:1,pageSize:15,delLoading:!1,ipTtitel:{},drawer:!1,directions:"rtl",tableHeader:[{title:"公网地址",istrue:!0},{title:"端口",istrue:!0},{title:"应用名称",istrue:!0},{title:"内部服务",istrue:!0},{title:"业务部门",istrue:!0},{title:"IDC",istrue:!0},{title:"负责人",istrue:!0}],colOptions:["公网地址","端口","内部服务","业务部门","IDC"],colData:[{lable:"公网地址",key:"virtual_ip",istrue:!0},{lable:"端口",key:"virtual_port",istrue:!0},{lable:"应用名称",key:"type",istrue:!1},{lable:"内部服务",key:"members",istrue:!0},{lable:"业务部门",key:"biz_dept",istrue:!0},{lable:"IDC",key:"idc",istrue:!0},{lable:"负责人",key:"inet",istrue:!1}],colSelect:["公网地址","端口","应用名称","内部服务","业务部门","IDC","负责人"],processShow:!1,processDetailData:{},searchName:"",condData:{},startTime:null,endTime:null,value:"",operator:"",field:"",filters:[],activeIndex:null}},computed:{activeUsers:function(){return this.colData.filter((function(t){return t.istrue}))}},created(){this.init(),this.getCond()},watch:{colOptions(t){if(t){var e=this.colSelect.filter((e=>t.indexOf(e)<0));this.colData.filter((t=>{e.indexOf(t.lable)>-1?t.istrue=!1:t.istrue=!0}))}}},methods:{ipRe(t){if(void 0!==t){var e=t.filter((t=>{var e=/(\d+)\.(\d+)\.(\d+)\.(\d+)/g;if(!e.test(t))return t}));return e}},init(){this.tableLoading=!0;var t={current:this.currentPage,size:this.pageSize,filters:this.filters};this.$request.fetchVips(t).then((t=>{this.tableLoading=!1,this.initData=t.data}))},getCond(){this.$request.fetchVipCond().then((t=>{this.condData=t.data}))},filseSuccess(t){var e=this,i=new FileReader;i.onload=function(){i.result&&e.$request.fetchVipPut(i.result).then((()=>{e.$message({message:"添加成功!!!",type:"success"})})).catch((t=>{this.$message.error(t.data)}))},i.readAsText(t.raw)},echartShow(){this.topEchartShow=!this.topEchartShow},drawerClose(){this.drawer=!1,this.ipTtitel={}},innetactive(t){this.ipTtitel=t,this.drawer=!0},searchBasic(t){this.currentPage=1,this.filters=t,this.init()},handleSizeChange(t){this.pageSize=t,this.init()},handleCurrentChange(t){this.currentPage=t,this.init()},reloadService(t){this.$message({message:"开发中!!!",type:"warning"})},handleEdit(t){this.$request.fetchdetailDialect(t.minion_id,t.substance_id).then((e=>{let a=i(8127).Base64;const s=this.$refs.formAdd;s.serverData=e.data,s.dataTask=t,e.data.chunk?s.dialogValue=a.decode(e.data.chunk):s.dialogValue=a.decode(" "),s.form={id:e.data.id,icon:e.data.icon,chunk:e.data.chunk,version:e.data.version},s.codeName=e.data.name,s.linkArray=e.data.links,s.dialogVisible=!0})).catch((t=>{this.$message.error(t.data)}))},delCode(t){this.$refs[t].doClose();var e=this;e.delLoading=!0,this.$request.fetchDeleteCodeEdit(t).then((()=>{e.$message({message:"删除成功!!!",type:"success"}),e.delLoading=!1,e.init()})).catch((t=>{e.delLoading=!1,this.$message.error(t.data)}))},getNode(){this.init()},refresh(){this.$request.fetchNodeDetail(this.$route.params.id).then((t=>{this.nodeListData=t.data})).catch((()=>{this.nodeListData=[]}))},detailData(t){this.$message({message:"开发中！！！",type:"warning"})},processCancel(){this.processDetailData={},this.processShow=!1}}},O=T,F=(0,u.A)(O,a,s,!1,null,"2e795f5c",null),V=F.exports}}]);